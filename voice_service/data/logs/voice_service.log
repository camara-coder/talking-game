2025-12-23 17:55:45,211 - app.main - INFO - ============================================================
2025-12-23 17:55:45,211 - app.main - INFO - Voice Agent Service starting...
2025-12-23 17:55:45,211 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-23 17:55:45,212 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-23 17:55:45,212 - app.main - INFO - STT Model: base.en
2025-12-23 17:55:45,212 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-23 17:55:45,212 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-23 17:55:45,212 - app.main - INFO - ============================================================
2025-12-23 17:56:19,470 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-23 18:03:24,198 - app.main - INFO - ============================================================
2025-12-23 18:03:24,198 - app.main - INFO - Voice Agent Service starting...
2025-12-23 18:03:24,198 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-23 18:03:24,198 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-23 18:03:24,198 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-23 18:03:24,198 - app.main - INFO - STT Model: base.en
2025-12-23 18:03:24,199 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-23 18:03:24,199 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-23 18:03:24,199 - app.main - INFO - ============================================================
2025-12-23 18:03:24,199 - app.api.session_manager - INFO - Session Manager started
2025-12-23 18:03:24,200 - app.main - INFO - Voice Agent Service shutting down...
2025-12-23 18:03:24,200 - app.api.session_manager - INFO - Session Manager stopped
2025-12-23 22:57:53,683 - app.main - INFO - ============================================================
2025-12-23 22:57:53,684 - app.main - INFO - Voice Agent Service starting...
2025-12-23 22:57:53,684 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-23 22:57:53,684 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-23 22:57:53,684 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-23 22:57:53,684 - app.main - INFO - STT Model: base.en
2025-12-23 22:57:53,684 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-23 22:57:53,684 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-23 22:57:53,684 - app.main - INFO - ============================================================
2025-12-23 22:57:53,684 - app.api.session_manager - INFO - Session Manager started
2025-12-23 22:58:03,910 - app.api.session_manager - INFO - Session created: 227b06e5-46eb-4666-b8ae-649324b976e8
2025-12-23 22:58:03,910 - app.api.routes - INFO - Session started: 227b06e5-46eb-4666-b8ae-649324b976e8, Turn: 00568a44-43e8-4a37-9cd5-3ecf1bd191c4, Status: SessionStatus.LISTENING
2025-12-23 22:58:18,460 - app.api.routes - INFO - Session stopped: 227b06e5-46eb-4666-b8ae-649324b976e8, Status: SessionStatus.PROCESSING, Turn: 00568a44-43e8-4a37-9cd5-3ecf1bd191c4
2025-12-23 22:58:26,507 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-23 22:58:45,542 - app.api.ws - INFO - WebSocket connected for session test-session-123. Total connections for session: 1
2025-12-23 22:58:45,545 - app.api.ws - INFO - WebSocket disconnected normally for session test-session-123
2025-12-23 22:58:45,545 - app.api.ws - INFO - WebSocket disconnected for session test-session-123
2025-12-23 23:16:14,145 - app.main - INFO - ============================================================
2025-12-23 23:16:14,146 - app.main - INFO - Voice Agent Service starting...
2025-12-23 23:16:14,146 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-23 23:16:14,146 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-23 23:16:14,146 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-23 23:16:14,146 - app.main - INFO - STT Model: base.en
2025-12-23 23:16:14,146 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-23 23:16:14,146 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-23 23:16:14,146 - app.main - INFO - ============================================================
2025-12-23 23:16:14,146 - app.api.session_manager - INFO - Session Manager started
2025-12-23 23:16:30,171 - app.api.session_manager - INFO - Session created: b103552d-d4bf-4512-9d8f-7781779a58c4
2025-12-23 23:16:30,171 - app.api.routes - INFO - Session started: b103552d-d4bf-4512-9d8f-7781779a58c4, Turn: 1f084494-3313-44b6-a9c1-3594ea62d64b, Status: SessionStatus.LISTENING
2025-12-23 23:17:12,110 - app.api.session_manager - INFO - Session created: 8e94190d-8273-4b56-9ce2-92181054a9f3
2025-12-23 23:17:12,110 - app.api.routes - INFO - Session started: 8e94190d-8273-4b56-9ce2-92181054a9f3, Turn: 10ca6a70-d334-4d0e-ae33-3fdf39627e2b, Status: SessionStatus.LISTENING
2025-12-23 23:17:12,153 - app.api.ws - INFO - WebSocket connected for session 8e94190d-8273-4b56-9ce2-92181054a9f3. Total connections for session: 1
2025-12-23 23:17:12,157 - app.api.routes - INFO - Session stopped: 8e94190d-8273-4b56-9ce2-92181054a9f3, Status: SessionStatus.PROCESSING, Turn: 10ca6a70-d334-4d0e-ae33-3fdf39627e2b
2025-12-23 23:17:12,459 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-23 23:17:12,459 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-23 23:17:12,459 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-23 23:17:13,539 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-23 23:17:13,634 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/Systran/faster-whisper-base.en/resolve/3d3d5dee26484f91867d81cb899cfcf72b96be6c/config.json "HTTP/1.1 307 Temporary Redirect"
2025-12-23 23:17:13,662 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Systran/faster-whisper-base.en/3d3d5dee26484f91867d81cb899cfcf72b96be6c/config.json "HTTP/1.1 200 OK"
2025-12-23 23:17:13,689 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/resolve-cache/models/Systran/faster-whisper-base.en/3d3d5dee26484f91867d81cb899cfcf72b96be6c/config.json "HTTP/1.1 200 OK"
2025-12-23 23:17:13,712 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/Systran/faster-whisper-base.en/resolve/3d3d5dee26484f91867d81cb899cfcf72b96be6c/tokenizer.json "HTTP/1.1 307 Temporary Redirect"
2025-12-23 23:17:13,729 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/Systran/faster-whisper-base.en/resolve/3d3d5dee26484f91867d81cb899cfcf72b96be6c/model.bin "HTTP/1.1 302 Found"
2025-12-23 23:17:13,734 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Systran/faster-whisper-base.en/3d3d5dee26484f91867d81cb899cfcf72b96be6c/tokenizer.json "HTTP/1.1 200 OK"
2025-12-23 23:17:13,749 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/Systran/faster-whisper-base.en/resolve/3d3d5dee26484f91867d81cb899cfcf72b96be6c/vocabulary.txt "HTTP/1.1 307 Temporary Redirect"
2025-12-23 23:17:13,759 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/resolve-cache/models/Systran/faster-whisper-base.en/3d3d5dee26484f91867d81cb899cfcf72b96be6c/tokenizer.json "HTTP/1.1 200 OK"
2025-12-23 23:17:13,772 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Systran/faster-whisper-base.en/3d3d5dee26484f91867d81cb899cfcf72b96be6c/vocabulary.txt "HTTP/1.1 200 OK"
2025-12-23 23:17:13,808 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/resolve-cache/models/Systran/faster-whisper-base.en/3d3d5dee26484f91867d81cb899cfcf72b96be6c/vocabulary.txt "HTTP/1.1 200 OK"
2025-12-23 23:17:13,852 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/xet-read-token/3d3d5dee26484f91867d81cb899cfcf72b96be6c "HTTP/1.1 200 OK"
2025-12-23 23:17:22,838 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-23 23:17:22,838 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-23 23:17:22,838 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-23 23:17:22,845 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-23 23:17:22,845 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-23 23:17:22,845 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-23 23:17:22,845 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-23 23:17:22,845 - app.api.routes - INFO - Pipeline processing queued for session 8e94190d-8273-4b56-9ce2-92181054a9f3
2025-12-23 23:17:22,846 - app.pipeline.pipeline_runner - INFO - Processing audio for session 8e94190d-8273-4b56-9ce2-92181054a9f3, turn 10ca6a70-d334-4d0e-ae33-3fdf39627e2b
2025-12-23 23:17:22,847 - app.pipeline.pipeline_runner - ERROR - Error processing session audio: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 85, in process_session_audio
    if result.get("error"):
       ^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'
2025-12-23 23:17:52,910 - app.api.ws - INFO - WebSocket disconnected normally for session 8e94190d-8273-4b56-9ce2-92181054a9f3
2025-12-23 23:17:52,911 - app.api.ws - INFO - WebSocket disconnected for session 8e94190d-8273-4b56-9ce2-92181054a9f3
2025-12-23 23:19:51,899 - app.main - INFO - ============================================================
2025-12-23 23:19:51,899 - app.main - INFO - Voice Agent Service starting...
2025-12-23 23:19:51,900 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-23 23:19:51,900 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-23 23:19:51,900 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-23 23:19:51,900 - app.main - INFO - STT Model: base.en
2025-12-23 23:19:51,900 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-23 23:19:51,900 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-23 23:19:51,900 - app.main - INFO - ============================================================
2025-12-23 23:19:51,900 - app.api.session_manager - INFO - Session Manager started
2025-12-23 23:20:07,414 - app.api.session_manager - INFO - Session created: 3261326c-03e5-4b29-8266-170077c13609
2025-12-23 23:20:07,415 - app.api.routes - INFO - Session started: 3261326c-03e5-4b29-8266-170077c13609, Turn: ad70bb3a-f0c1-4bfb-a602-7c4cfbd43e2c, Status: SessionStatus.LISTENING
2025-12-23 23:20:07,464 - app.api.ws - INFO - WebSocket connected for session 3261326c-03e5-4b29-8266-170077c13609. Total connections for session: 1
2025-12-23 23:20:07,469 - app.api.routes - INFO - Session stopped: 3261326c-03e5-4b29-8266-170077c13609, Status: SessionStatus.PROCESSING, Turn: ad70bb3a-f0c1-4bfb-a602-7c4cfbd43e2c
2025-12-23 23:20:07,492 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-23 23:20:07,492 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-23 23:20:07,493 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-23 23:20:08,412 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-23 23:20:09,095 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-23 23:20:09,095 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-23 23:20:09,095 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-23 23:20:09,121 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-23 23:20:09,121 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-23 23:20:09,122 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-23 23:20:09,122 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-23 23:20:09,122 - app.api.routes - INFO - Pipeline processing queued for session 3261326c-03e5-4b29-8266-170077c13609
2025-12-23 23:20:09,122 - app.pipeline.pipeline_runner - INFO - Processing audio for session 3261326c-03e5-4b29-8266-170077c13609, turn ad70bb3a-f0c1-4bfb-a602-7c4cfbd43e2c
2025-12-23 23:20:09,123 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-23 23:20:09,124 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-23 23:20:09,124 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-23 23:20:09,124 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-23 23:20:09,124 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-23 23:20:09,126 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-23 23:20:09,126 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-23 23:20:09,126 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-23 23:20:09,126 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-23 23:20:10,258 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.13s, language=en, probability=1.00)
2025-12-23 23:20:10,258 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-23 23:20:10,259 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-23 23:20:10,259 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-23 23:20:10,259 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-23 23:20:10,259 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-23 23:20:10,259 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-23 23:20:24,150 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm here to play! Can I help with something?' (13.89s)
2025-12-23 23:20:24,151 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm here to play! Can I help with something?'
2025-12-23 23:20:24,151 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-23 23:20:24,151 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm here to play! Can I help with something?'
2025-12-23 23:20:24,151 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm here to play! Can I help with something?'
2025-12-23 23:20:24,151 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm here to play! Can I help with something?'
2025-12-23 23:20:24,151 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-23 23:20:24,151 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 15027ms
2025-12-23 23:20:24,151 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-23 23:20:24,152 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm here to play! Can I help with something?', route=llm, time=15027ms
2025-12-23 23:20:24,153 - app.utils.audio_io - INFO - Saving WAV to: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\3261326c-03e5-4b29-8266-170077c13609\ad70bb3a-f0c1-4bfb-a602-7c4cfbd43e2c.wav
2025-12-23 23:20:24,158 - app.utils.audio_io - INFO - WAV saved: 48044 bytes
2025-12-23 23:20:24,159 - app.pipeline.pipeline_runner - INFO - Generated placeholder audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\3261326c-03e5-4b29-8266-170077c13609\ad70bb3a-f0c1-4bfb-a602-7c4cfbd43e2c.wav
2025-12-23 23:20:24,160 - app.api.ws - INFO - WebSocket disconnected normally for session 3261326c-03e5-4b29-8266-170077c13609
2025-12-23 23:20:24,160 - app.api.ws - INFO - WebSocket disconnected for session 3261326c-03e5-4b29-8266-170077c13609
2025-12-23 23:20:24,673 - app.api.ws - WARNING - No active connections for session 3261326c-03e5-4b29-8266-170077c13609
2025-12-23 23:20:24,673 - app.pipeline.pipeline_runner - INFO - Session 3261326c-03e5-4b29-8266-170077c13609 turn ad70bb3a-f0c1-4bfb-a602-7c4cfbd43e2c completed successfully
2025-12-24 01:16:59,450 - app.main - INFO - ============================================================
2025-12-24 01:16:59,451 - app.main - INFO - Voice Agent Service starting...
2025-12-24 01:16:59,451 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-24 01:16:59,451 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-24 01:16:59,451 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-24 01:16:59,451 - app.main - INFO - STT Model: base.en
2025-12-24 01:16:59,451 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-24 01:16:59,451 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-24 01:16:59,451 - app.main - INFO - ============================================================
2025-12-24 01:16:59,451 - app.api.session_manager - INFO - Session Manager started
2025-12-24 01:17:20,429 - app.api.session_manager - INFO - Session created: a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:20,429 - app.api.routes - INFO - Session started: a547870f-4ec5-4ebb-aaac-11ede42bd1a6, Turn: c97d0329-1740-45ca-a67f-f5d4cfc0c254, Status: SessionStatus.LISTENING
2025-12-24 01:17:20,477 - app.api.ws - INFO - WebSocket connected for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6. Total connections for session: 1
2025-12-24 01:17:20,481 - app.api.routes - INFO - Session stopped: a547870f-4ec5-4ebb-aaac-11ede42bd1a6, Status: SessionStatus.PROCESSING, Turn: c97d0329-1740-45ca-a67f-f5d4cfc0c254
2025-12-24 01:17:20,719 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-24 01:17:20,719 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-24 01:17:20,719 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-24 01:17:21,760 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-24 01:17:22,595 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-24 01:17:22,595 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-24 01:17:22,595 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-24 01:17:22,616 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-24 01:17:22,616 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-24 01:17:22,616 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-24 01:17:22,616 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-24 01:17:22,616 - app.api.routes - INFO - Pipeline processing queued for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:22,617 - app.pipeline.pipeline_runner - INFO - Processing audio for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6, turn c97d0329-1740-45ca-a67f-f5d4cfc0c254
2025-12-24 01:17:22,617 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-24 01:17:22,617 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-24 01:17:22,618 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-24 01:17:22,618 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-24 01:17:22,618 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-24 01:17:22,619 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-24 01:17:22,619 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-24 01:17:22,619 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-24 01:17:22,619 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-24 01:17:23,543 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (0.92s, language=en, probability=1.00)
2025-12-24 01:17:23,543 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-24 01:17:23,543 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-24 01:17:23,544 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-24 01:17:23,544 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-24 01:17:23,544 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-24 01:17:23,544 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-24 01:17:52,668 - app.api.ws - INFO - WebSocket disconnected normally for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:52,668 - app.api.ws - INFO - WebSocket disconnected for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:53,556 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2025-12-24 01:17:53,556 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2025-12-24 01:17:53,556 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-24 01:17:53,556 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2025-12-24 01:17:53,557 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2025-12-24 01:17:53,557 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2025-12-24 01:17:53,557 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-24 01:17:53,557 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 30939ms
2025-12-24 01:17:53,557 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-24 01:17:53,558 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=30939ms
2025-12-24 01:17:53,558 - app.api.ws - WARNING - No active connections for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:53,559 - app.api.ws - WARNING - No active connections for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:53,572 - app.pipeline.processors.tts_processor - INFO - Initializing TTS processor...
2025-12-24 01:17:53,704 - comtypes.client._code_cache - INFO - Imported existing <module 'comtypes.gen' from 'C:\\Users\\rober\\OneDrive\\dev\\ai\\voice-game\\voice_service\\.venv\\Lib\\site-packages\\comtypes\\gen\\__init__.py'>
2025-12-24 01:17:53,705 - comtypes.client._code_cache - INFO - Using writeable comtypes cache directory: 'C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\comtypes\gen'
2025-12-24 01:17:54,055 - app.pipeline.processors.tts_processor - INFO - Selected voice: Microsoft Zira Desktop - English (United States)
2025-12-24 01:17:54,055 - app.pipeline.processors.tts_processor - INFO - TTS processor initialized successfully
2025-12-24 01:17:54,055 - app.pipeline.processors.tts_processor - INFO - Synthesizing text: 'I'm thinking too slowly. Can you ask again?'
2025-12-24 01:17:54,252 - app.pipeline.processors.tts_processor - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\a547870f-4ec5-4ebb-aaac-11ede42bd1a6\c97d0329-1740-45ca-a67f-f5d4cfc0c254.wav (182794 bytes, 4.14s)
2025-12-24 01:17:54,253 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\a547870f-4ec5-4ebb-aaac-11ede42bd1a6\c97d0329-1740-45ca-a67f-f5d4cfc0c254.wav
2025-12-24 01:17:54,264 - app.api.ws - WARNING - No active connections for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:54,264 - app.api.ws - WARNING - No active connections for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:54,767 - app.api.ws - WARNING - No active connections for session a547870f-4ec5-4ebb-aaac-11ede42bd1a6
2025-12-24 01:17:54,768 - app.pipeline.pipeline_runner - INFO - Session a547870f-4ec5-4ebb-aaac-11ede42bd1a6 turn c97d0329-1740-45ca-a67f-f5d4cfc0c254 completed successfully
2025-12-26 12:22:34,218 - app.main - INFO - ============================================================
2025-12-26 12:22:34,218 - app.main - INFO - Voice Agent Service starting...
2025-12-26 12:22:34,218 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-26 12:22:34,218 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-26 12:22:34,218 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-26 12:22:34,218 - app.main - INFO - STT Model: base.en
2025-12-26 12:22:34,218 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-26 12:22:34,219 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-26 12:22:34,219 - app.main - INFO - ============================================================
2025-12-26 12:22:34,219 - app.api.session_manager - INFO - Session Manager started
2025-12-26 12:22:43,506 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:23:38,172 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:23:39,417 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:23:46,051 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:23:47,250 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:24:14,763 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:24:15,555 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:14,096 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:15,205 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:19,936 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:20,599 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:21,993 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:22,646 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:23,883 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:26:24,951 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:27:15,485 - app.main - INFO - ============================================================
2025-12-26 12:27:15,485 - app.main - INFO - Voice Agent Service starting...
2025-12-26 12:27:15,485 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-26 12:27:15,485 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-26 12:27:15,485 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-26 12:27:15,485 - app.main - INFO - STT Model: base.en
2025-12-26 12:27:15,486 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-26 12:27:15,486 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-26 12:27:15,486 - app.main - INFO - ============================================================
2025-12-26 12:27:15,486 - app.api.session_manager - INFO - Session Manager started
2025-12-26 12:27:15,487 - app.main - INFO - Voice Agent Service shutting down...
2025-12-26 12:27:15,487 - app.api.session_manager - INFO - Session Manager stopped
2025-12-26 12:27:54,117 - app.main - INFO - ============================================================
2025-12-26 12:27:54,118 - app.main - INFO - Voice Agent Service starting...
2025-12-26 12:27:54,118 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-26 12:27:54,118 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-26 12:27:54,118 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-26 12:27:54,118 - app.main - INFO - STT Model: base.en
2025-12-26 12:27:54,118 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-26 12:27:54,118 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-26 12:27:54,118 - app.main - INFO - ============================================================
2025-12-26 12:27:54,118 - app.api.session_manager - INFO - Session Manager started
2025-12-26 12:27:59,523 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:28:33,496 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:28:34,635 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:29:20,094 - app.main - INFO - ============================================================
2025-12-26 12:29:20,095 - app.main - INFO - Voice Agent Service starting...
2025-12-26 12:29:20,095 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-26 12:29:20,095 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-26 12:29:20,095 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-26 12:29:20,095 - app.main - INFO - STT Model: base.en
2025-12-26 12:29:20,095 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-26 12:29:20,095 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-26 12:29:20,095 - app.main - INFO - ============================================================
2025-12-26 12:29:20,095 - app.api.session_manager - INFO - Session Manager started
2025-12-26 12:30:27,304 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:30:28,441 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 12:30:28,883 - app.api.session_manager - INFO - Session created: 309697b4-647e-4ed4-844d-774a2026605d
2025-12-26 12:30:28,883 - app.api.routes - INFO - Session started: 309697b4-647e-4ed4-844d-774a2026605d, Turn: 09076ecd-3ccc-4da5-8bcb-0cf8878ff468, Status: SessionStatus.LISTENING
2025-12-26 12:30:28,893 - app.api.ws - INFO - WebSocket connected for session 309697b4-647e-4ed4-844d-774a2026605d. Total connections for session: 1
2025-12-26 12:30:28,962 - app.api.routes - INFO - Session stopped: 309697b4-647e-4ed4-844d-774a2026605d, Status: SessionStatus.PROCESSING, Turn: 09076ecd-3ccc-4da5-8bcb-0cf8878ff468
2025-12-26 12:30:29,068 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-26 12:30:29,068 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-26 12:30:29,068 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-26 12:30:30,773 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-26 12:30:31,603 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-26 12:30:31,603 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-26 12:30:31,603 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-26 12:30:31,628 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-26 12:30:31,628 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-26 12:30:31,628 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-26 12:30:31,629 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-26 12:30:31,629 - app.api.routes - INFO - Pipeline processing queued for session 309697b4-647e-4ed4-844d-774a2026605d
2025-12-26 12:30:31,629 - app.pipeline.pipeline_runner - INFO - Processing audio for session 309697b4-647e-4ed4-844d-774a2026605d, turn 09076ecd-3ccc-4da5-8bcb-0cf8878ff468
2025-12-26 12:30:31,630 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:31,631 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-26 12:30:31,631 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:31,631 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-26 12:30:31,631 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-26 12:30:31,632 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-26 12:30:31,632 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-26 12:30:31,633 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-26 12:30:31,633 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-26 12:30:32,756 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.12s, language=en, probability=1.00)
2025-12-26 12:30:32,756 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-26 12:30:32,757 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-26 12:30:32,757 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-26 12:30:32,757 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-26 12:30:32,757 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-26 12:30:32,757 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-26 12:30:34,473 - app.api.session_manager - INFO - Session created: 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:34,473 - app.api.routes - INFO - Session started: 37975469-b268-4885-ac17-ce7ce90943ec, Turn: 34271f9c-ef57-408a-bbcf-169002b6ea6f, Status: SessionStatus.LISTENING
2025-12-26 12:30:34,570 - app.api.routes - INFO - Session stopped: 37975469-b268-4885-ac17-ce7ce90943ec, Status: SessionStatus.PROCESSING, Turn: 34271f9c-ef57-408a-bbcf-169002b6ea6f
2025-12-26 12:30:34,573 - app.api.routes - INFO - Pipeline processing queued for session 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:34,573 - app.pipeline.pipeline_runner - INFO - Processing audio for session 37975469-b268-4885-ac17-ce7ce90943ec, turn 34271f9c-ef57-408a-bbcf-169002b6ea6f
2025-12-26 12:30:34,574 - app.api.ws - WARNING - No active connections for session 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:34,574 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:34,575 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-26 12:30:34,575 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:34,575 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-26 12:30:34,575 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-26 12:30:34,578 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-26 12:30:34,579 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-26 12:30:34,579 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-26 12:30:34,579 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-26 12:30:35,868 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.29s, language=en, probability=1.00)
2025-12-26 12:30:35,868 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-26 12:30:35,868 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-26 12:30:35,868 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-26 12:30:35,869 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-26 12:30:35,869 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-26 12:30:35,869 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-26 12:30:41,376 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm just a friendly game character talking to a child. Can I help with anything?' (5.51s)
2025-12-26 12:30:41,376 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm just a friendly game character talking to a child. Can I help with anything?'
2025-12-26 12:30:41,376 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-26 12:30:41,377 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm just a friendly game character talking to a child. Can I help with anything?'
2025-12-26 12:30:41,377 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm just a friendly game character talking to a child. Can I help with anything?'
2025-12-26 12:30:41,377 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm just a friendly game character talking to a child. Can I help with anything?'
2025-12-26 12:30:41,377 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:41,377 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 6803ms
2025-12-26 12:30:41,378 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:41,378 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm just a friendly game character talking to a child. Can I help with anything?', route=llm, time=6803ms
2025-12-26 12:30:41,379 - app.api.ws - WARNING - No active connections for session 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:41,379 - app.api.ws - WARNING - No active connections for session 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:41,403 - app.pipeline.processors.tts_processor - INFO - Initializing TTS processor...
2025-12-26 12:30:41,484 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm just here to chat!' (8.73s)
2025-12-26 12:30:41,485 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm just here to chat!'
2025-12-26 12:30:41,485 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-26 12:30:41,485 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm just here to chat!'
2025-12-26 12:30:41,485 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm just here to chat!'
2025-12-26 12:30:41,485 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm just here to chat!'
2025-12-26 12:30:41,486 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:41,486 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 9855ms
2025-12-26 12:30:41,486 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-26 12:30:41,629 - comtypes.client._code_cache - INFO - Imported existing <module 'comtypes.gen' from 'C:\\Users\\rober\\OneDrive\\dev\\ai\\voice-game\\voice_service\\.venv\\Lib\\site-packages\\comtypes\\gen\\__init__.py'>
2025-12-26 12:30:41,630 - comtypes.client._code_cache - INFO - Using writeable comtypes cache directory: 'C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\comtypes\gen'
2025-12-26 12:30:42,178 - app.pipeline.processors.tts_processor - INFO - Selected voice: Microsoft Zira Desktop - English (United States)
2025-12-26 12:30:42,178 - app.pipeline.processors.tts_processor - INFO - TTS processor initialized successfully
2025-12-26 12:30:42,179 - app.pipeline.processors.tts_processor - INFO - Synthesizing text: 'I'm just a friendly game character talking to a child. Can I help with anything?'
2025-12-26 12:30:42,179 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm just here to chat!', route=llm, time=9855ms
2025-12-26 12:30:42,181 - app.pipeline.processors.tts_processor - INFO - Initializing TTS processor...
2025-12-26 12:30:42,185 - app.pipeline.processors.tts_processor - INFO - Selected voice: Microsoft Zira Desktop - English (United States)
2025-12-26 12:30:42,185 - app.pipeline.processors.tts_processor - INFO - TTS processor initialized successfully
2025-12-26 12:30:42,185 - app.pipeline.processors.tts_processor - INFO - Synthesizing text: 'I'm just here to chat!'
2025-12-26 12:30:42,526 - app.pipeline.processors.tts_processor - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\309697b4-647e-4ed4-844d-774a2026605d\09076ecd-3ccc-4da5-8bcb-0cf8878ff468.wav (46 bytes, 0.00s)
2025-12-26 12:30:42,527 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\309697b4-647e-4ed4-844d-774a2026605d\09076ecd-3ccc-4da5-8bcb-0cf8878ff468.wav
2025-12-26 12:30:42,530 - app.pipeline.processors.tts_processor - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\37975469-b268-4885-ac17-ce7ce90943ec\34271f9c-ef57-408a-bbcf-169002b6ea6f.wav (353866 bytes, 8.02s)
2025-12-26 12:30:42,531 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\37975469-b268-4885-ac17-ce7ce90943ec\34271f9c-ef57-408a-bbcf-169002b6ea6f.wav
2025-12-26 12:30:42,541 - app.api.ws - WARNING - No active connections for session 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:42,541 - app.api.ws - WARNING - No active connections for session 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:42,547 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\309697b4-647e-4ed4-844d-774a2026605d\09076ecd-3ccc-4da5-8bcb-0cf8878ff468.wav
2025-12-26 12:30:43,039 - app.pipeline.pipeline_runner - INFO - Session 309697b4-647e-4ed4-844d-774a2026605d turn 09076ecd-3ccc-4da5-8bcb-0cf8878ff468 completed successfully
2025-12-26 12:30:43,054 - app.api.ws - WARNING - No active connections for session 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:30:43,054 - app.pipeline.pipeline_runner - INFO - Session 37975469-b268-4885-ac17-ce7ce90943ec turn 34271f9c-ef57-408a-bbcf-169002b6ea6f completed successfully
2025-12-26 12:36:20,153 - app.api.session_manager - INFO - Cleaning up expired session: 309697b4-647e-4ed4-844d-774a2026605d
2025-12-26 12:36:20,153 - app.api.session_manager - INFO - Session deleted: 309697b4-647e-4ed4-844d-774a2026605d
2025-12-26 12:36:20,154 - app.api.session_manager - INFO - Cleaning up expired session: 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:36:20,154 - app.api.session_manager - INFO - Session deleted: 37975469-b268-4885-ac17-ce7ce90943ec
2025-12-26 12:40:04,446 - app.main - INFO - ============================================================
2025-12-26 12:40:04,446 - app.main - INFO - Voice Agent Service starting...
2025-12-26 12:40:04,447 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-26 12:40:04,447 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-26 12:40:04,447 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-26 12:40:04,447 - app.main - INFO - STT Model: base.en
2025-12-26 12:40:04,447 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-26 12:40:04,447 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-26 12:40:04,447 - app.main - INFO - ============================================================
2025-12-26 12:40:04,447 - app.api.session_manager - INFO - Session Manager started
2025-12-26 12:40:06,116 - app.api.ws - INFO - WebSocket connected for session 309697b4-647e-4ed4-844d-774a2026605d. Total connections for session: 1
2025-12-26 12:40:19,390 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 13:19:47,901 - app.main - INFO - ============================================================
2025-12-26 13:19:47,902 - app.main - INFO - Voice Agent Service starting...
2025-12-26 13:19:47,902 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-26 13:19:47,902 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-26 13:19:47,902 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-26 13:19:47,902 - app.main - INFO - STT Model: base.en
2025-12-26 13:19:47,903 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-26 13:19:47,903 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-26 13:19:47,903 - app.main - INFO - ============================================================
2025-12-26 13:19:47,903 - app.api.session_manager - INFO - Session Manager started
2025-12-26 13:19:54,250 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-26 14:14:22,061 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-26 14:14:22,065 - app.utils.text_math - INFO - Parsed: 10.0 subtract 3.0
2025-12-26 14:14:22,069 - app.utils.text_math - INFO - Parsed: 6.0 multiply 7.0
2025-12-26 14:14:22,073 - app.utils.text_math - INFO - Parsed: 12.0 divide 4.0
2025-12-26 14:14:22,077 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-26 14:14:22,148 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-26 14:14:22,153 - app.utils.text_math - INFO - Parsed: 10.0 subtract 3.0
2025-12-26 14:14:22,158 - app.utils.text_math - INFO - Parsed: 6.0 multiply 7.0
2025-12-26 14:14:22,163 - app.utils.text_math - INFO - Parsed: 12.0 divide 4.0
2025-12-26 14:14:22,168 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-26 14:14:54,903 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-26 14:14:54,907 - app.utils.text_math - INFO - Parsed: 10.0 subtract 3.0
2025-12-26 14:14:54,910 - app.utils.text_math - INFO - Parsed: 6.0 multiply 7.0
2025-12-26 14:14:54,914 - app.utils.text_math - INFO - Parsed: 12.0 divide 4.0
2025-12-26 14:14:54,918 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-26 14:14:54,975 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-26 14:14:54,979 - app.utils.text_math - INFO - Parsed: 10.0 subtract 3.0
2025-12-26 14:14:54,983 - app.utils.text_math - INFO - Parsed: 6.0 multiply 7.0
2025-12-26 14:14:54,987 - app.utils.text_math - INFO - Parsed: 12.0 divide 4.0
2025-12-26 14:14:54,990 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-28 00:06:46,385 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 00:06:47,476 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 00:06:50,323 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 00:06:52,485 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 00:06:52,500 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 00:06:53,411 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:01:01,832 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:01:02,793 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:01:28,133 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:01:29,409 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:01:30,402 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:02:50,627 - app.main - INFO - ============================================================
2025-12-28 11:02:50,628 - app.main - INFO - Voice Agent Service starting...
2025-12-28 11:02:50,628 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-28 11:02:50,628 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-28 11:02:50,629 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-28 11:02:50,629 - app.main - INFO - STT Model: base.en
2025-12-28 11:02:50,629 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-28 11:02:50,629 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-28 11:02:50,630 - app.main - INFO - ============================================================
2025-12-28 11:02:50,630 - app.api.session_manager - INFO - Session Manager started
2025-12-28 11:03:37,764 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:03:38,827 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:03:39,945 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:17:12,309 - app.main - INFO - ============================================================
2025-12-28 11:17:12,310 - app.main - INFO - Voice Agent Service starting...
2025-12-28 11:17:12,310 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-28 11:17:12,310 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-28 11:17:12,310 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-28 11:17:12,310 - app.main - INFO - STT Model: base.en
2025-12-28 11:17:12,310 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-28 11:17:12,310 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-28 11:17:12,310 - app.main - INFO - ============================================================
2025-12-28 11:17:12,310 - app.api.session_manager - INFO - Session Manager started
2025-12-28 11:17:39,089 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-28 11:17:39,990 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 00:44:29,614 - app.main - INFO - ============================================================
2025-12-29 00:44:29,614 - app.main - INFO - Voice Agent Service starting...
2025-12-29 00:44:29,615 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-29 00:44:29,615 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-29 00:44:29,615 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-29 00:44:29,615 - app.main - INFO - STT Model: base.en
2025-12-29 00:44:29,615 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-29 00:44:29,615 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-29 00:44:29,615 - app.main - INFO - ============================================================
2025-12-29 00:44:29,616 - app.api.session_manager - INFO - Session Manager started
2025-12-29 01:04:06,877 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 01:04:07,962 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 01:04:20,243 - app.api.session_manager - INFO - Session created: 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 01:04:20,243 - app.api.routes - INFO - Session started: 62c0d5d5-c97d-434a-bfb6-e76c37f04e83, Turn: 422ca215-452d-48aa-a8ba-fa661c0013e4, Status: SessionStatus.LISTENING
2025-12-29 01:04:20,281 - app.api.ws - INFO - WebSocket connected for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83. Total connections for session: 1
2025-12-29 01:04:20,428 - app.api.routes - INFO - Session stopped: 62c0d5d5-c97d-434a-bfb6-e76c37f04e83, Status: SessionStatus.PROCESSING, Turn: 422ca215-452d-48aa-a8ba-fa661c0013e4
2025-12-29 01:04:20,995 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-29 01:04:20,996 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-29 01:04:20,996 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-29 01:04:23,396 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-29 01:04:24,833 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-29 01:04:24,833 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-29 01:04:24,833 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-29 01:04:24,872 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-29 01:04:24,873 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-29 01:04:24,873 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-29 01:04:24,873 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-29 01:04:24,873 - app.api.routes - INFO - Pipeline processing queued for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 01:04:24,874 - app.pipeline.pipeline_runner - INFO - Processing audio for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83, turn 422ca215-452d-48aa-a8ba-fa661c0013e4
2025-12-29 01:04:24,875 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:24,876 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-29 01:04:24,876 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:24,877 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-29 01:04:24,877 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-29 01:04:24,878 - app.api.session_manager - INFO - Session created: 0c831e0d-e64f-42a3-a88e-78cf5322980d
2025-12-29 01:04:24,879 - app.api.routes - INFO - Session started: 0c831e0d-e64f-42a3-a88e-78cf5322980d, Turn: 927592f4-49b0-4b06-a67a-a3be8d5551c5, Status: SessionStatus.LISTENING
2025-12-29 01:04:24,881 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-29 01:04:24,882 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-29 01:04:24,882 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-29 01:04:24,883 - app.api.routes - WARNING - Session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83 not in listening state: SessionStatus.PROCESSING
2025-12-29 01:04:24,883 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-29 01:04:24,884 - app.api.routes - INFO - Session stopped: 62c0d5d5-c97d-434a-bfb6-e76c37f04e83, Status: SessionStatus.PROCESSING, Turn: 422ca215-452d-48aa-a8ba-fa661c0013e4
2025-12-29 01:04:24,890 - app.api.routes - INFO - Pipeline processing queued for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 01:04:24,891 - app.pipeline.pipeline_runner - INFO - Processing audio for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83, turn 422ca215-452d-48aa-a8ba-fa661c0013e4
2025-12-29 01:04:24,893 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:24,894 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-29 01:04:24,894 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:24,895 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-29 01:04:24,895 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-29 01:04:24,897 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-29 01:04:24,897 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-29 01:04:24,897 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-29 01:04:24,898 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-29 01:04:25,558 - app.api.session_manager - INFO - Session created: 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:04:25,558 - app.api.routes - INFO - Session started: 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3, Turn: 84b979ab-4eee-44a3-a06e-892bb7b14639, Status: SessionStatus.LISTENING
2025-12-29 01:04:27,927 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (3.04s, language=en, probability=1.00)
2025-12-29 01:04:27,927 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-29 01:04:27,927 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-29 01:04:27,927 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-29 01:04:27,928 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-29 01:04:27,928 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-29 01:04:27,928 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-29 01:04:28,096 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (3.20s, language=en, probability=1.00)
2025-12-29 01:04:28,096 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-29 01:04:28,096 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-29 01:04:28,096 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-29 01:04:28,096 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-29 01:04:28,096 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-29 01:04:28,096 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-29 01:04:28,184 - app.api.routes - INFO - Session stopped: 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3, Status: SessionStatus.PROCESSING, Turn: 84b979ab-4eee-44a3-a06e-892bb7b14639
2025-12-29 01:04:28,187 - app.api.routes - INFO - Pipeline processing queued for session 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:04:28,189 - app.pipeline.pipeline_runner - INFO - Processing audio for session 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3, turn 84b979ab-4eee-44a3-a06e-892bb7b14639
2025-12-29 01:04:28,189 - app.api.ws - WARNING - No active connections for session 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:04:28,191 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:28,191 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-29 01:04:28,192 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:28,192 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-29 01:04:28,192 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-29 01:04:28,194 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-29 01:04:28,195 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-29 01:04:28,195 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-29 01:04:28,195 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-29 01:04:29,647 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.45s, language=en, probability=1.00)
2025-12-29 01:04:29,648 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-29 01:04:29,648 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-29 01:04:29,648 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-29 01:04:29,648 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-29 01:04:29,648 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-29 01:04:29,649 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-29 01:04:57,954 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2025-12-29 01:04:57,954 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:57,954 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-29 01:04:57,954 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:57,955 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:57,955 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:57,955 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:57,955 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 33079ms
2025-12-29 01:04:57,955 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:57,956 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=33079ms
2025-12-29 01:04:58,107 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2025-12-29 01:04:58,107 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:58,107 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-29 01:04:58,107 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:58,107 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:58,108 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:58,108 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:58,108 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 33214ms
2025-12-29 01:04:58,108 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:58,777 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-29 01:04:58,779 - app.pipeline.processors.tts_kokoro - INFO - Downloading Kokoro model...
2025-12-29 01:04:59,096 - app.pipeline.processors.tts_kokoro - ERROR - Failed to download model: HTTP Error 404: Not Found
2025-12-29 01:04:59,096 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 99, in _ensure_model_downloaded
    urllib.request.urlretrieve(model_url, model_path)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 214, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
                            ~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 189, in urlopen
    return opener.open(url, data, timeout)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 495, in open
    response = meth(req, response)
  File "C:\Python313\Lib\urllib\request.py", line 604, in http_response
    response = self.parent.error(
        'http', request, response, code, msg, hdrs)
  File "C:\Python313\Lib\urllib\request.py", line 533, in error
    return self._call_chain(*args)
           ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 466, in _call_chain
    result = func(*args)
  File "C:\Python313\Lib\urllib\request.py", line 613, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = KokoroTTSProcessor(voice="af_bella")
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 55, in __init__
    model_path = self._ensure_model_downloaded()
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 103, in _ensure_model_downloaded
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
2025-12-29 01:04:59,179 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=33214ms
2025-12-29 01:04:59,179 - app.pipeline.pipeline_runner - ERROR - Error processing session audio: 'NoneType' object has no attribute 'transcript' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 111, in process_session_audio
    session.current_turn.transcript = transcript
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'transcript' and no __dict__ for setting new attributes
2025-12-29 01:04:59,654 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2025-12-29 01:04:59,654 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:59,655 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-29 01:04:59,655 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:59,655 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:59,655 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2025-12-29 01:04:59,655 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:59,655 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 31464ms
2025-12-29 01:04:59,656 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:04:59,656 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=31464ms
2025-12-29 01:04:59,656 - app.api.ws - WARNING - No active connections for session 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:04:59,657 - app.api.ws - WARNING - No active connections for session 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:04:59,658 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-29 01:04:59,660 - app.pipeline.processors.tts_kokoro - INFO - Downloading Kokoro model...
2025-12-29 01:04:59,786 - app.pipeline.processors.tts_kokoro - ERROR - Failed to download model: HTTP Error 404: Not Found
2025-12-29 01:04:59,787 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 99, in _ensure_model_downloaded
    urllib.request.urlretrieve(model_url, model_path)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 214, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
                            ~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 189, in urlopen
    return opener.open(url, data, timeout)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 495, in open
    response = meth(req, response)
  File "C:\Python313\Lib\urllib\request.py", line 604, in http_response
    response = self.parent.error(
        'http', request, response, code, msg, hdrs)
  File "C:\Python313\Lib\urllib\request.py", line 533, in error
    return self._call_chain(*args)
           ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 466, in _call_chain
    result = func(*args)
  File "C:\Python313\Lib\urllib\request.py", line 613, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = KokoroTTSProcessor(voice="af_bella")
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 55, in __init__
    model_path = self._ensure_model_downloaded()
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 103, in _ensure_model_downloaded
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
2025-12-29 01:04:59,793 - app.pipeline.pipeline_runner - INFO - Session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83 turn 422ca215-452d-48aa-a8ba-fa661c0013e4 completed successfully
2025-12-29 01:05:00,295 - app.api.ws - WARNING - No active connections for session 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:05:00,295 - app.pipeline.pipeline_runner - INFO - Session 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3 turn 84b979ab-4eee-44a3-a06e-892bb7b14639 completed successfully
2025-12-29 01:05:18,844 - app.api.session_manager - INFO - Session created: 5a42ec72-5897-4610-a74e-adcbf3b6d764
2025-12-29 01:05:18,845 - app.api.routes - INFO - Session started: 5a42ec72-5897-4610-a74e-adcbf3b6d764, Turn: 09f89288-cdf9-40b6-9b7a-72d5dab3d148, Status: SessionStatus.LISTENING
2025-12-29 01:05:25,562 - app.api.session_manager - INFO - Session created: df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 01:05:25,562 - app.api.routes - INFO - Session started: df42db03-2973-4482-8ee4-523da383f6b6, Turn: e3c415b6-3eb8-4ce2-bec2-a0c9cd76d5bd, Status: SessionStatus.LISTENING
2025-12-29 01:05:25,651 - app.api.routes - INFO - Session stopped: df42db03-2973-4482-8ee4-523da383f6b6, Status: SessionStatus.PROCESSING, Turn: e3c415b6-3eb8-4ce2-bec2-a0c9cd76d5bd
2025-12-29 01:05:25,657 - app.api.routes - INFO - Pipeline processing queued for session df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 01:05:25,658 - app.pipeline.pipeline_runner - INFO - Processing audio for session df42db03-2973-4482-8ee4-523da383f6b6, turn e3c415b6-3eb8-4ce2-bec2-a0c9cd76d5bd
2025-12-29 01:05:25,659 - app.api.ws - WARNING - No active connections for session df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 01:05:25,660 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:05:25,660 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-29 01:05:25,660 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:05:25,661 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-29 01:05:25,661 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-29 01:05:25,663 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-29 01:05:25,663 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-29 01:05:25,663 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-29 01:05:25,664 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-29 01:05:27,227 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.56s, language=en, probability=1.00)
2025-12-29 01:05:27,228 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-29 01:05:27,228 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-29 01:05:27,228 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-29 01:05:27,228 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-29 01:05:27,228 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-29 01:05:27,229 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-29 01:05:42,530 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm here to play games with you! If I have to keep talking about something that's not suitable for children, just say so.' (15.30s)
2025-12-29 01:05:42,530 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm here to play games with you! If I have to keep talking about something that's not suitable for children, just say so.'
2025-12-29 01:05:42,530 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-29 01:05:42,531 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm here to play games with you! If I have to keep talking about something that's not suitable for children, just say so.'
2025-12-29 01:05:42,531 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm here to play games with you! If I have to keep talking about something that's not suitable for children, just say so.'
2025-12-29 01:05:42,531 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm here to play games with you! If I have to keep talking about something that's not suitable for children, just say so.'
2025-12-29 01:05:42,531 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:05:42,531 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 16871ms
2025-12-29 01:05:42,531 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 01:05:42,532 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm here to play games with you! If I have to keep talking about something that's not suitable for children, just say so.', route=llm, time=16871ms
2025-12-29 01:05:42,532 - app.api.ws - WARNING - No active connections for session df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 01:05:42,532 - app.api.ws - WARNING - No active connections for session df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 01:05:42,533 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-29 01:05:42,535 - app.pipeline.processors.tts_kokoro - INFO - Downloading Kokoro model...
2025-12-29 01:05:42,800 - app.pipeline.processors.tts_kokoro - ERROR - Failed to download model: HTTP Error 404: Not Found
2025-12-29 01:05:42,800 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 99, in _ensure_model_downloaded
    urllib.request.urlretrieve(model_url, model_path)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 214, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
                            ~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 189, in urlopen
    return opener.open(url, data, timeout)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 495, in open
    response = meth(req, response)
  File "C:\Python313\Lib\urllib\request.py", line 604, in http_response
    response = self.parent.error(
        'http', request, response, code, msg, hdrs)
  File "C:\Python313\Lib\urllib\request.py", line 533, in error
    return self._call_chain(*args)
           ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 466, in _call_chain
    result = func(*args)
  File "C:\Python313\Lib\urllib\request.py", line 613, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = KokoroTTSProcessor(voice="af_bella")
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 55, in __init__
    model_path = self._ensure_model_downloaded()
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 103, in _ensure_model_downloaded
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
2025-12-29 01:05:43,320 - app.api.ws - WARNING - No active connections for session df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 01:05:43,321 - app.pipeline.pipeline_runner - INFO - Session df42db03-2973-4482-8ee4-523da383f6b6 turn e3c415b6-3eb8-4ce2-bec2-a0c9cd76d5bd completed successfully
2025-12-29 01:09:29,802 - app.api.session_manager - INFO - Cleaning up expired session: 0c831e0d-e64f-42a3-a88e-78cf5322980d
2025-12-29 01:09:29,802 - app.api.session_manager - INFO - Session deleted: 0c831e0d-e64f-42a3-a88e-78cf5322980d
2025-12-29 01:10:29,817 - app.api.session_manager - INFO - Cleaning up expired session: 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 01:10:29,817 - app.api.session_manager - INFO - Session deleted: 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 01:10:29,817 - app.api.session_manager - INFO - Cleaning up expired session: 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:10:29,817 - app.api.session_manager - INFO - Session deleted: 69c4eea1-dbab-4ee4-a0cb-7bb798a35ba3
2025-12-29 01:10:29,817 - app.api.session_manager - INFO - Cleaning up expired session: 5a42ec72-5897-4610-a74e-adcbf3b6d764
2025-12-29 01:10:29,817 - app.api.session_manager - INFO - Session deleted: 5a42ec72-5897-4610-a74e-adcbf3b6d764
2025-12-29 01:11:29,832 - app.api.session_manager - INFO - Cleaning up expired session: df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 01:11:29,832 - app.api.session_manager - INFO - Session deleted: df42db03-2973-4482-8ee4-523da383f6b6
2025-12-29 02:48:11,453 - app.api.ws - INFO - WebSocket disconnected normally for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 02:48:11,456 - app.api.ws - INFO - WebSocket disconnected for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 10:36:11,587 - app.api.ws - INFO - WebSocket connected for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83. Total connections for session: 1
2025-12-29 10:36:14,336 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 10:36:16,255 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 10:36:47,911 - app.api.ws - INFO - WebSocket disconnected normally for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 10:36:47,912 - app.api.ws - INFO - WebSocket disconnected for session 62c0d5d5-c97d-434a-bfb6-e76c37f04e83
2025-12-29 10:36:49,537 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 10:36:50,923 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 10:40:34,037 - app.api.session_manager - INFO - Session created: 22484c23-d69f-47d9-a831-e1d71160e54d
2025-12-29 10:40:34,037 - app.api.routes - INFO - Session started: 22484c23-d69f-47d9-a831-e1d71160e54d, Turn: 3cc57cf5-2d8e-427c-b4b5-32173bcd446e, Status: SessionStatus.LISTENING
2025-12-29 10:40:34,048 - app.api.ws - INFO - WebSocket connected for session 22484c23-d69f-47d9-a831-e1d71160e54d. Total connections for session: 1
2025-12-29 10:40:35,936 - app.api.routes - INFO - Session stopped: 22484c23-d69f-47d9-a831-e1d71160e54d, Status: SessionStatus.PROCESSING, Turn: 3cc57cf5-2d8e-427c-b4b5-32173bcd446e
2025-12-29 10:40:35,940 - app.api.routes - INFO - Pipeline processing queued for session 22484c23-d69f-47d9-a831-e1d71160e54d
2025-12-29 10:40:35,941 - app.pipeline.pipeline_runner - INFO - Processing audio for session 22484c23-d69f-47d9-a831-e1d71160e54d, turn 3cc57cf5-2d8e-427c-b4b5-32173bcd446e
2025-12-29 10:40:35,944 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:35,945 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-29 10:40:35,946 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:35,946 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-29 10:40:35,947 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-29 10:40:35,950 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-29 10:40:35,950 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-29 10:40:35,951 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-29 10:40:35,951 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-29 10:40:37,598 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.65s, language=en, probability=1.00)
2025-12-29 10:40:37,598 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-29 10:40:37,599 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-29 10:40:37,599 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-29 10:40:37,599 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-29 10:40:37,599 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-29 10:40:37,600 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-29 10:40:38,481 - app.api.session_manager - INFO - Session created: cf0dee6d-c42b-44f9-9aec-be6b540b2a92
2025-12-29 10:40:38,481 - app.api.routes - INFO - Session started: cf0dee6d-c42b-44f9-9aec-be6b540b2a92, Turn: 02671f1d-5281-4544-82be-254083b30014, Status: SessionStatus.LISTENING
2025-12-29 10:40:40,998 - app.api.routes - INFO - Session stopped: cf0dee6d-c42b-44f9-9aec-be6b540b2a92, Status: SessionStatus.PROCESSING, Turn: 02671f1d-5281-4544-82be-254083b30014
2025-12-29 10:40:41,001 - app.api.routes - INFO - Pipeline processing queued for session cf0dee6d-c42b-44f9-9aec-be6b540b2a92
2025-12-29 10:40:41,002 - app.pipeline.pipeline_runner - INFO - Processing audio for session cf0dee6d-c42b-44f9-9aec-be6b540b2a92, turn 02671f1d-5281-4544-82be-254083b30014
2025-12-29 10:40:41,002 - app.api.ws - WARNING - No active connections for session cf0dee6d-c42b-44f9-9aec-be6b540b2a92
2025-12-29 10:40:41,002 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:41,002 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-29 10:40:41,002 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:41,003 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-29 10:40:41,003 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-29 10:40:41,004 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-29 10:40:41,004 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-29 10:40:41,004 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-29 10:40:41,004 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-29 10:40:42,603 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.60s, language=en, probability=1.00)
2025-12-29 10:40:42,603 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-29 10:40:42,603 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-29 10:40:42,603 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-29 10:40:42,604 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-29 10:40:42,604 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-29 10:40:42,604 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-29 10:40:53,579 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! I'm here to play with you and make up stories. How about today? What do you want to learn or read about?' (15.98s)
2025-12-29 10:40:53,580 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! I'm here to play with you and make up stories. How about today? What do you want to learn or read about?'
2025-12-29 10:40:53,580 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-29 10:40:53,580 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! I'm here to play with you and make up stories. How about today? What do you want to learn or read about?'
2025-12-29 10:40:53,580 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-29 10:40:53,580 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! I'm here to play with you and make up stories.'
2025-12-29 10:40:53,581 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! I'm here to play with you and make up stories.'
2025-12-29 10:40:53,581 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:53,581 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 17636ms
2025-12-29 10:40:53,581 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:53,582 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='Hello! I'm here to play with you and make up stories.', route=llm, time=17636ms
2025-12-29 10:40:53,584 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-29 10:40:53,586 - app.pipeline.processors.tts_kokoro - INFO - Downloading Kokoro model...
2025-12-29 10:40:53,711 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! How may I assist you today?' (11.11s)
2025-12-29 10:40:53,712 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! How may I assist you today?'
2025-12-29 10:40:53,712 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-29 10:40:53,712 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! How may I assist you today?'
2025-12-29 10:40:53,712 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! How may I assist you today?'
2025-12-29 10:40:53,713 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! How may I assist you today?'
2025-12-29 10:40:53,713 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:53,713 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 12710ms
2025-12-29 10:40:53,713 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-29 10:40:53,922 - app.pipeline.processors.tts_kokoro - ERROR - Failed to download model: HTTP Error 404: Not Found
2025-12-29 10:40:53,922 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 99, in _ensure_model_downloaded
    urllib.request.urlretrieve(model_url, model_path)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 214, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
                            ~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 189, in urlopen
    return opener.open(url, data, timeout)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 495, in open
    response = meth(req, response)
  File "C:\Python313\Lib\urllib\request.py", line 604, in http_response
    response = self.parent.error(
        'http', request, response, code, msg, hdrs)
  File "C:\Python313\Lib\urllib\request.py", line 533, in error
    return self._call_chain(*args)
           ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 466, in _call_chain
    result = func(*args)
  File "C:\Python313\Lib\urllib\request.py", line 613, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = KokoroTTSProcessor(voice="af_bella")
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 55, in __init__
    model_path = self._ensure_model_downloaded()
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 103, in _ensure_model_downloaded
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
2025-12-29 10:40:53,933 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='Hello! How may I assist you today?', route=llm, time=12710ms
2025-12-29 10:40:53,934 - app.api.ws - WARNING - No active connections for session cf0dee6d-c42b-44f9-9aec-be6b540b2a92
2025-12-29 10:40:53,934 - app.api.ws - WARNING - No active connections for session cf0dee6d-c42b-44f9-9aec-be6b540b2a92
2025-12-29 10:40:53,935 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-29 10:40:53,938 - app.pipeline.processors.tts_kokoro - INFO - Downloading Kokoro model...
2025-12-29 10:40:54,057 - app.pipeline.processors.tts_kokoro - ERROR - Failed to download model: HTTP Error 404: Not Found
2025-12-29 10:40:54,057 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 99, in _ensure_model_downloaded
    urllib.request.urlretrieve(model_url, model_path)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 214, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
                            ~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 189, in urlopen
    return opener.open(url, data, timeout)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 495, in open
    response = meth(req, response)
  File "C:\Python313\Lib\urllib\request.py", line 604, in http_response
    response = self.parent.error(
        'http', request, response, code, msg, hdrs)
  File "C:\Python313\Lib\urllib\request.py", line 533, in error
    return self._call_chain(*args)
           ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 466, in _call_chain
    result = func(*args)
  File "C:\Python313\Lib\urllib\request.py", line 613, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = KokoroTTSProcessor(voice="af_bella")
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 55, in __init__
    model_path = self._ensure_model_downloaded()
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 103, in _ensure_model_downloaded
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
2025-12-29 10:40:54,446 - app.pipeline.pipeline_runner - INFO - Session 22484c23-d69f-47d9-a831-e1d71160e54d turn 3cc57cf5-2d8e-427c-b4b5-32173bcd446e completed successfully
2025-12-29 10:40:54,570 - app.api.ws - WARNING - No active connections for session cf0dee6d-c42b-44f9-9aec-be6b540b2a92
2025-12-29 10:40:54,570 - app.pipeline.pipeline_runner - INFO - Session cf0dee6d-c42b-44f9-9aec-be6b540b2a92 turn 02671f1d-5281-4544-82be-254083b30014 completed successfully
2025-12-29 10:48:56,536 - app.main - INFO - ============================================================
2025-12-29 10:48:56,537 - app.main - INFO - Voice Agent Service starting...
2025-12-29 10:48:56,537 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-29 10:48:56,537 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-29 10:48:56,537 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-29 10:48:56,538 - app.main - INFO - STT Model: base.en
2025-12-29 10:48:56,538 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-29 10:48:56,538 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-29 10:48:56,538 - app.main - INFO - ============================================================
2025-12-29 10:48:56,539 - app.api.session_manager - INFO - Session Manager started
2025-12-29 15:53:44,076 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-29 15:53:46,322 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 15:04:26,588 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 15:04:27,655 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 15:04:31,043 - app.api.session_manager - INFO - Session created: b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:04:31,045 - app.api.routes - INFO - Session started: b54cefb7-6774-40d5-8d35-8d03c6c0864e, Turn: de134e30-1cc2-4606-9fcb-0c02d0551799, Status: SessionStatus.LISTENING
2025-12-30 15:04:31,099 - app.api.ws - INFO - WebSocket connected for session b54cefb7-6774-40d5-8d35-8d03c6c0864e. Total connections for session: 1
2025-12-30 15:04:33,100 - app.api.routes - INFO - Session stopped: b54cefb7-6774-40d5-8d35-8d03c6c0864e, Status: SessionStatus.PROCESSING, Turn: de134e30-1cc2-4606-9fcb-0c02d0551799
2025-12-30 15:04:33,531 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-30 15:04:33,532 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-30 15:04:33,532 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-30 15:04:35,287 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-30 15:04:36,489 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-30 15:04:36,489 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-30 15:04:36,490 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-30 15:04:36,530 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-30 15:04:36,530 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-30 15:04:36,531 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-30 15:04:36,531 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-30 15:04:36,532 - app.api.routes - INFO - Pipeline processing queued for session b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:04:36,533 - app.pipeline.pipeline_runner - INFO - Processing audio for session b54cefb7-6774-40d5-8d35-8d03c6c0864e, turn de134e30-1cc2-4606-9fcb-0c02d0551799
2025-12-30 15:04:36,535 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:04:36,535 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 15:04:36,536 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:04:36,537 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 15:04:36,537 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-30 15:04:36,541 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-30 15:04:36,542 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 15:04:36,542 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-30 15:04:36,543 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-30 15:04:37,975 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.43s, language=en, probability=1.00)
2025-12-30 15:04:37,976 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-30 15:04:37,976 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 15:04:37,977 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-30 15:04:37,977 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-30 15:04:37,978 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-30 15:04:37,978 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-30 15:04:46,478 - app.api.session_manager - INFO - Session created: a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:04:46,479 - app.api.routes - INFO - Session started: a7a522f2-02fc-46be-aed3-71adc97d82f2, Turn: 7d647ad6-712c-4e71-844d-8579b023774a, Status: SessionStatus.LISTENING
2025-12-30 15:04:48,685 - app.api.routes - INFO - Session stopped: a7a522f2-02fc-46be-aed3-71adc97d82f2, Status: SessionStatus.PROCESSING, Turn: 7d647ad6-712c-4e71-844d-8579b023774a
2025-12-30 15:04:48,688 - app.api.routes - INFO - Pipeline processing queued for session a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:04:48,689 - app.pipeline.pipeline_runner - INFO - Processing audio for session a7a522f2-02fc-46be-aed3-71adc97d82f2, turn 7d647ad6-712c-4e71-844d-8579b023774a
2025-12-30 15:04:48,689 - app.api.ws - WARNING - No active connections for session a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:04:48,691 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:04:48,691 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 15:04:48,692 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:04:48,693 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 15:04:48,694 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-30 15:04:48,696 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-30 15:04:48,697 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 15:04:48,697 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-30 15:04:48,698 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-30 15:04:50,216 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (1.52s, language=en, probability=1.00)
2025-12-30 15:04:50,217 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-30 15:04:50,217 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 15:04:50,217 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-30 15:04:50,218 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-30 15:04:50,218 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-30 15:04:50,218 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-30 15:05:07,991 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2025-12-30 15:05:07,992 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:07,992 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 15:05:07,992 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:07,993 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:07,993 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:07,993 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:05:07,993 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 31458ms
2025-12-30 15:05:07,994 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:05:07,994 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=31458ms
2025-12-30 15:05:08,817 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 15:05:08,819 - app.pipeline.processors.tts_kokoro - INFO - Downloading Kokoro model...
2025-12-30 15:05:09,160 - app.pipeline.processors.tts_kokoro - ERROR - Failed to download model: HTTP Error 404: Not Found
2025-12-30 15:05:09,161 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 99, in _ensure_model_downloaded
    urllib.request.urlretrieve(model_url, model_path)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 214, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
                            ~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 189, in urlopen
    return opener.open(url, data, timeout)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 495, in open
    response = meth(req, response)
  File "C:\Python313\Lib\urllib\request.py", line 604, in http_response
    response = self.parent.error(
        'http', request, response, code, msg, hdrs)
  File "C:\Python313\Lib\urllib\request.py", line 533, in error
    return self._call_chain(*args)
           ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 466, in _call_chain
    result = func(*args)
  File "C:\Python313\Lib\urllib\request.py", line 613, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = KokoroTTSProcessor(voice="af_bella")
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 55, in __init__
    model_path = self._ensure_model_downloaded()
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 103, in _ensure_model_downloaded
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
2025-12-30 15:05:09,761 - app.pipeline.pipeline_runner - INFO - Session b54cefb7-6774-40d5-8d35-8d03c6c0864e turn de134e30-1cc2-4606-9fcb-0c02d0551799 completed successfully
2025-12-30 15:05:20,232 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2025-12-30 15:05:20,233 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:20,233 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 15:05:20,233 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:20,234 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:20,234 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2025-12-30 15:05:20,234 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:05:20,235 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 31543ms
2025-12-30 15:05:20,235 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:05:20,235 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=31543ms
2025-12-30 15:05:20,236 - app.api.ws - WARNING - No active connections for session a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:05:20,236 - app.api.ws - WARNING - No active connections for session a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:05:20,237 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 15:05:20,240 - app.pipeline.processors.tts_kokoro - INFO - Downloading Kokoro model...
2025-12-30 15:05:20,722 - app.pipeline.processors.tts_kokoro - ERROR - Failed to download model: HTTP Error 404: Not Found
2025-12-30 15:05:20,723 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 99, in _ensure_model_downloaded
    urllib.request.urlretrieve(model_url, model_path)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 214, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
                            ~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 189, in urlopen
    return opener.open(url, data, timeout)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 495, in open
    response = meth(req, response)
  File "C:\Python313\Lib\urllib\request.py", line 604, in http_response
    response = self.parent.error(
        'http', request, response, code, msg, hdrs)
  File "C:\Python313\Lib\urllib\request.py", line 533, in error
    return self._call_chain(*args)
           ~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Python313\Lib\urllib\request.py", line 466, in _call_chain
    result = func(*args)
  File "C:\Python313\Lib\urllib\request.py", line 613, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = KokoroTTSProcessor(voice="af_bella")
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 55, in __init__
    model_path = self._ensure_model_downloaded()
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_kokoro.py", line 103, in _ensure_model_downloaded
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Could not download Kokoro model from https://github.com/thewh1teagle/kokoro-onnx/releases/download/model-files/kokoro-v0.19.onnx. Please download manually to C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v0.19.onnx
2025-12-30 15:05:21,241 - app.api.ws - WARNING - No active connections for session a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:05:21,242 - app.pipeline.pipeline_runner - INFO - Session a7a522f2-02fc-46be-aed3-71adc97d82f2 turn 7d647ad6-712c-4e71-844d-8579b023774a completed successfully
2025-12-30 15:10:49,581 - app.api.session_manager - INFO - Cleaning up expired session: b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:10:49,582 - app.api.session_manager - INFO - Session deleted: b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:10:49,582 - app.api.session_manager - INFO - Cleaning up expired session: a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:10:49,582 - app.api.session_manager - INFO - Session deleted: a7a522f2-02fc-46be-aed3-71adc97d82f2
2025-12-30 15:17:57,828 - app.api.ws - INFO - WebSocket disconnected normally for session b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:17:57,829 - app.api.ws - INFO - WebSocket disconnected for session b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:17:57,942 - app.main - INFO - Voice Agent Service shutting down...
2025-12-30 15:17:57,943 - app.api.session_manager - INFO - Session Manager stopped
2025-12-30 15:18:16,815 - app.main - INFO - ============================================================
2025-12-30 15:18:16,816 - app.main - INFO - Voice Agent Service starting...
2025-12-30 15:18:16,816 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-30 15:18:16,817 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-30 15:18:16,817 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-30 15:18:16,817 - app.main - INFO - STT Model: base.en
2025-12-30 15:18:16,818 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-30 15:18:16,819 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-30 15:18:16,822 - app.main - INFO - ============================================================
2025-12-30 15:18:16,822 - app.api.session_manager - INFO - Session Manager started
2025-12-30 15:18:17,062 - app.api.ws - INFO - WebSocket connected for session b54cefb7-6774-40d5-8d35-8d03c6c0864e. Total connections for session: 1
2025-12-30 15:18:43,590 - app.api.session_manager - INFO - Session created: 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:18:43,591 - app.api.routes - INFO - Session started: 65cc8373-0c6a-43b0-b0d7-6232d785bd4c, Turn: 8bb17863-1fb8-4477-9871-ab8352d2d912, Status: SessionStatus.LISTENING
2025-12-30 15:18:45,267 - app.api.routes - INFO - Session stopped: 65cc8373-0c6a-43b0-b0d7-6232d785bd4c, Status: SessionStatus.PROCESSING, Turn: 8bb17863-1fb8-4477-9871-ab8352d2d912
2025-12-30 15:18:45,345 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-30 15:18:45,346 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-30 15:18:45,347 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-30 15:18:47,745 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-30 15:18:49,084 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-30 15:18:49,085 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-30 15:18:49,085 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-30 15:18:49,114 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-30 15:18:49,115 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-30 15:18:49,115 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-30 15:18:49,116 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-30 15:18:49,116 - app.api.routes - INFO - Pipeline processing queued for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:18:49,117 - app.pipeline.pipeline_runner - INFO - Processing audio for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c, turn 8bb17863-1fb8-4477-9871-ab8352d2d912
2025-12-30 15:18:49,118 - app.api.ws - WARNING - No active connections for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:18:49,120 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:18:49,123 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 15:18:49,124 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:18:49,124 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 15:18:49,125 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48000 samples
2025-12-30 15:18:49,128 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48000 -> 52800 samples (3.30s)
2025-12-30 15:18:49,128 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 15:18:49,129 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 52800 samples, 3.30s
2025-12-30 15:18:49,129 - faster_whisper - INFO - Processing audio with duration 00:03.300
2025-12-30 15:18:51,218 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You' (2.09s, language=en, probability=1.00)
2025-12-30 15:18:51,218 - app.pipeline.voice_pipeline - INFO - Transcript: 'You'
2025-12-30 15:18:51,218 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 15:18:51,219 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You'
2025-12-30 15:18:51,222 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-30 15:18:51,223 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-30 15:18:51,224 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You'
2025-12-30 15:19:04,699 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! I'm here to play games with you. Don't worry if you're not sure what to do - just ask me anything.' (13.47s)
2025-12-30 15:19:04,700 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! I'm here to play games with you. Don't worry if you're not sure what to do - just ask me anything.'
2025-12-30 15:19:04,700 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 15:19:04,701 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! I'm here to play games with you. Don't worry if you're not sure what to do - just ask me anything.'
2025-12-30 15:19:04,702 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-30 15:19:04,702 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! I'm here to play games with you.'
2025-12-30 15:19:04,702 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! I'm here to play games with you.'
2025-12-30 15:19:04,703 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:19:04,703 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 15582ms
2025-12-30 15:19:04,703 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 15:19:04,704 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You', reply='Hello! I'm here to play games with you.', route=llm, time=15582ms
2025-12-30 15:19:04,705 - app.api.ws - WARNING - No active connections for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:19:04,706 - app.api.ws - WARNING - No active connections for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:19:04,720 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 15:19:09,347 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-30 15:19:09,348 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-30 15:19:12,989 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-30 15:19:12,990 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Hello! I'm here to play games with you.' (speed=1.0)
2025-12-30 15:19:12,992 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-30 15:19:20,134 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\65cc8373-0c6a-43b0-b0d7-6232d785bd4c\8bb17863-1fb8-4477-9871-ab8352d2d912.wav (103468 bytes, 2.15s, 24000Hz)
2025-12-30 15:19:20,135 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\65cc8373-0c6a-43b0-b0d7-6232d785bd4c\8bb17863-1fb8-4477-9871-ab8352d2d912.wav
2025-12-30 15:19:20,278 - app.api.ws - WARNING - No active connections for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:19:20,278 - app.api.ws - WARNING - No active connections for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:19:20,784 - app.api.ws - WARNING - No active connections for session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:19:20,785 - app.pipeline.pipeline_runner - INFO - Session 65cc8373-0c6a-43b0-b0d7-6232d785bd4c turn 8bb17863-1fb8-4477-9871-ab8352d2d912 completed successfully
2025-12-30 15:25:16,874 - app.api.session_manager - INFO - Cleaning up expired session: 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:25:16,875 - app.api.session_manager - INFO - Session deleted: 65cc8373-0c6a-43b0-b0d7-6232d785bd4c
2025-12-30 15:34:48,338 - app.api.ws - INFO - WebSocket disconnected normally for session b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:34:48,338 - app.api.ws - INFO - WebSocket disconnected for session b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:34:51,288 - app.api.ws - INFO - WebSocket connected for session b54cefb7-6774-40d5-8d35-8d03c6c0864e. Total connections for session: 1
2025-12-30 15:43:46,566 - app.api.ws - INFO - WebSocket disconnected normally for session b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:43:46,566 - app.api.ws - INFO - WebSocket disconnected for session b54cefb7-6774-40d5-8d35-8d03c6c0864e
2025-12-30 15:43:46,673 - app.main - INFO - Voice Agent Service shutting down...
2025-12-30 15:43:46,673 - app.api.session_manager - INFO - Session Manager stopped
2025-12-30 15:44:36,096 - app.main - INFO - ============================================================
2025-12-30 15:44:36,096 - app.main - INFO - Voice Agent Service starting...
2025-12-30 15:44:36,096 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-30 15:44:36,097 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-30 15:44:36,097 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-30 15:44:36,097 - app.main - INFO - STT Model: base.en
2025-12-30 15:44:36,098 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-30 15:44:36,098 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-30 15:44:36,098 - app.main - INFO - ============================================================
2025-12-30 15:44:36,099 - app.api.session_manager - INFO - Session Manager started
2025-12-30 15:45:55,241 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 15:45:56,066 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 15:49:51,288 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 15:49:52,316 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 15:50:03,970 - app.api.session_manager - INFO - Session created: 55209aa6-3e08-4581-9a19-06b611489b09
2025-12-30 15:50:03,971 - app.api.routes - INFO - Session started: 55209aa6-3e08-4581-9a19-06b611489b09, Turn: 2ee18282-413b-41ab-b032-81aad10fe45c, Status: SessionStatus.LISTENING
2025-12-30 15:50:03,981 - app.api.ws - INFO - WebSocket connected for session 55209aa6-3e08-4581-9a19-06b611489b09. Total connections for session: 1
2025-12-30 15:50:04,000 - app.api.ws - INFO - Audio streaming started for session 55209aa6-3e08-4581-9a19-06b611489b09: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 15:50:05,323 - app.api.ws - INFO - Audio streaming ended for session 55209aa6-3e08-4581-9a19-06b611489b09
2025-12-30 15:50:05,323 - app.api.ws - INFO - Total audio received: 18658 bytes
2025-12-30 15:50:05,324 - app.api.ws - ERROR - WebSocket error for session 55209aa6-3e08-4581-9a19-06b611489b09: type object 'SessionStatus' has no attribute 'THINKING'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 291, in websocket_endpoint
    await connection_manager.handle_audio_end(session_id)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 122, in handle_audio_end
    await self.broadcast_state(session_id, SessionStatus.THINKING)
                                           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'SessionStatus' has no attribute 'THINKING'
2025-12-30 15:50:05,326 - app.api.ws - INFO - WebSocket disconnected for session 55209aa6-3e08-4581-9a19-06b611489b09
2025-12-30 15:50:07,343 - app.api.ws - INFO - WebSocket connected for session 55209aa6-3e08-4581-9a19-06b611489b09. Total connections for session: 1
2025-12-30 15:54:44,850 - app.api.ws - ERROR - WebSocket error for session 55209aa6-3e08-4581-9a19-06b611489b09: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 15:54:44,908 - app.api.ws - INFO - WebSocket disconnected for session 55209aa6-3e08-4581-9a19-06b611489b09
2025-12-30 15:54:44,961 - app.main - INFO - Voice Agent Service shutting down...
2025-12-30 15:54:44,963 - app.api.session_manager - INFO - Session Manager stopped
2025-12-30 15:55:00,105 - app.main - INFO - ============================================================
2025-12-30 15:55:00,105 - app.main - INFO - Voice Agent Service starting...
2025-12-30 15:55:00,106 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-30 15:55:00,106 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-30 15:55:00,106 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-30 15:55:00,107 - app.main - INFO - STT Model: base.en
2025-12-30 15:55:00,107 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-30 15:55:00,107 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-30 15:55:00,107 - app.main - INFO - ============================================================
2025-12-30 15:55:00,108 - app.api.session_manager - INFO - Session Manager started
2025-12-30 15:55:02,290 - app.api.ws - INFO - WebSocket connected for session 55209aa6-3e08-4581-9a19-06b611489b09. Total connections for session: 1
2025-12-30 15:55:07,610 - app.api.session_manager - INFO - Session created: 5c6b7b45-5ff1-4604-bf73-2072b8d81051
2025-12-30 15:55:07,612 - app.api.routes - INFO - Session started: 5c6b7b45-5ff1-4604-bf73-2072b8d81051, Turn: 507bf2d8-1b7b-43fb-b4ab-36ddd4e0481a, Status: SessionStatus.LISTENING
2025-12-30 15:55:07,619 - app.api.ws - INFO - WebSocket connected for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051. Total connections for session: 1
2025-12-30 15:55:07,658 - app.api.ws - INFO - Audio streaming started for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 15:55:09,407 - app.api.ws - INFO - Audio streaming ended for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051
2025-12-30 15:55:09,407 - app.api.ws - INFO - Total audio received: 26450 bytes
2025-12-30 15:55:09,474 - app.api.ws - ERROR - Error processing audio for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051: No module named 'pyaudioop'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\pydub\utils.py", line 14, in <module>
    import audioop
ModuleNotFoundError: No module named 'audioop'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 142, in _process_audio
    await process_audio_stream(session_id, audio_data)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 263, in process_audio_stream
    from pydub import AudioSegment
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\pydub\__init__.py", line 1, in <module>
    from .audio_segment import AudioSegment
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\pydub\audio_segment.py", line 11, in <module>
    from .utils import mediainfo_json, fsdecode
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\pydub\utils.py", line 16, in <module>
    import pyaudioop as audioop
ModuleNotFoundError: No module named 'pyaudioop'
2025-12-30 15:55:09,565 - app.api.ws - WARNING - Received audio chunk for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051 without audio.start
2025-12-30 16:00:18,968 - app.api.ws - ERROR - WebSocket error for session 55209aa6-3e08-4581-9a19-06b611489b09: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:00:18,972 - app.api.ws - INFO - WebSocket disconnected for session 55209aa6-3e08-4581-9a19-06b611489b09
2025-12-30 16:00:18,973 - app.api.ws - ERROR - WebSocket error for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:00:18,975 - app.api.ws - INFO - WebSocket disconnected for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051
2025-12-30 16:00:19,080 - app.main - INFO - Voice Agent Service shutting down...
2025-12-30 16:00:19,080 - app.api.session_manager - INFO - Session Manager stopped
2025-12-30 16:00:26,573 - app.main - INFO - ============================================================
2025-12-30 16:00:26,573 - app.main - INFO - Voice Agent Service starting...
2025-12-30 16:00:26,574 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-30 16:00:26,574 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-30 16:00:26,574 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-30 16:00:26,575 - app.main - INFO - STT Model: base.en
2025-12-30 16:00:26,575 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-30 16:00:26,575 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-30 16:00:26,576 - app.main - INFO - ============================================================
2025-12-30 16:00:26,577 - app.api.session_manager - INFO - Session Manager started
2025-12-30 16:00:26,795 - app.api.ws - INFO - WebSocket connected for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051. Total connections for session: 1
2025-12-30 16:02:09,402 - app.api.ws - ERROR - WebSocket error for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:02:09,409 - app.api.ws - INFO - WebSocket disconnected for session 5c6b7b45-5ff1-4604-bf73-2072b8d81051
2025-12-30 16:02:11,256 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:02:12,493 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:04:22,355 - app.api.session_manager - INFO - Session created: 372fc97b-a6c2-4d91-a718-eba9e4c3410a
2025-12-30 16:04:22,355 - app.api.routes - INFO - Session started: 372fc97b-a6c2-4d91-a718-eba9e4c3410a, Turn: 37ec55b7-f51a-4378-8dc0-e9b053520b94, Status: SessionStatus.LISTENING
2025-12-30 16:04:22,363 - app.api.ws - INFO - WebSocket connected for session 372fc97b-a6c2-4d91-a718-eba9e4c3410a. Total connections for session: 1
2025-12-30 16:04:22,389 - app.api.ws - INFO - Audio streaming started for session 372fc97b-a6c2-4d91-a718-eba9e4c3410a: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:04:23,673 - app.api.ws - INFO - Audio streaming ended for session 372fc97b-a6c2-4d91-a718-eba9e4c3410a
2025-12-30 16:04:23,674 - app.api.ws - INFO - Total audio received: 18658 bytes
2025-12-30 16:04:23,675 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 372fc97b-a6c2-4d91-a718-eba9e4c3410a: 18658 bytes
2025-12-30 16:04:23,681 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:04:23,977 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:04:23,981 - app.pipeline.pipeline_runner - INFO - Converted audio: 18240 samples at 16000Hz
2025-12-30 16:04:23,983 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-30 16:04:23,984 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-30 16:04:23,984 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-30 16:04:25,769 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-30 16:04:27,036 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-30 16:04:27,038 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-30 16:04:27,039 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-30 16:04:27,059 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-30 16:04:27,060 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-30 16:04:27,061 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-30 16:04:27,061 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-30 16:04:27,062 - app.pipeline.pipeline_runner - INFO - Processing audio for session 372fc97b-a6c2-4d91-a718-eba9e4c3410a, turn 37ec55b7-f51a-4378-8dc0-e9b053520b94
2025-12-30 16:04:27,063 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:04:27,063 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:04:27,064 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:04:27,064 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:04:27,065 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 18240 samples
2025-12-30 16:04:27,066 - app.pipeline.processors.vad_processor - INFO - VAD complete: 18240 -> 11520 samples (0.72s)
2025-12-30 16:04:27,066 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:04:27,067 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-30 16:04:27,068 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-30 16:04:31,872 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-30 16:04:31,873 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-30 16:04:31,874 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-30 16:04:57,904 - app.api.session_manager - INFO - Session created: 67d22042-7ec8-43e5-afa5-0041b69c66d5
2025-12-30 16:04:57,904 - app.api.routes - INFO - Session started: 67d22042-7ec8-43e5-afa5-0041b69c66d5, Turn: 6d98818d-4be5-4746-bb7e-be8f87489af7, Status: SessionStatus.LISTENING
2025-12-30 16:04:57,922 - app.api.ws - INFO - WebSocket connected for session 67d22042-7ec8-43e5-afa5-0041b69c66d5. Total connections for session: 1
2025-12-30 16:04:57,926 - app.api.ws - INFO - Audio streaming started for session 67d22042-7ec8-43e5-afa5-0041b69c66d5: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:05:01,826 - app.api.ws - INFO - Audio streaming ended for session 67d22042-7ec8-43e5-afa5-0041b69c66d5
2025-12-30 16:05:01,827 - app.api.ws - INFO - Total audio received: 61514 bytes
2025-12-30 16:05:01,828 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 67d22042-7ec8-43e5-afa5-0041b69c66d5: 61514 bytes
2025-12-30 16:05:01,829 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:05:02,043 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:05:02,045 - app.pipeline.pipeline_runner - INFO - Converted audio: 60480 samples at 16000Hz
2025-12-30 16:05:02,047 - app.pipeline.pipeline_runner - INFO - Processing audio for session 67d22042-7ec8-43e5-afa5-0041b69c66d5, turn 6d98818d-4be5-4746-bb7e-be8f87489af7
2025-12-30 16:05:02,048 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:05:02,048 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:05:02,048 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:05:02,048 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:05:02,049 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 60480 samples
2025-12-30 16:05:02,051 - app.pipeline.processors.vad_processor - INFO - VAD complete: 60480 -> 40320 samples (2.52s)
2025-12-30 16:05:02,051 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:05:02,051 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 40320 samples, 2.52s
2025-12-30 16:05:02,052 - faster_whisper - INFO - Processing audio with duration 00:02.520
2025-12-30 16:05:03,530 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello hello hello' (1.48s, language=en, probability=1.00)
2025-12-30 16:05:03,530 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello hello hello'
2025-12-30 16:05:03,531 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 16:05:03,531 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello hello hello'
2025-12-30 16:05:03,531 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-30 16:05:03,532 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-30 16:05:03,532 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello hello hello'
2025-12-30 16:05:19,862 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! How may I assist you today?' (16.33s)
2025-12-30 16:05:19,862 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! How may I assist you today?'
2025-12-30 16:05:19,863 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 16:05:19,863 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! How may I assist you today?'
2025-12-30 16:05:19,863 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! How may I assist you today?'
2025-12-30 16:05:19,864 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! How may I assist you today?'
2025-12-30 16:05:19,864 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:05:19,864 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 17816ms
2025-12-30 16:05:19,864 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:05:19,865 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello hello hello', reply='Hello! How may I assist you today?', route=llm, time=17816ms
2025-12-30 16:05:19,870 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 16:05:22,689 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-30 16:05:22,690 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-30 16:05:24,905 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-30 16:05:24,906 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Hello! How may I assist you today?' (speed=1.0)
2025-12-30 16:05:24,908 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-30 16:05:31,092 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\67d22042-7ec8-43e5-afa5-0041b69c66d5\6d98818d-4be5-4746-bb7e-be8f87489af7.wav (101420 bytes, 2.11s, 24000Hz)
2025-12-30 16:05:31,095 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\67d22042-7ec8-43e5-afa5-0041b69c66d5\6d98818d-4be5-4746-bb7e-be8f87489af7.wav
2025-12-30 16:05:31,217 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\67d22042-7ec8-43e5-afa5-0041b69c66d5\6d98818d-4be5-4746-bb7e-be8f87489af7.wav
2025-12-30 16:05:31,726 - app.pipeline.pipeline_runner - INFO - Session 67d22042-7ec8-43e5-afa5-0041b69c66d5 turn 6d98818d-4be5-4746-bb7e-be8f87489af7 completed successfully
2025-12-30 16:09:27,120 - app.api.session_manager - INFO - Cleaning up expired session: 372fc97b-a6c2-4d91-a718-eba9e4c3410a
2025-12-30 16:09:27,120 - app.api.session_manager - INFO - Session deleted: 372fc97b-a6c2-4d91-a718-eba9e4c3410a
2025-12-30 16:10:28,119 - app.api.ws - ERROR - WebSocket error for session 372fc97b-a6c2-4d91-a718-eba9e4c3410a: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:10:28,122 - app.api.ws - INFO - WebSocket disconnected for session 372fc97b-a6c2-4d91-a718-eba9e4c3410a
2025-12-30 16:10:28,123 - app.api.ws - ERROR - WebSocket error for session 67d22042-7ec8-43e5-afa5-0041b69c66d5: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:10:28,126 - app.api.ws - INFO - WebSocket disconnected for session 67d22042-7ec8-43e5-afa5-0041b69c66d5
2025-12-30 16:10:28,227 - app.main - INFO - Voice Agent Service shutting down...
2025-12-30 16:10:28,227 - app.api.session_manager - INFO - Session Manager stopped
2025-12-30 16:10:35,634 - app.main - INFO - ============================================================
2025-12-30 16:10:35,634 - app.main - INFO - Voice Agent Service starting...
2025-12-30 16:10:35,635 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-30 16:10:35,635 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-30 16:10:35,635 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-30 16:10:35,635 - app.main - INFO - STT Model: base.en
2025-12-30 16:10:35,635 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-30 16:10:35,636 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-30 16:10:35,636 - app.main - INFO - ============================================================
2025-12-30 16:10:35,636 - app.api.session_manager - INFO - Session Manager started
2025-12-30 16:10:35,779 - app.api.ws - INFO - WebSocket connected for session 67d22042-7ec8-43e5-afa5-0041b69c66d5. Total connections for session: 1
2025-12-30 16:15:25,986 - app.api.session_manager - INFO - Session created: 9f741c5d-020e-4e68-84c8-3e27a22e00ce
2025-12-30 16:15:25,986 - app.api.routes - INFO - Session started: 9f741c5d-020e-4e68-84c8-3e27a22e00ce, Turn: eb287349-33d6-4c97-a669-25e6451358e2, Status: SessionStatus.LISTENING
2025-12-30 16:15:26,001 - app.api.ws - INFO - WebSocket connected for session 9f741c5d-020e-4e68-84c8-3e27a22e00ce. Total connections for session: 1
2025-12-30 16:15:26,005 - app.api.ws - INFO - Audio streaming started for session 9f741c5d-020e-4e68-84c8-3e27a22e00ce: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:15:29,505 - app.api.ws - INFO - Audio streaming ended for session 9f741c5d-020e-4e68-84c8-3e27a22e00ce
2025-12-30 16:15:29,505 - app.api.ws - INFO - Total audio received: 55670 bytes
2025-12-30 16:15:29,506 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 9f741c5d-020e-4e68-84c8-3e27a22e00ce: 55670 bytes
2025-12-30 16:15:29,510 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:15:29,700 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:15:29,702 - app.pipeline.pipeline_runner - INFO - Converted audio: 54720 samples at 16000Hz
2025-12-30 16:15:29,704 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-30 16:15:29,705 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-30 16:15:29,705 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-30 16:15:31,340 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-30 16:15:32,109 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-30 16:15:32,109 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-30 16:15:32,109 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-30 16:15:32,120 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-30 16:15:32,121 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-30 16:15:32,121 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-30 16:15:32,122 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-30 16:15:32,122 - app.pipeline.pipeline_runner - INFO - Processing audio for session 9f741c5d-020e-4e68-84c8-3e27a22e00ce, turn eb287349-33d6-4c97-a669-25e6451358e2
2025-12-30 16:15:32,123 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:15:32,124 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:15:32,124 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:15:32,124 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:15:32,124 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 54720 samples
2025-12-30 16:15:32,125 - app.pipeline.processors.vad_processor - INFO - VAD complete: 54720 -> 11520 samples (0.72s)
2025-12-30 16:15:32,126 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:15:32,126 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-30 16:15:32,126 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-30 16:15:33,241 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-30 16:15:33,242 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-30 16:15:33,242 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-30 16:15:49,825 - app.api.session_manager - INFO - Session created: fc113945-fa5c-43d4-8002-8565ab1e6476
2025-12-30 16:15:49,826 - app.api.routes - INFO - Session started: fc113945-fa5c-43d4-8002-8565ab1e6476, Turn: 38ecaaf7-aae6-4606-a4c4-b0ba388bcd56, Status: SessionStatus.LISTENING
2025-12-30 16:15:49,846 - app.api.ws - INFO - WebSocket connected for session fc113945-fa5c-43d4-8002-8565ab1e6476. Total connections for session: 1
2025-12-30 16:15:49,849 - app.api.ws - INFO - Audio streaming started for session fc113945-fa5c-43d4-8002-8565ab1e6476: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:15:53,460 - app.api.ws - INFO - Audio streaming ended for session fc113945-fa5c-43d4-8002-8565ab1e6476
2025-12-30 16:15:53,460 - app.api.ws - INFO - Total audio received: 57618 bytes
2025-12-30 16:15:53,461 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session fc113945-fa5c-43d4-8002-8565ab1e6476: 57618 bytes
2025-12-30 16:15:53,463 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:15:53,674 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:15:53,677 - app.pipeline.pipeline_runner - INFO - Converted audio: 56640 samples at 16000Hz
2025-12-30 16:15:53,679 - app.pipeline.pipeline_runner - INFO - Processing audio for session fc113945-fa5c-43d4-8002-8565ab1e6476, turn 38ecaaf7-aae6-4606-a4c4-b0ba388bcd56
2025-12-30 16:15:53,680 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:15:53,680 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:15:53,680 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:15:53,681 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:15:53,681 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 56640 samples
2025-12-30 16:15:53,684 - app.pipeline.processors.vad_processor - INFO - VAD complete: 56640 -> 43680 samples (2.73s)
2025-12-30 16:15:53,684 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:15:53,684 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 43680 samples, 2.73s
2025-12-30 16:15:53,685 - faster_whisper - INFO - Processing audio with duration 00:02.730
2025-12-30 16:15:55,058 - app.pipeline.processors.stt_processor - INFO - Transcription complete: '1 is 5 plus 5.' (1.37s, language=en, probability=1.00)
2025-12-30 16:15:55,058 - app.pipeline.voice_pipeline - INFO - Transcript: '1 is 5 plus 5.'
2025-12-30 16:15:55,059 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 16:15:55,059 - app.pipeline.processors.skills_router - INFO - Routing transcript: '1 is 5 plus 5.'
2025-12-30 16:15:55,060 - app.pipeline.processors.skills_router - INFO - Math query detected
2025-12-30 16:15:55,060 - app.utils.text_math - INFO - Parsed: 1.0 add 5.0
2025-12-30 16:15:55,061 - app.pipeline.processors.skills_router - INFO - Math expression: 1.0 add 5.0
2025-12-30 16:15:55,061 - app.pipeline.processors.skills_router - INFO - Math response: 'One plus five is six.'
2025-12-30 16:15:55,062 - app.pipeline.voice_pipeline - INFO - Math route: 'One plus five is six.'
2025-12-30 16:15:55,062 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 16:15:55,062 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'One plus five is six.'
2025-12-30 16:15:55,063 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'One plus five is six.'
2025-12-30 16:15:55,063 - app.pipeline.voice_pipeline - INFO - Final reply: 'One plus five is six.'
2025-12-30 16:15:55,063 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:15:55,064 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1383ms
2025-12-30 16:15:55,064 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:15:55,065 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='1 is 5 plus 5.', reply='One plus five is six.', route=math, time=1383ms
2025-12-30 16:15:55,071 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 16:15:57,110 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-30 16:15:57,110 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-30 16:15:59,061 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-30 16:15:59,062 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'One plus five is six.' (speed=1.0)
2025-12-30 16:15:59,063 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-30 16:16:01,507 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\fc113945-fa5c-43d4-8002-8565ab1e6476\38ecaaf7-aae6-4606-a4c4-b0ba388bcd56.wav (67628 bytes, 1.41s, 24000Hz)
2025-12-30 16:16:01,509 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\fc113945-fa5c-43d4-8002-8565ab1e6476\38ecaaf7-aae6-4606-a4c4-b0ba388bcd56.wav
2025-12-30 16:16:01,626 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\fc113945-fa5c-43d4-8002-8565ab1e6476\38ecaaf7-aae6-4606-a4c4-b0ba388bcd56.wav
2025-12-30 16:16:02,131 - app.pipeline.pipeline_runner - INFO - Session fc113945-fa5c-43d4-8002-8565ab1e6476 turn 38ecaaf7-aae6-4606-a4c4-b0ba388bcd56 completed successfully
2025-12-30 16:20:35,726 - app.api.session_manager - INFO - Cleaning up expired session: 9f741c5d-020e-4e68-84c8-3e27a22e00ce
2025-12-30 16:20:35,726 - app.api.session_manager - INFO - Session deleted: 9f741c5d-020e-4e68-84c8-3e27a22e00ce
2025-12-30 16:20:53,530 - app.api.ws - ERROR - WebSocket error for session 67d22042-7ec8-43e5-afa5-0041b69c66d5: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:20:53,534 - app.api.ws - INFO - WebSocket disconnected for session 67d22042-7ec8-43e5-afa5-0041b69c66d5
2025-12-30 16:20:53,539 - app.api.ws - ERROR - WebSocket error for session 9f741c5d-020e-4e68-84c8-3e27a22e00ce: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:20:53,544 - app.api.ws - INFO - WebSocket disconnected for session 9f741c5d-020e-4e68-84c8-3e27a22e00ce
2025-12-30 16:20:53,547 - app.api.ws - ERROR - WebSocket error for session fc113945-fa5c-43d4-8002-8565ab1e6476: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:20:53,550 - app.api.ws - INFO - WebSocket disconnected for session fc113945-fa5c-43d4-8002-8565ab1e6476
2025-12-30 16:20:55,102 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:20:56,270 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:20:59,979 - app.api.session_manager - INFO - Session created: d6bdf6cd-2292-4b7b-b25c-649b5e251650
2025-12-30 16:20:59,979 - app.api.routes - INFO - Session started: d6bdf6cd-2292-4b7b-b25c-649b5e251650, Turn: 53c7701c-d528-4c38-b807-b49c3e2b3002, Status: SessionStatus.LISTENING
2025-12-30 16:20:59,995 - app.api.ws - INFO - WebSocket connected for session d6bdf6cd-2292-4b7b-b25c-649b5e251650. Total connections for session: 1
2025-12-30 16:21:00,033 - app.api.ws - INFO - Audio streaming started for session d6bdf6cd-2292-4b7b-b25c-649b5e251650: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:21:02,911 - app.api.ws - INFO - Audio streaming ended for session d6bdf6cd-2292-4b7b-b25c-649b5e251650
2025-12-30 16:21:02,912 - app.api.ws - INFO - Total audio received: 43982 bytes
2025-12-30 16:21:02,912 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session d6bdf6cd-2292-4b7b-b25c-649b5e251650: 43982 bytes
2025-12-30 16:21:02,915 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:21:03,153 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:21:03,156 - app.pipeline.pipeline_runner - INFO - Converted audio: 43200 samples at 16000Hz
2025-12-30 16:21:03,158 - app.pipeline.pipeline_runner - INFO - Processing audio for session d6bdf6cd-2292-4b7b-b25c-649b5e251650, turn 53c7701c-d528-4c38-b807-b49c3e2b3002
2025-12-30 16:21:03,159 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:21:03,160 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:21:03,160 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:21:03,161 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:21:03,161 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 43200 samples
2025-12-30 16:21:03,163 - app.pipeline.processors.vad_processor - INFO - VAD complete: 43200 -> 36480 samples (2.28s)
2025-12-30 16:21:03,164 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:21:03,165 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 36480 samples, 2.28s
2025-12-30 16:21:03,165 - faster_whisper - INFO - Processing audio with duration 00:02.280
2025-12-30 16:21:04,850 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'What is 5 plus 5?' (1.68s, language=en, probability=1.00)
2025-12-30 16:21:04,850 - app.pipeline.voice_pipeline - INFO - Transcript: 'What is 5 plus 5?'
2025-12-30 16:21:04,851 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 16:21:04,851 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'What is 5 plus 5?'
2025-12-30 16:21:04,852 - app.pipeline.processors.skills_router - INFO - Math query detected
2025-12-30 16:21:04,852 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-30 16:21:04,853 - app.pipeline.processors.skills_router - INFO - Math expression: 5.0 add 5.0
2025-12-30 16:21:04,854 - app.pipeline.processors.skills_router - INFO - Math response: 'Five plus five is ten.'
2025-12-30 16:21:04,854 - app.pipeline.voice_pipeline - INFO - Math route: 'Five plus five is ten.'
2025-12-30 16:21:04,855 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 16:21:04,856 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Five plus five is ten.'
2025-12-30 16:21:04,856 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Five plus five is ten.'
2025-12-30 16:21:04,857 - app.pipeline.voice_pipeline - INFO - Final reply: 'Five plus five is ten.'
2025-12-30 16:21:04,858 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:21:04,858 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1698ms
2025-12-30 16:21:04,859 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:21:04,860 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='What is 5 plus 5?', reply='Five plus five is ten.', route=math, time=1698ms
2025-12-30 16:21:04,862 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 16:21:04,864 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-30 16:21:04,867 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-30 16:21:07,077 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-30 16:21:07,077 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Five plus five is ten.' (speed=1.0)
2025-12-30 16:21:07,078 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-30 16:21:09,034 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\d6bdf6cd-2292-4b7b-b25c-649b5e251650\53c7701c-d528-4c38-b807-b49c3e2b3002.wav (74796 bytes, 1.56s, 24000Hz)
2025-12-30 16:21:09,035 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\d6bdf6cd-2292-4b7b-b25c-649b5e251650\53c7701c-d528-4c38-b807-b49c3e2b3002.wav
2025-12-30 16:21:09,157 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\d6bdf6cd-2292-4b7b-b25c-649b5e251650\53c7701c-d528-4c38-b807-b49c3e2b3002.wav
2025-12-30 16:21:09,652 - app.pipeline.pipeline_runner - INFO - Session d6bdf6cd-2292-4b7b-b25c-649b5e251650 turn 53c7701c-d528-4c38-b807-b49c3e2b3002 completed successfully
2025-12-30 16:21:35,730 - app.api.session_manager - INFO - Cleaning up expired session: fc113945-fa5c-43d4-8002-8565ab1e6476
2025-12-30 16:21:35,730 - app.api.session_manager - INFO - Session deleted: fc113945-fa5c-43d4-8002-8565ab1e6476
2025-12-30 16:22:43,080 - app.api.session_manager - INFO - Session created: 87e79aa2-56cc-4a49-900f-e43dc8cf5da4
2025-12-30 16:22:43,081 - app.api.routes - INFO - Session started: 87e79aa2-56cc-4a49-900f-e43dc8cf5da4, Turn: 5510f22d-aad5-4d69-9651-aeef28701ebe, Status: SessionStatus.LISTENING
2025-12-30 16:22:43,115 - app.api.ws - INFO - WebSocket connected for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4. Total connections for session: 1
2025-12-30 16:22:43,127 - app.api.ws - INFO - Audio streaming started for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:22:46,333 - app.api.ws - INFO - Audio streaming ended for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4
2025-12-30 16:22:46,334 - app.api.ws - INFO - Total audio received: 49826 bytes
2025-12-30 16:22:46,335 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4: 49826 bytes
2025-12-30 16:22:46,340 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:22:46,596 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:22:46,598 - app.pipeline.pipeline_runner - INFO - Converted audio: 48960 samples at 16000Hz
2025-12-30 16:22:46,600 - app.pipeline.pipeline_runner - INFO - Processing audio for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4, turn 5510f22d-aad5-4d69-9651-aeef28701ebe
2025-12-30 16:22:46,600 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:22:46,601 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:22:46,601 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:22:46,602 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:22:46,602 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 48960 samples
2025-12-30 16:22:46,605 - app.pipeline.processors.vad_processor - INFO - VAD complete: 48960 -> 39840 samples (2.49s)
2025-12-30 16:22:46,605 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:22:46,606 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 39840 samples, 2.49s
2025-12-30 16:22:46,606 - faster_whisper - INFO - Processing audio with duration 00:02.490
2025-12-30 16:22:48,251 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'so what is 5 plus 5?' (1.65s, language=en, probability=1.00)
2025-12-30 16:22:48,252 - app.pipeline.voice_pipeline - INFO - Transcript: 'so what is 5 plus 5?'
2025-12-30 16:22:48,252 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 16:22:48,254 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'so what is 5 plus 5?'
2025-12-30 16:22:48,255 - app.pipeline.processors.skills_router - INFO - Math query detected
2025-12-30 16:22:48,255 - app.utils.text_math - INFO - Parsed: 5.0 add 5.0
2025-12-30 16:22:48,255 - app.pipeline.processors.skills_router - INFO - Math expression: 5.0 add 5.0
2025-12-30 16:22:48,256 - app.pipeline.processors.skills_router - INFO - Math response: 'Five plus five is ten.'
2025-12-30 16:22:48,256 - app.pipeline.voice_pipeline - INFO - Math route: 'Five plus five is ten.'
2025-12-30 16:22:48,257 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 16:22:48,258 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Five plus five is ten.'
2025-12-30 16:22:48,258 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Five plus five is ten.'
2025-12-30 16:22:48,258 - app.pipeline.voice_pipeline - INFO - Final reply: 'Five plus five is ten.'
2025-12-30 16:22:48,259 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:22:48,259 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1658ms
2025-12-30 16:22:48,260 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:22:48,260 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='so what is 5 plus 5?', reply='Five plus five is ten.', route=math, time=1658ms
2025-12-30 16:22:48,263 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 16:22:48,264 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-30 16:22:48,265 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-30 16:22:50,764 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-30 16:22:50,765 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Five plus five is ten.' (speed=1.0)
2025-12-30 16:22:50,767 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-30 16:22:52,767 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\87e79aa2-56cc-4a49-900f-e43dc8cf5da4\5510f22d-aad5-4d69-9651-aeef28701ebe.wav (74796 bytes, 1.56s, 24000Hz)
2025-12-30 16:22:52,768 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\87e79aa2-56cc-4a49-900f-e43dc8cf5da4\5510f22d-aad5-4d69-9651-aeef28701ebe.wav
2025-12-30 16:22:52,868 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\87e79aa2-56cc-4a49-900f-e43dc8cf5da4\5510f22d-aad5-4d69-9651-aeef28701ebe.wav
2025-12-30 16:22:53,376 - app.pipeline.pipeline_runner - INFO - Session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4 turn 5510f22d-aad5-4d69-9651-aeef28701ebe completed successfully
2025-12-30 16:26:35,776 - app.api.session_manager - INFO - Cleaning up expired session: d6bdf6cd-2292-4b7b-b25c-649b5e251650
2025-12-30 16:26:35,776 - app.api.session_manager - INFO - Session deleted: d6bdf6cd-2292-4b7b-b25c-649b5e251650
2025-12-30 16:27:56,496 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:27:58,064 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:28:35,789 - app.api.session_manager - INFO - Cleaning up expired session: 87e79aa2-56cc-4a49-900f-e43dc8cf5da4
2025-12-30 16:28:35,789 - app.api.session_manager - INFO - Session deleted: 87e79aa2-56cc-4a49-900f-e43dc8cf5da4
2025-12-30 16:30:12,044 - app.api.ws - ERROR - WebSocket error for session d6bdf6cd-2292-4b7b-b25c-649b5e251650: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:30:12,046 - app.api.ws - INFO - WebSocket disconnected for session d6bdf6cd-2292-4b7b-b25c-649b5e251650
2025-12-30 16:30:12,047 - app.api.ws - ERROR - WebSocket error for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:30:12,049 - app.api.ws - INFO - WebSocket disconnected for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4
2025-12-30 16:30:12,149 - app.main - INFO - Voice Agent Service shutting down...
2025-12-30 16:30:12,150 - app.api.session_manager - INFO - Session Manager stopped
2025-12-30 16:30:20,105 - app.main - INFO - ============================================================
2025-12-30 16:30:20,105 - app.main - INFO - Voice Agent Service starting...
2025-12-30 16:30:20,106 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-30 16:30:20,106 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-30 16:30:20,106 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-30 16:30:20,107 - app.main - INFO - STT Model: base.en
2025-12-30 16:30:20,107 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-30 16:30:20,107 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-30 16:30:20,107 - app.main - INFO - ============================================================
2025-12-30 16:30:20,108 - app.api.session_manager - INFO - Session Manager started
2025-12-30 16:30:20,304 - app.api.ws - INFO - WebSocket connected for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4. Total connections for session: 1
2025-12-30 16:32:06,949 - app.api.ws - ERROR - WebSocket error for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-30 16:32:06,956 - app.api.ws - INFO - WebSocket disconnected for session 87e79aa2-56cc-4a49-900f-e43dc8cf5da4
2025-12-30 16:32:09,418 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:32:12,408 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:32:12,429 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:32:13,806 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-30 16:32:18,901 - app.api.session_manager - INFO - Session created: 28d78a1a-5be0-404f-8ab8-17e437212443
2025-12-30 16:32:18,901 - app.api.routes - INFO - Session started: 28d78a1a-5be0-404f-8ab8-17e437212443, Turn: 92afe518-6c37-4478-967c-59de2543879e, Status: SessionStatus.LISTENING
2025-12-30 16:32:18,910 - app.api.ws - INFO - WebSocket connected for session 28d78a1a-5be0-404f-8ab8-17e437212443. Total connections for session: 1
2025-12-30 16:32:18,943 - app.api.ws - INFO - Audio streaming started for session 28d78a1a-5be0-404f-8ab8-17e437212443: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:32:21,510 - app.api.ws - INFO - Audio streaming ended for session 28d78a1a-5be0-404f-8ab8-17e437212443
2025-12-30 16:32:21,510 - app.api.ws - INFO - Total audio received: 40086 bytes
2025-12-30 16:32:21,511 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 28d78a1a-5be0-404f-8ab8-17e437212443: 40086 bytes
2025-12-30 16:32:21,516 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:32:21,767 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:32:21,780 - app.pipeline.pipeline_runner - INFO - Converted audio: 39360 samples at 16000Hz
2025-12-30 16:32:21,782 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-30 16:32:21,782 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-30 16:32:21,782 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-30 16:32:23,410 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-30 16:32:24,377 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-30 16:32:24,378 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-30 16:32:24,378 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-30 16:32:24,390 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-30 16:32:24,391 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-30 16:32:24,391 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-30 16:32:24,392 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-30 16:32:24,392 - app.pipeline.pipeline_runner - INFO - Processing audio for session 28d78a1a-5be0-404f-8ab8-17e437212443, turn 92afe518-6c37-4478-967c-59de2543879e
2025-12-30 16:32:24,393 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:32:24,393 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:32:24,394 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:32:24,394 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:32:24,395 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 39360 samples
2025-12-30 16:32:24,396 - app.pipeline.processors.vad_processor - INFO - VAD complete: 39360 -> 11520 samples (0.72s)
2025-12-30 16:32:24,396 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:32:24,396 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-30 16:32:24,397 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-30 16:32:28,270 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-30 16:32:28,270 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-30 16:32:28,272 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-30 16:37:20,186 - app.api.session_manager - INFO - Cleaning up expired session: 28d78a1a-5be0-404f-8ab8-17e437212443
2025-12-30 16:37:20,186 - app.api.session_manager - INFO - Session deleted: 28d78a1a-5be0-404f-8ab8-17e437212443
2025-12-30 16:38:48,417 - app.api.session_manager - INFO - Session created: e4813b21-bb4b-4c73-8859-b0b6886fdcab
2025-12-30 16:38:48,418 - app.api.routes - INFO - Session started: e4813b21-bb4b-4c73-8859-b0b6886fdcab, Turn: 2270a07a-4213-4a2b-9019-f345439e4f61, Status: SessionStatus.LISTENING
2025-12-30 16:38:48,444 - app.api.ws - INFO - WebSocket connected for session e4813b21-bb4b-4c73-8859-b0b6886fdcab. Total connections for session: 1
2025-12-30 16:38:48,450 - app.api.ws - INFO - Audio streaming started for session e4813b21-bb4b-4c73-8859-b0b6886fdcab: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-30 16:38:51,490 - app.api.ws - INFO - Audio streaming ended for session e4813b21-bb4b-4c73-8859-b0b6886fdcab
2025-12-30 16:38:51,490 - app.api.ws - INFO - Total audio received: 47878 bytes
2025-12-30 16:38:51,491 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session e4813b21-bb4b-4c73-8859-b0b6886fdcab: 47878 bytes
2025-12-30 16:38:51,494 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-30 16:38:51,667 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-30 16:38:51,668 - app.pipeline.pipeline_runner - INFO - Converted audio: 47040 samples at 16000Hz
2025-12-30 16:38:51,670 - app.pipeline.pipeline_runner - INFO - Processing audio for session e4813b21-bb4b-4c73-8859-b0b6886fdcab, turn 2270a07a-4213-4a2b-9019-f345439e4f61
2025-12-30 16:38:51,671 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:38:51,672 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-30 16:38:51,672 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:38:51,672 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-30 16:38:51,673 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 47040 samples
2025-12-30 16:38:51,674 - app.pipeline.processors.vad_processor - INFO - VAD complete: 47040 -> 16320 samples (1.02s)
2025-12-30 16:38:51,674 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-30 16:38:51,675 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 16320 samples, 1.02s
2025-12-30 16:38:51,675 - faster_whisper - INFO - Processing audio with duration 00:01.020
2025-12-30 16:38:52,855 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'No' (1.18s, language=en, probability=1.00)
2025-12-30 16:38:52,856 - app.pipeline.voice_pipeline - INFO - Transcript: 'No'
2025-12-30 16:38:52,856 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-30 16:38:52,857 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'No'
2025-12-30 16:38:52,857 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-30 16:38:52,857 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-30 16:38:52,858 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'No'
2025-12-30 16:38:57,672 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Understood.' (4.81s)
2025-12-30 16:38:57,672 - app.pipeline.voice_pipeline - INFO - LLM response: 'Understood.'
2025-12-30 16:38:57,673 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-30 16:38:57,673 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Understood.'
2025-12-30 16:38:57,673 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Understood.'
2025-12-30 16:38:57,674 - app.pipeline.voice_pipeline - INFO - Final reply: 'Understood.'
2025-12-30 16:38:57,674 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:38:57,674 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 6002ms
2025-12-30 16:38:57,674 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-30 16:38:57,675 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='No', reply='Understood.', route=llm, time=6002ms
2025-12-30 16:38:57,679 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-30 16:38:59,244 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-30 16:38:59,245 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-30 16:39:01,417 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-30 16:39:01,417 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Understood.' (speed=1.0)
2025-12-30 16:39:01,419 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-30 16:39:03,041 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\e4813b21-bb4b-4c73-8859-b0b6886fdcab\2270a07a-4213-4a2b-9019-f345439e4f61.wav (37932 bytes, 0.79s, 24000Hz)
2025-12-30 16:39:03,042 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\e4813b21-bb4b-4c73-8859-b0b6886fdcab\2270a07a-4213-4a2b-9019-f345439e4f61.wav
2025-12-30 16:39:03,167 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\e4813b21-bb4b-4c73-8859-b0b6886fdcab\2270a07a-4213-4a2b-9019-f345439e4f61.wav
2025-12-30 16:39:03,674 - app.pipeline.pipeline_runner - INFO - Session e4813b21-bb4b-4c73-8859-b0b6886fdcab turn 2270a07a-4213-4a2b-9019-f345439e4f61 completed successfully
2025-12-30 16:44:20,232 - app.api.session_manager - INFO - Cleaning up expired session: e4813b21-bb4b-4c73-8859-b0b6886fdcab
2025-12-30 16:44:20,233 - app.api.session_manager - INFO - Session deleted: e4813b21-bb4b-4c73-8859-b0b6886fdcab
2025-12-31 12:14:23,924 - app.api.session_manager - INFO - Session created: 428315c6-163d-45d2-ae70-427213261db7
2025-12-31 12:14:23,928 - app.api.routes - INFO - Session started: 428315c6-163d-45d2-ae70-427213261db7, Turn: ced69884-3d96-4d5e-9cd3-3776f3da6325, Status: SessionStatus.LISTENING
2025-12-31 12:14:23,976 - app.api.ws - INFO - WebSocket connected for session 428315c6-163d-45d2-ae70-427213261db7. Total connections for session: 1
2025-12-31 12:14:23,993 - app.api.ws - INFO - Audio streaming started for session 428315c6-163d-45d2-ae70-427213261db7: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:14:26,089 - app.api.ws - INFO - Audio streaming ended for session 428315c6-163d-45d2-ae70-427213261db7
2025-12-31 12:14:26,089 - app.api.ws - INFO - Total audio received: 32294 bytes
2025-12-31 12:14:26,092 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 428315c6-163d-45d2-ae70-427213261db7: 32294 bytes
2025-12-31 12:14:26,096 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:14:27,314 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:14:27,327 - app.pipeline.pipeline_runner - INFO - Converted audio: 31680 samples at 16000Hz
2025-12-31 12:14:27,328 - app.pipeline.pipeline_runner - INFO - Processing audio for session 428315c6-163d-45d2-ae70-427213261db7, turn ced69884-3d96-4d5e-9cd3-3776f3da6325
2025-12-31 12:14:27,330 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:14:27,331 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:14:27,331 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:14:27,331 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:14:27,332 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 31680 samples
2025-12-31 12:14:27,342 - app.pipeline.processors.vad_processor - INFO - VAD complete: 31680 -> 25920 samples (1.62s)
2025-12-31 12:14:27,343 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:14:27,344 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 25920 samples, 1.62s
2025-12-31 12:14:27,347 - faster_whisper - INFO - Processing audio with duration 00:01.620
2025-12-31 12:14:28,709 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'What day is today?' (1.36s, language=en, probability=1.00)
2025-12-31 12:14:28,710 - app.pipeline.voice_pipeline - INFO - Transcript: 'What day is today?'
2025-12-31 12:14:28,710 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:14:28,711 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'What day is today?'
2025-12-31 12:14:28,712 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:14:28,712 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:14:28,713 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'What day is today?'
2025-12-31 12:14:58,748 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2025-12-31 12:14:58,748 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2025-12-31 12:14:58,749 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:14:58,749 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2025-12-31 12:14:58,749 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2025-12-31 12:14:58,750 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2025-12-31 12:14:58,750 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:14:58,750 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 31419ms
2025-12-31 12:14:58,750 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:14:58,751 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='What day is today?', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=31419ms
2025-12-31 12:14:58,756 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:14:58,760 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:14:58,761 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:15:01,717 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:15:01,721 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'I'm thinking too slowly. Can you ask again?' (speed=1.0)
2025-12-31 12:15:01,723 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:15:04,620 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\428315c6-163d-45d2-ae70-427213261db7\ced69884-3d96-4d5e-9cd3-3776f3da6325.wav (118828 bytes, 2.47s, 24000Hz)
2025-12-31 12:15:04,621 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\428315c6-163d-45d2-ae70-427213261db7\ced69884-3d96-4d5e-9cd3-3776f3da6325.wav
2025-12-31 12:15:04,753 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\428315c6-163d-45d2-ae70-427213261db7\ced69884-3d96-4d5e-9cd3-3776f3da6325.wav
2025-12-31 12:15:05,261 - app.pipeline.pipeline_runner - INFO - Session 428315c6-163d-45d2-ae70-427213261db7 turn ced69884-3d96-4d5e-9cd3-3776f3da6325 completed successfully
2025-12-31 12:15:09,405 - app.api.session_manager - INFO - Session created: 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e
2025-12-31 12:15:09,410 - app.api.routes - INFO - Session started: 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e, Turn: 4b40d493-39aa-4f35-ab1c-3898ccf79912, Status: SessionStatus.LISTENING
2025-12-31 12:15:09,420 - app.api.ws - INFO - WebSocket connected for session 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e. Total connections for session: 1
2025-12-31 12:15:09,429 - app.api.ws - INFO - Audio streaming started for session 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:15:12,901 - app.api.ws - INFO - Audio streaming ended for session 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e
2025-12-31 12:15:12,901 - app.api.ws - INFO - Total audio received: 53722 bytes
2025-12-31 12:15:12,904 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e: 53722 bytes
2025-12-31 12:15:12,908 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:15:13,153 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:15:13,156 - app.pipeline.pipeline_runner - INFO - Converted audio: 52800 samples at 16000Hz
2025-12-31 12:15:13,158 - app.pipeline.pipeline_runner - INFO - Processing audio for session 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e, turn 4b40d493-39aa-4f35-ab1c-3898ccf79912
2025-12-31 12:15:13,159 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:13,160 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:15:13,160 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:13,160 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:15:13,161 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 52800 samples
2025-12-31 12:15:13,163 - app.pipeline.processors.vad_processor - INFO - VAD complete: 52800 -> 38400 samples (2.40s)
2025-12-31 12:15:13,163 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:15:13,164 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 38400 samples, 2.40s
2025-12-31 12:15:13,164 - faster_whisper - INFO - Processing audio with duration 00:02.400
2025-12-31 12:15:14,559 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Who knows what day is today?' (1.40s, language=en, probability=1.00)
2025-12-31 12:15:14,560 - app.pipeline.voice_pipeline - INFO - Transcript: 'Who knows what day is today?'
2025-12-31 12:15:14,560 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:15:14,561 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Who knows what day is today?'
2025-12-31 12:15:14,561 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:15:14,561 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:15:14,562 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Who knows what day is today?'
2025-12-31 12:15:30,894 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Today's date is 29th March.' (16.33s)
2025-12-31 12:15:30,894 - app.pipeline.voice_pipeline - INFO - LLM response: 'Today's date is 29th March.'
2025-12-31 12:15:30,895 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:15:30,895 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Today's date is 29th March.'
2025-12-31 12:15:30,895 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Today's date is 29th March.'
2025-12-31 12:15:30,896 - app.pipeline.voice_pipeline - INFO - Final reply: 'Today's date is 29th March.'
2025-12-31 12:15:30,896 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:30,896 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 17736ms
2025-12-31 12:15:30,896 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:30,897 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Who knows what day is today?', reply='Today's date is 29th March.', route=llm, time=17736ms
2025-12-31 12:15:30,898 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:15:30,900 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:15:30,900 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:15:33,784 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:15:33,786 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Today's date is 29th March.' (speed=1.0)
2025-12-31 12:15:33,789 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:15:33,797 - phonemizer - WARNING - words count mismatch on 100.0% of the lines (1/1)
2025-12-31 12:15:36,235 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e\4b40d493-39aa-4f35-ab1c-3898ccf79912.wav (105516 bytes, 2.20s, 24000Hz)
2025-12-31 12:15:36,238 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e\4b40d493-39aa-4f35-ab1c-3898ccf79912.wav
2025-12-31 12:15:36,403 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e\4b40d493-39aa-4f35-ab1c-3898ccf79912.wav
2025-12-31 12:15:36,904 - app.pipeline.pipeline_runner - INFO - Session 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e turn 4b40d493-39aa-4f35-ab1c-3898ccf79912 completed successfully
2025-12-31 12:15:51,162 - app.api.session_manager - INFO - Session created: beec59b3-2075-4073-897a-5ff0023efaeb
2025-12-31 12:15:51,163 - app.api.routes - INFO - Session started: beec59b3-2075-4073-897a-5ff0023efaeb, Turn: e0f3ee95-5f4e-4b3f-a7d8-60e0d8d1d203, Status: SessionStatus.LISTENING
2025-12-31 12:15:51,202 - app.api.ws - INFO - WebSocket connected for session beec59b3-2075-4073-897a-5ff0023efaeb. Total connections for session: 1
2025-12-31 12:15:51,214 - app.api.ws - INFO - Audio streaming started for session beec59b3-2075-4073-897a-5ff0023efaeb: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:15:53,671 - app.api.ws - INFO - Audio streaming ended for session beec59b3-2075-4073-897a-5ff0023efaeb
2025-12-31 12:15:53,671 - app.api.ws - INFO - Total audio received: 38138 bytes
2025-12-31 12:15:53,672 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session beec59b3-2075-4073-897a-5ff0023efaeb: 38138 bytes
2025-12-31 12:15:53,674 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:15:53,976 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:15:53,977 - app.pipeline.pipeline_runner - INFO - Converted audio: 37440 samples at 16000Hz
2025-12-31 12:15:53,979 - app.pipeline.pipeline_runner - INFO - Processing audio for session beec59b3-2075-4073-897a-5ff0023efaeb, turn e0f3ee95-5f4e-4b3f-a7d8-60e0d8d1d203
2025-12-31 12:15:53,980 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:53,980 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:15:53,980 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:53,980 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:15:53,981 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 37440 samples
2025-12-31 12:15:53,982 - app.pipeline.processors.vad_processor - INFO - VAD complete: 37440 -> 24000 samples (1.50s)
2025-12-31 12:15:53,982 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:15:53,983 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 24000 samples, 1.50s
2025-12-31 12:15:53,983 - faster_whisper - INFO - Processing audio with duration 00:01.500
2025-12-31 12:15:55,316 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Who are you?' (1.33s, language=en, probability=1.00)
2025-12-31 12:15:55,317 - app.pipeline.voice_pipeline - INFO - Transcript: 'Who are you?'
2025-12-31 12:15:55,317 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:15:55,318 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Who are you?'
2025-12-31 12:15:55,319 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:15:55,319 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:15:55,320 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Who are you?'
2025-12-31 12:15:55,976 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm an AI assistant here to help with games! How can I assist?' (0.66s)
2025-12-31 12:15:55,977 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm an AI assistant here to help with games! How can I assist?'
2025-12-31 12:15:55,977 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:15:55,978 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm an AI assistant here to help with games! How can I assist?'
2025-12-31 12:15:55,978 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm an AI assistant here to help with games! How can I assist?'
2025-12-31 12:15:55,978 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm an AI assistant here to help with games! How can I assist?'
2025-12-31 12:15:55,978 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:55,978 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1998ms
2025-12-31 12:15:55,979 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:15:55,979 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Who are you?', reply='I'm an AI assistant here to help with games! How can I assist?', route=llm, time=1998ms
2025-12-31 12:15:55,981 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:15:55,982 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:15:55,983 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:15:58,086 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:15:58,087 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'I'm an AI assistant here to help with games! How can I assist?' (speed=1.0)
2025-12-31 12:15:58,088 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:16:01,225 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\beec59b3-2075-4073-897a-5ff0023efaeb\e0f3ee95-5f4e-4b3f-a7d8-60e0d8d1d203.wav (182316 bytes, 3.80s, 24000Hz)
2025-12-31 12:16:01,227 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\beec59b3-2075-4073-897a-5ff0023efaeb\e0f3ee95-5f4e-4b3f-a7d8-60e0d8d1d203.wav
2025-12-31 12:16:01,366 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\beec59b3-2075-4073-897a-5ff0023efaeb\e0f3ee95-5f4e-4b3f-a7d8-60e0d8d1d203.wav
2025-12-31 12:16:01,862 - app.pipeline.pipeline_runner - INFO - Session beec59b3-2075-4073-897a-5ff0023efaeb turn e0f3ee95-5f4e-4b3f-a7d8-60e0d8d1d203 completed successfully
2025-12-31 12:18:16,294 - app.api.session_manager - INFO - Session created: cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2
2025-12-31 12:18:16,295 - app.api.routes - INFO - Session started: cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2, Turn: 79919124-1b46-486c-add6-cfacb4994900, Status: SessionStatus.LISTENING
2025-12-31 12:18:16,317 - app.api.ws - INFO - WebSocket connected for session cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2. Total connections for session: 1
2025-12-31 12:18:16,329 - app.api.ws - INFO - Audio streaming started for session cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:18:18,573 - app.api.ws - INFO - Audio streaming ended for session cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2
2025-12-31 12:18:18,574 - app.api.ws - INFO - Total audio received: 34242 bytes
2025-12-31 12:18:18,575 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2: 34242 bytes
2025-12-31 12:18:18,577 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:18:18,780 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:18:18,781 - app.pipeline.pipeline_runner - INFO - Converted audio: 33600 samples at 16000Hz
2025-12-31 12:18:18,783 - app.pipeline.pipeline_runner - INFO - Processing audio for session cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2, turn 79919124-1b46-486c-add6-cfacb4994900
2025-12-31 12:18:18,784 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:18,785 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:18:18,785 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:18,786 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:18:18,786 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 33600 samples
2025-12-31 12:18:18,787 - app.pipeline.processors.vad_processor - INFO - VAD complete: 33600 -> 23520 samples (1.47s)
2025-12-31 12:18:18,788 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:18:18,789 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 23520 samples, 1.47s
2025-12-31 12:18:18,789 - faster_whisper - INFO - Processing audio with duration 00:01.470
2025-12-31 12:18:20,190 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Are we playing again?' (1.40s, language=en, probability=1.00)
2025-12-31 12:18:20,191 - app.pipeline.voice_pipeline - INFO - Transcript: 'Are we playing again?'
2025-12-31 12:18:20,191 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:18:20,192 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Are we playing again?'
2025-12-31 12:18:20,192 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:18:20,192 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:18:20,193 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Are we playing again?'
2025-12-31 12:18:20,873 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Not sure; I'm not sure about that. Let me think.' (0.68s)
2025-12-31 12:18:20,874 - app.pipeline.voice_pipeline - INFO - LLM response: 'Not sure; I'm not sure about that. Let me think.'
2025-12-31 12:18:20,874 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:18:20,874 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Not sure; I'm not sure about that. Let me think.'
2025-12-31 12:18:20,875 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Not sure; I'm not sure about that. Let me think.'
2025-12-31 12:18:20,875 - app.pipeline.voice_pipeline - INFO - Final reply: 'Not sure; I'm not sure about that. Let me think.'
2025-12-31 12:18:20,875 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:20,876 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2091ms
2025-12-31 12:18:20,876 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:20,876 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Are we playing again?', reply='Not sure; I'm not sure about that. Let me think.', route=llm, time=2091ms
2025-12-31 12:18:20,878 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:18:20,879 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:18:20,880 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:18:22,846 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:18:22,847 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Not sure; I'm not sure about that. Let me think.' (speed=1.0)
2025-12-31 12:18:22,849 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:18:25,665 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2\79919124-1b46-486c-add6-cfacb4994900.wav (127020 bytes, 2.65s, 24000Hz)
2025-12-31 12:18:25,667 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2\79919124-1b46-486c-add6-cfacb4994900.wav
2025-12-31 12:18:25,800 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2\79919124-1b46-486c-add6-cfacb4994900.wav
2025-12-31 12:18:26,296 - app.pipeline.pipeline_runner - INFO - Session cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2 turn 79919124-1b46-486c-add6-cfacb4994900 completed successfully
2025-12-31 12:18:31,403 - app.api.session_manager - INFO - Session created: 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36
2025-12-31 12:18:31,404 - app.api.routes - INFO - Session started: 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36, Turn: 2ed7a21d-0102-40ed-9688-ffc86793bdc9, Status: SessionStatus.LISTENING
2025-12-31 12:18:31,417 - app.api.ws - INFO - WebSocket connected for session 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36. Total connections for session: 1
2025-12-31 12:18:31,422 - app.api.ws - INFO - Audio streaming started for session 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:18:34,174 - app.api.ws - INFO - Audio streaming ended for session 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36
2025-12-31 12:18:34,175 - app.api.ws - INFO - Total audio received: 42034 bytes
2025-12-31 12:18:34,176 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36: 42034 bytes
2025-12-31 12:18:34,177 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:18:34,375 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:18:34,376 - app.pipeline.pipeline_runner - INFO - Converted audio: 41280 samples at 16000Hz
2025-12-31 12:18:34,377 - app.pipeline.pipeline_runner - INFO - Processing audio for session 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36, turn 2ed7a21d-0102-40ed-9688-ffc86793bdc9
2025-12-31 12:18:34,378 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:34,378 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:18:34,378 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:34,379 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:18:34,379 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 41280 samples
2025-12-31 12:18:34,381 - app.pipeline.processors.vad_processor - INFO - VAD complete: 41280 -> 33120 samples (2.07s)
2025-12-31 12:18:34,381 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:18:34,381 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 33120 samples, 2.07s
2025-12-31 12:18:34,382 - faster_whisper - INFO - Processing audio with duration 00:02.070
2025-12-31 12:18:35,593 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Do you want to play that game?' (1.21s, language=en, probability=1.00)
2025-12-31 12:18:35,593 - app.pipeline.voice_pipeline - INFO - Transcript: 'Do you want to play that game?'
2025-12-31 12:18:35,594 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:18:35,594 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Do you want to play that game?'
2025-12-31 12:18:35,595 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:18:35,595 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:18:35,595 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Do you want to play that game?'
2025-12-31 12:18:36,350 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm just talking to you now. I won't be playing any games for you.' (0.75s)
2025-12-31 12:18:36,352 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm just talking to you now. I won't be playing any games for you.'
2025-12-31 12:18:36,352 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:18:36,353 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm just talking to you now. I won't be playing any games for you.'
2025-12-31 12:18:36,353 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm just talking to you now. I won't be playing any games for you.'
2025-12-31 12:18:36,353 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm just talking to you now. I won't be playing any games for you.'
2025-12-31 12:18:36,354 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:36,355 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1976ms
2025-12-31 12:18:36,355 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:18:36,356 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Do you want to play that game?', reply='I'm just talking to you now. I won't be playing any games for you.', route=llm, time=1976ms
2025-12-31 12:18:36,358 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:18:36,360 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:18:36,360 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:18:38,662 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:18:38,663 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'I'm just talking to you now. I won't be playing any games for you.' (speed=1.0)
2025-12-31 12:18:38,664 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:18:42,153 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36\2ed7a21d-0102-40ed-9688-ffc86793bdc9.wav (165932 bytes, 3.46s, 24000Hz)
2025-12-31 12:18:42,154 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36\2ed7a21d-0102-40ed-9688-ffc86793bdc9.wav
2025-12-31 12:18:42,281 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36\2ed7a21d-0102-40ed-9688-ffc86793bdc9.wav
2025-12-31 12:18:42,781 - app.pipeline.pipeline_runner - INFO - Session 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36 turn 2ed7a21d-0102-40ed-9688-ffc86793bdc9 completed successfully
2025-12-31 12:18:57,819 - app.api.session_manager - INFO - Session created: f82414a4-797a-400a-8fdd-508605b99172
2025-12-31 12:18:57,819 - app.api.routes - INFO - Session started: f82414a4-797a-400a-8fdd-508605b99172, Turn: 6cf67a70-af8e-40e4-b566-4fb230af08db, Status: SessionStatus.LISTENING
2025-12-31 12:18:57,849 - app.api.ws - INFO - WebSocket connected for session f82414a4-797a-400a-8fdd-508605b99172. Total connections for session: 1
2025-12-31 12:18:57,859 - app.api.ws - INFO - Audio streaming started for session f82414a4-797a-400a-8fdd-508605b99172: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:19:00,678 - app.api.ws - INFO - Audio streaming ended for session f82414a4-797a-400a-8fdd-508605b99172
2025-12-31 12:19:00,678 - app.api.ws - INFO - Total audio received: 43982 bytes
2025-12-31 12:19:00,679 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session f82414a4-797a-400a-8fdd-508605b99172: 43982 bytes
2025-12-31 12:19:00,681 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:19:00,912 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:19:00,913 - app.pipeline.pipeline_runner - INFO - Converted audio: 43200 samples at 16000Hz
2025-12-31 12:19:00,915 - app.pipeline.pipeline_runner - INFO - Processing audio for session f82414a4-797a-400a-8fdd-508605b99172, turn 6cf67a70-af8e-40e4-b566-4fb230af08db
2025-12-31 12:19:00,917 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:00,918 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:19:00,919 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:00,919 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:19:00,919 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 43200 samples
2025-12-31 12:19:00,923 - app.pipeline.processors.vad_processor - INFO - VAD complete: 43200 -> 24000 samples (1.50s)
2025-12-31 12:19:00,923 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:19:00,923 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 24000 samples, 1.50s
2025-12-31 12:19:00,924 - faster_whisper - INFO - Processing audio with duration 00:01.500
2025-12-31 12:19:02,303 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Holy Angel.' (1.38s, language=en, probability=1.00)
2025-12-31 12:19:02,303 - app.pipeline.voice_pipeline - INFO - Transcript: 'Holy Angel.'
2025-12-31 12:19:02,304 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:19:02,304 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Holy Angel.'
2025-12-31 12:19:02,305 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:19:02,305 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:19:02,305 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Holy Angel.'
2025-12-31 12:19:02,882 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Yes, Holy Angel! What brings you here?' (0.58s)
2025-12-31 12:19:02,882 - app.pipeline.voice_pipeline - INFO - LLM response: 'Yes, Holy Angel! What brings you here?'
2025-12-31 12:19:02,883 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:19:02,883 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Yes, Holy Angel! What brings you here?'
2025-12-31 12:19:02,884 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Yes, Holy Angel! What brings you here?'
2025-12-31 12:19:02,884 - app.pipeline.voice_pipeline - INFO - Final reply: 'Yes, Holy Angel! What brings you here?'
2025-12-31 12:19:02,885 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:02,885 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1967ms
2025-12-31 12:19:02,885 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:02,886 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Holy Angel.', reply='Yes, Holy Angel! What brings you here?', route=llm, time=1967ms
2025-12-31 12:19:02,888 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:19:02,890 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:19:02,890 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:19:04,493 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:19:04,493 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Yes, Holy Angel! What brings you here?' (speed=1.0)
2025-12-31 12:19:04,494 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:19:07,151 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\f82414a4-797a-400a-8fdd-508605b99172\6cf67a70-af8e-40e4-b566-4fb230af08db.wav (112684 bytes, 2.35s, 24000Hz)
2025-12-31 12:19:07,152 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\f82414a4-797a-400a-8fdd-508605b99172\6cf67a70-af8e-40e4-b566-4fb230af08db.wav
2025-12-31 12:19:07,273 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\f82414a4-797a-400a-8fdd-508605b99172\6cf67a70-af8e-40e4-b566-4fb230af08db.wav
2025-12-31 12:19:07,780 - app.pipeline.pipeline_runner - INFO - Session f82414a4-797a-400a-8fdd-508605b99172 turn 6cf67a70-af8e-40e4-b566-4fb230af08db completed successfully
2025-12-31 12:19:14,250 - app.api.session_manager - INFO - Session created: e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8
2025-12-31 12:19:14,251 - app.api.routes - INFO - Session started: e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8, Turn: 616e7ff6-291d-4528-aef3-6b60e7bd69c6, Status: SessionStatus.LISTENING
2025-12-31 12:19:14,264 - app.api.ws - INFO - WebSocket connected for session e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8. Total connections for session: 1
2025-12-31 12:19:14,273 - app.api.ws - INFO - Audio streaming started for session e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:19:17,209 - app.api.ws - INFO - Audio streaming ended for session e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8
2025-12-31 12:19:17,210 - app.api.ws - INFO - Total audio received: 45930 bytes
2025-12-31 12:19:17,210 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8: 45930 bytes
2025-12-31 12:19:17,212 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:19:17,459 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:19:17,461 - app.pipeline.pipeline_runner - INFO - Converted audio: 45120 samples at 16000Hz
2025-12-31 12:19:17,463 - app.pipeline.pipeline_runner - INFO - Processing audio for session e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8, turn 616e7ff6-291d-4528-aef3-6b60e7bd69c6
2025-12-31 12:19:17,464 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:17,465 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:19:17,465 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:17,466 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:19:17,468 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 45120 samples
2025-12-31 12:19:17,471 - app.pipeline.processors.vad_processor - INFO - VAD complete: 45120 -> 26400 samples (1.65s)
2025-12-31 12:19:17,472 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:19:17,473 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 26400 samples, 1.65s
2025-12-31 12:19:17,473 - faster_whisper - INFO - Processing audio with duration 00:01.650
2025-12-31 12:19:18,930 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Tell me in a joke.' (1.46s, language=en, probability=1.00)
2025-12-31 12:19:18,930 - app.pipeline.voice_pipeline - INFO - Transcript: 'Tell me in a joke.'
2025-12-31 12:19:18,930 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:19:18,931 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Tell me in a joke.'
2025-12-31 12:19:18,931 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:19:18,931 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:19:18,932 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Tell me in a joke.'
2025-12-31 12:19:19,703 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! I'll tell a funny story instead. What did the tomato say to the lettuce? "I said, 'Look, I'm red and green.' "' (0.77s)
2025-12-31 12:19:19,703 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! I'll tell a funny story instead. What did the tomato say to the lettuce? "I said, 'Look, I'm red and green.' "'
2025-12-31 12:19:19,704 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:19:19,704 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! I'll tell a funny story instead. What did the tomato say to the lettuce? "I said, 'Look, I'm red and green.' "'
2025-12-31 12:19:19,704 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-31 12:19:19,705 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! I'll tell a funny story instead.'
2025-12-31 12:19:19,705 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! I'll tell a funny story instead.'
2025-12-31 12:19:19,705 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:19,705 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2241ms
2025-12-31 12:19:19,706 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:19,706 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Tell me in a joke.', reply='Sure! I'll tell a funny story instead.', route=llm, time=2241ms
2025-12-31 12:19:19,707 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:19:19,708 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:19:19,709 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:19:21,706 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:19:21,707 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Sure! I'll tell a funny story instead.' (speed=1.0)
2025-12-31 12:19:21,708 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:19:23,742 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8\616e7ff6-291d-4528-aef3-6b60e7bd69c6.wav (105516 bytes, 2.20s, 24000Hz)
2025-12-31 12:19:23,743 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8\616e7ff6-291d-4528-aef3-6b60e7bd69c6.wav
2025-12-31 12:19:23,882 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8\616e7ff6-291d-4528-aef3-6b60e7bd69c6.wav
2025-12-31 12:19:24,378 - app.pipeline.pipeline_runner - INFO - Session e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8 turn 616e7ff6-291d-4528-aef3-6b60e7bd69c6 completed successfully
2025-12-31 12:19:28,927 - app.api.session_manager - INFO - Session created: 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea
2025-12-31 12:19:28,928 - app.api.routes - INFO - Session started: 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea, Turn: a7decc84-bb95-49f8-88d6-69693dc01ca4, Status: SessionStatus.LISTENING
2025-12-31 12:19:28,951 - app.api.ws - INFO - WebSocket connected for session 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea. Total connections for session: 1
2025-12-31 12:19:28,960 - app.api.ws - INFO - Audio streaming started for session 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:19:32,675 - app.api.ws - INFO - Audio streaming ended for session 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea
2025-12-31 12:19:32,676 - app.api.ws - INFO - Total audio received: 57618 bytes
2025-12-31 12:19:32,677 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea: 57618 bytes
2025-12-31 12:19:32,678 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:19:32,895 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:19:32,897 - app.pipeline.pipeline_runner - INFO - Converted audio: 56640 samples at 16000Hz
2025-12-31 12:19:32,899 - app.pipeline.pipeline_runner - INFO - Processing audio for session 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea, turn a7decc84-bb95-49f8-88d6-69693dc01ca4
2025-12-31 12:19:32,900 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:32,901 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:19:32,901 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:32,902 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:19:32,902 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 56640 samples
2025-12-31 12:19:32,905 - app.pipeline.processors.vad_processor - INFO - VAD complete: 56640 -> 41760 samples (2.61s)
2025-12-31 12:19:32,906 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:19:32,906 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 41760 samples, 2.61s
2025-12-31 12:19:32,906 - faster_whisper - INFO - Processing audio with duration 00:02.610
2025-12-31 12:19:34,397 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'I am asking you to turn it into a joke.' (1.49s, language=en, probability=1.00)
2025-12-31 12:19:34,398 - app.pipeline.voice_pipeline - INFO - Transcript: 'I am asking you to turn it into a joke.'
2025-12-31 12:19:34,398 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:19:34,398 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'I am asking you to turn it into a joke.'
2025-12-31 12:19:34,399 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:19:34,400 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:19:34,401 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'I am asking you to turn it into a joke.'
2025-12-31 12:19:35,017 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! I can make up a funny story instead. What do you like to tell me?' (0.62s)
2025-12-31 12:19:35,017 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! I can make up a funny story instead. What do you like to tell me?'
2025-12-31 12:19:35,018 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:19:35,018 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! I can make up a funny story instead. What do you like to tell me?'
2025-12-31 12:19:35,018 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-31 12:19:35,019 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! I can make up a funny story instead.'
2025-12-31 12:19:35,019 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! I can make up a funny story instead.'
2025-12-31 12:19:35,020 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:35,020 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2119ms
2025-12-31 12:19:35,020 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:35,021 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='I am asking you to turn it into a joke.', reply='Sure! I can make up a funny story instead.', route=llm, time=2119ms
2025-12-31 12:19:35,022 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:19:35,024 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:19:35,024 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:19:36,659 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:19:36,660 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Sure! I can make up a funny story instead.' (speed=1.0)
2025-12-31 12:19:36,661 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:19:39,441 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\2d32b7ef-87a5-4e9c-b20d-8a925d7771ea\a7decc84-bb95-49f8-88d6-69693dc01ca4.wav (124972 bytes, 2.60s, 24000Hz)
2025-12-31 12:19:39,443 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\2d32b7ef-87a5-4e9c-b20d-8a925d7771ea\a7decc84-bb95-49f8-88d6-69693dc01ca4.wav
2025-12-31 12:19:39,567 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\2d32b7ef-87a5-4e9c-b20d-8a925d7771ea\a7decc84-bb95-49f8-88d6-69693dc01ca4.wav
2025-12-31 12:19:40,069 - app.pipeline.pipeline_runner - INFO - Session 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea turn a7decc84-bb95-49f8-88d6-69693dc01ca4 completed successfully
2025-12-31 12:19:43,303 - app.api.session_manager - INFO - Session created: 419b99ff-fb79-4704-81a5-f0c499343f39
2025-12-31 12:19:43,304 - app.api.routes - INFO - Session started: 419b99ff-fb79-4704-81a5-f0c499343f39, Turn: 7aa6b572-f4c8-482f-99ed-55c46721c074, Status: SessionStatus.LISTENING
2025-12-31 12:19:43,315 - app.api.ws - INFO - WebSocket connected for session 419b99ff-fb79-4704-81a5-f0c499343f39. Total connections for session: 1
2025-12-31 12:19:43,323 - app.api.ws - INFO - Audio streaming started for session 419b99ff-fb79-4704-81a5-f0c499343f39: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:19:46,605 - app.api.ws - INFO - Audio streaming ended for session 419b99ff-fb79-4704-81a5-f0c499343f39
2025-12-31 12:19:46,606 - app.api.ws - INFO - Total audio received: 51774 bytes
2025-12-31 12:19:46,607 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 419b99ff-fb79-4704-81a5-f0c499343f39: 51774 bytes
2025-12-31 12:19:46,610 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:19:46,814 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:19:46,816 - app.pipeline.pipeline_runner - INFO - Converted audio: 50880 samples at 16000Hz
2025-12-31 12:19:46,818 - app.pipeline.pipeline_runner - INFO - Processing audio for session 419b99ff-fb79-4704-81a5-f0c499343f39, turn 7aa6b572-f4c8-482f-99ed-55c46721c074
2025-12-31 12:19:46,819 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:46,820 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:19:46,820 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:46,820 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:19:46,821 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 50880 samples
2025-12-31 12:19:46,824 - app.pipeline.processors.vad_processor - INFO - VAD complete: 50880 -> 36000 samples (2.25s)
2025-12-31 12:19:46,824 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:19:46,825 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 36000 samples, 2.25s
2025-12-31 12:19:46,825 - faster_whisper - INFO - Processing audio with duration 00:02.250
2025-12-31 12:19:55,263 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'I'm going to let the joke go to coffee.' (8.44s, language=en, probability=1.00)
2025-12-31 12:19:55,263 - app.pipeline.voice_pipeline - INFO - Transcript: 'I'm going to let the joke go to coffee.'
2025-12-31 12:19:55,264 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:19:55,264 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'I'm going to let the joke go to coffee.'
2025-12-31 12:19:55,265 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:19:55,265 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:19:55,267 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'I'm going to let the joke go to coffee.'
2025-12-31 12:19:55,941 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! Let's have a fun chat!' (0.67s)
2025-12-31 12:19:55,941 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! Let's have a fun chat!'
2025-12-31 12:19:55,942 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:19:55,942 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! Let's have a fun chat!'
2025-12-31 12:19:55,942 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! Let's have a fun chat!'
2025-12-31 12:19:55,943 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! Let's have a fun chat!'
2025-12-31 12:19:55,943 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:55,943 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 9123ms
2025-12-31 12:19:55,943 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:19:55,944 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='I'm going to let the joke go to coffee.', reply='Sure! Let's have a fun chat!', route=llm, time=9123ms
2025-12-31 12:19:55,945 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:19:55,947 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:19:55,947 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:19:57,908 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:19:57,908 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Sure! Let's have a fun chat!' (speed=1.0)
2025-12-31 12:19:57,910 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:20:00,069 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\419b99ff-fb79-4704-81a5-f0c499343f39\7aa6b572-f4c8-482f-99ed-55c46721c074.wav (79916 bytes, 1.66s, 24000Hz)
2025-12-31 12:20:00,071 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\419b99ff-fb79-4704-81a5-f0c499343f39\7aa6b572-f4c8-482f-99ed-55c46721c074.wav
2025-12-31 12:20:00,206 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\419b99ff-fb79-4704-81a5-f0c499343f39\7aa6b572-f4c8-482f-99ed-55c46721c074.wav
2025-12-31 12:20:00,709 - app.pipeline.pipeline_runner - INFO - Session 419b99ff-fb79-4704-81a5-f0c499343f39 turn 7aa6b572-f4c8-482f-99ed-55c46721c074 completed successfully
2025-12-31 12:20:33,839 - app.api.session_manager - INFO - Cleaning up expired session: 428315c6-163d-45d2-ae70-427213261db7
2025-12-31 12:20:33,840 - app.api.session_manager - INFO - Session deleted: 428315c6-163d-45d2-ae70-427213261db7
2025-12-31 12:20:39,698 - app.api.session_manager - INFO - Session created: c4dd72b2-b382-49ae-8c67-766a4d5ab3a0
2025-12-31 12:20:39,699 - app.api.routes - INFO - Session started: c4dd72b2-b382-49ae-8c67-766a4d5ab3a0, Turn: edfeacc6-277d-4b26-b3d6-2bf2fefec60e, Status: SessionStatus.LISTENING
2025-12-31 12:20:39,728 - app.api.ws - INFO - WebSocket connected for session c4dd72b2-b382-49ae-8c67-766a4d5ab3a0. Total connections for session: 1
2025-12-31 12:20:39,735 - app.api.ws - INFO - Audio streaming started for session c4dd72b2-b382-49ae-8c67-766a4d5ab3a0: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:20:43,346 - app.api.ws - INFO - Audio streaming ended for session c4dd72b2-b382-49ae-8c67-766a4d5ab3a0
2025-12-31 12:20:43,347 - app.api.ws - INFO - Total audio received: 57618 bytes
2025-12-31 12:20:43,347 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session c4dd72b2-b382-49ae-8c67-766a4d5ab3a0: 57618 bytes
2025-12-31 12:20:43,350 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:20:43,573 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:20:43,576 - app.pipeline.pipeline_runner - INFO - Converted audio: 56640 samples at 16000Hz
2025-12-31 12:20:43,578 - app.pipeline.pipeline_runner - INFO - Processing audio for session c4dd72b2-b382-49ae-8c67-766a4d5ab3a0, turn edfeacc6-277d-4b26-b3d6-2bf2fefec60e
2025-12-31 12:20:43,579 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:20:43,579 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:20:43,580 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:20:43,580 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:20:43,580 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 56640 samples
2025-12-31 12:20:43,583 - app.pipeline.processors.vad_processor - INFO - VAD complete: 56640 -> 43200 samples (2.70s)
2025-12-31 12:20:43,584 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:20:43,584 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 43200 samples, 2.70s
2025-12-31 12:20:43,585 - faster_whisper - INFO - Processing audio with duration 00:02.700
2025-12-31 12:20:44,998 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'and you please tell me a joke.' (1.41s, language=en, probability=1.00)
2025-12-31 12:20:44,998 - app.pipeline.voice_pipeline - INFO - Transcript: 'and you please tell me a joke.'
2025-12-31 12:20:44,999 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:20:44,999 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'and you please tell me a joke.'
2025-12-31 12:20:45,000 - app.pipeline.processors.skills_router - INFO - Math query detected
2025-12-31 12:20:45,007 - app.pipeline.processors.skills_router - WARNING - Math query detected but could not parse expression
2025-12-31 12:20:45,008 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:20:45,008 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:20:45,009 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'and you please tell me a joke.'
2025-12-31 12:20:45,726 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! Here's a light-hearted joke: Why don't scientists trust atoms? Because they make up everything!' (0.72s)
2025-12-31 12:20:45,727 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! Here's a light-hearted joke: Why don't scientists trust atoms? Because they make up everything!'
2025-12-31 12:20:45,727 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:20:45,727 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! Here's a light-hearted joke: Why don't scientists trust atoms? Because they make up everything!'
2025-12-31 12:20:45,728 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-31 12:20:45,728 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! Here's a light-hearted joke: Why don't scientists trust atoms?'
2025-12-31 12:20:45,728 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! Here's a light-hearted joke: Why don't scientists trust atoms?'
2025-12-31 12:20:45,729 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:20:45,729 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2149ms
2025-12-31 12:20:45,729 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:20:45,730 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='and you please tell me a joke.', reply='Sure! Here's a light-hearted joke: Why don't scientists trust atoms?', route=llm, time=2149ms
2025-12-31 12:20:45,732 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:20:45,734 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:20:45,734 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:20:47,746 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:20:47,746 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Sure! Here's a light-hearted joke: Why don't scientists trust atoms?' (speed=1.0)
2025-12-31 12:20:47,748 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:20:51,844 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\c4dd72b2-b382-49ae-8c67-766a4d5ab3a0\edfeacc6-277d-4b26-b3d6-2bf2fefec60e.wav (195628 bytes, 4.07s, 24000Hz)
2025-12-31 12:20:51,845 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\c4dd72b2-b382-49ae-8c67-766a4d5ab3a0\edfeacc6-277d-4b26-b3d6-2bf2fefec60e.wav
2025-12-31 12:20:51,985 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\c4dd72b2-b382-49ae-8c67-766a4d5ab3a0\edfeacc6-277d-4b26-b3d6-2bf2fefec60e.wav
2025-12-31 12:20:52,491 - app.pipeline.pipeline_runner - INFO - Session c4dd72b2-b382-49ae-8c67-766a4d5ab3a0 turn edfeacc6-277d-4b26-b3d6-2bf2fefec60e completed successfully
2025-12-31 12:21:00,195 - app.api.session_manager - INFO - Session created: 045e0b2f-b530-48d5-960e-f32e2cb44832
2025-12-31 12:21:00,196 - app.api.routes - INFO - Session started: 045e0b2f-b530-48d5-960e-f32e2cb44832, Turn: ccff2dad-180f-4c3e-b98d-2933c83bb01d, Status: SessionStatus.LISTENING
2025-12-31 12:21:00,230 - app.api.ws - INFO - WebSocket connected for session 045e0b2f-b530-48d5-960e-f32e2cb44832. Total connections for session: 1
2025-12-31 12:21:00,241 - app.api.ws - INFO - Audio streaming started for session 045e0b2f-b530-48d5-960e-f32e2cb44832: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:21:02,194 - app.api.ws - INFO - Audio streaming ended for session 045e0b2f-b530-48d5-960e-f32e2cb44832
2025-12-31 12:21:02,195 - app.api.ws - INFO - Total audio received: 30346 bytes
2025-12-31 12:21:02,196 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 045e0b2f-b530-48d5-960e-f32e2cb44832: 30346 bytes
2025-12-31 12:21:02,199 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:21:02,488 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:21:02,490 - app.pipeline.pipeline_runner - INFO - Converted audio: 29760 samples at 16000Hz
2025-12-31 12:21:02,492 - app.pipeline.pipeline_runner - INFO - Processing audio for session 045e0b2f-b530-48d5-960e-f32e2cb44832, turn ccff2dad-180f-4c3e-b98d-2933c83bb01d
2025-12-31 12:21:02,493 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:21:02,493 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:21:02,493 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:21:02,494 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:21:02,494 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 29760 samples
2025-12-31 12:21:02,496 - app.pipeline.processors.vad_processor - INFO - VAD complete: 29760 -> 13440 samples (0.84s)
2025-12-31 12:21:02,496 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:21:02,496 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 13440 samples, 0.84s
2025-12-31 12:21:02,497 - faster_whisper - INFO - Processing audio with duration 00:00.840
2025-12-31 12:21:03,903 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Bye.' (1.41s, language=en, probability=1.00)
2025-12-31 12:21:03,903 - app.pipeline.voice_pipeline - INFO - Transcript: 'Bye.'
2025-12-31 12:21:03,903 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:21:03,904 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Bye.'
2025-12-31 12:21:03,904 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:21:03,905 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:21:03,905 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Bye.'
2025-12-31 12:21:04,439 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Goodbye! Can I help with anything else?' (0.53s)
2025-12-31 12:21:04,440 - app.pipeline.voice_pipeline - INFO - LLM response: 'Goodbye! Can I help with anything else?'
2025-12-31 12:21:04,440 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:21:04,441 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Goodbye! Can I help with anything else?'
2025-12-31 12:21:04,441 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Goodbye! Can I help with anything else?'
2025-12-31 12:21:04,441 - app.pipeline.voice_pipeline - INFO - Final reply: 'Goodbye! Can I help with anything else?'
2025-12-31 12:21:04,441 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:21:04,442 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1948ms
2025-12-31 12:21:04,442 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:21:04,443 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Bye.', reply='Goodbye! Can I help with anything else?', route=llm, time=1948ms
2025-12-31 12:21:04,444 - app.pipeline.processors.tts_kokoro - INFO - Initializing Kokoro TTS processor with voice: af_bella
2025-12-31 12:21:04,446 - app.pipeline.processors.tts_kokoro - INFO - Loading Kokoro model from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\kokoro-v1.0.onnx
2025-12-31 12:21:04,446 - app.pipeline.processors.tts_kokoro - INFO - Loading voices from: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\models\kokoro\voices-v1.0.bin
2025-12-31 12:21:06,292 - app.pipeline.processors.tts_kokoro - INFO - Kokoro TTS processor initialized successfully
2025-12-31 12:21:06,293 - app.pipeline.processors.tts_kokoro - INFO - Synthesizing text: 'Goodbye! Can I help with anything else?' (speed=1.0)
2025-12-31 12:21:06,295 - app.pipeline.processors.tts_kokoro - INFO - Running TTS synthesis...
2025-12-31 12:21:08,911 - app.pipeline.processors.tts_kokoro - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\045e0b2f-b530-48d5-960e-f32e2cb44832\ccff2dad-180f-4c3e-b98d-2933c83bb01d.wav (104492 bytes, 2.18s, 24000Hz)
2025-12-31 12:21:08,912 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\045e0b2f-b530-48d5-960e-f32e2cb44832\ccff2dad-180f-4c3e-b98d-2933c83bb01d.wav
2025-12-31 12:21:09,041 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\045e0b2f-b530-48d5-960e-f32e2cb44832\ccff2dad-180f-4c3e-b98d-2933c83bb01d.wav
2025-12-31 12:21:09,539 - app.pipeline.pipeline_runner - INFO - Session 045e0b2f-b530-48d5-960e-f32e2cb44832 turn ccff2dad-180f-4c3e-b98d-2933c83bb01d completed successfully
2025-12-31 12:21:33,852 - app.api.session_manager - INFO - Cleaning up expired session: 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e
2025-12-31 12:21:33,853 - app.api.session_manager - INFO - Session deleted: 7a2a4fe0-4392-4aac-aee0-4dc68ce95f4e
2025-12-31 12:21:33,853 - app.api.session_manager - INFO - Cleaning up expired session: beec59b3-2075-4073-897a-5ff0023efaeb
2025-12-31 12:21:33,853 - app.api.session_manager - INFO - Session deleted: beec59b3-2075-4073-897a-5ff0023efaeb
2025-12-31 12:23:33,859 - app.api.session_manager - INFO - Cleaning up expired session: cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2
2025-12-31 12:23:33,859 - app.api.session_manager - INFO - Session deleted: cb7cb1e8-32cc-4f1c-9cde-3c806d23d7e2
2025-12-31 12:24:33,861 - app.api.session_manager - INFO - Cleaning up expired session: 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36
2025-12-31 12:24:33,861 - app.api.session_manager - INFO - Session deleted: 4bd0a4a3-1cde-4b0a-b7f3-90e328cbba36
2025-12-31 12:24:33,862 - app.api.session_manager - INFO - Cleaning up expired session: f82414a4-797a-400a-8fdd-508605b99172
2025-12-31 12:24:33,862 - app.api.session_manager - INFO - Session deleted: f82414a4-797a-400a-8fdd-508605b99172
2025-12-31 12:24:33,862 - app.api.session_manager - INFO - Cleaning up expired session: e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8
2025-12-31 12:24:33,862 - app.api.session_manager - INFO - Session deleted: e5fd7f49-dd4a-4a4e-836c-9b3e75814ee8
2025-12-31 12:25:33,872 - app.api.session_manager - INFO - Cleaning up expired session: 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea
2025-12-31 12:25:33,872 - app.api.session_manager - INFO - Session deleted: 2d32b7ef-87a5-4e9c-b20d-8a925d7771ea
2025-12-31 12:25:33,872 - app.api.session_manager - INFO - Cleaning up expired session: 419b99ff-fb79-4704-81a5-f0c499343f39
2025-12-31 12:25:33,873 - app.api.session_manager - INFO - Session deleted: 419b99ff-fb79-4704-81a5-f0c499343f39
2025-12-31 12:26:33,880 - app.api.session_manager - INFO - Cleaning up expired session: c4dd72b2-b382-49ae-8c67-766a4d5ab3a0
2025-12-31 12:26:33,880 - app.api.session_manager - INFO - Session deleted: c4dd72b2-b382-49ae-8c67-766a4d5ab3a0
2025-12-31 12:26:33,881 - app.api.session_manager - INFO - Cleaning up expired session: 045e0b2f-b530-48d5-960e-f32e2cb44832
2025-12-31 12:26:33,881 - app.api.session_manager - INFO - Session deleted: 045e0b2f-b530-48d5-960e-f32e2cb44832
2025-12-31 12:54:36,307 - app.main - INFO - ============================================================
2025-12-31 12:54:36,307 - app.main - INFO - Voice Agent Service starting...
2025-12-31 12:54:36,307 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 12:54:36,307 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 12:54:36,307 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 12:54:36,307 - app.main - INFO - STT Model: base.en
2025-12-31 12:54:36,308 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 12:54:36,308 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 12:54:36,308 - app.main - INFO - ============================================================
2025-12-31 12:54:36,308 - app.api.session_manager - INFO - Session Manager started
2025-12-31 12:56:07,536 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 12:56:08,957 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 12:56:21,504 - app.api.session_manager - INFO - Session created: 90f4b0a9-a066-4c54-8cec-bc6da2e0860c
2025-12-31 12:56:21,505 - app.api.routes - INFO - Session started: 90f4b0a9-a066-4c54-8cec-bc6da2e0860c, Turn: 7dd27df6-36ad-4b1e-90e2-44f3c0d30e7c, Status: SessionStatus.LISTENING
2025-12-31 12:56:21,520 - app.api.ws - INFO - WebSocket connected for session 90f4b0a9-a066-4c54-8cec-bc6da2e0860c. Total connections for session: 1
2025-12-31 12:56:21,541 - app.api.ws - INFO - Audio streaming started for session 90f4b0a9-a066-4c54-8cec-bc6da2e0860c: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:56:23,931 - app.api.ws - INFO - Audio streaming ended for session 90f4b0a9-a066-4c54-8cec-bc6da2e0860c
2025-12-31 12:56:23,931 - app.api.ws - INFO - Total audio received: 36190 bytes
2025-12-31 12:56:23,932 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 90f4b0a9-a066-4c54-8cec-bc6da2e0860c: 36190 bytes
2025-12-31 12:56:23,935 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:56:25,183 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:56:25,187 - app.pipeline.pipeline_runner - INFO - Converted audio: 35520 samples at 16000Hz
2025-12-31 12:56:25,189 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 12:56:25,189 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 12:56:25,189 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 12:56:26,706 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 12:56:27,851 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 12:56:27,851 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 12:56:27,852 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 12:56:27,866 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 12:56:27,866 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 12:56:27,867 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 12:56:27,867 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 12:56:27,867 - app.pipeline.pipeline_runner - INFO - Processing audio for session 90f4b0a9-a066-4c54-8cec-bc6da2e0860c, turn 7dd27df6-36ad-4b1e-90e2-44f3c0d30e7c
2025-12-31 12:56:27,868 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:56:27,868 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:56:27,868 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:56:27,869 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:56:27,869 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 35520 samples
2025-12-31 12:56:27,870 - app.pipeline.processors.vad_processor - INFO - VAD complete: 35520 -> 11520 samples (0.72s)
2025-12-31 12:56:27,870 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:56:27,870 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 12:56:27,870 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 12:56:29,331 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 12:56:29,331 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 12:56:29,332 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 12:56:42,562 - app.api.session_manager - INFO - Session created: e85beab9-6dd5-48a8-984f-adc936f0f301
2025-12-31 12:56:42,562 - app.api.routes - INFO - Session started: e85beab9-6dd5-48a8-984f-adc936f0f301, Turn: c3608dd8-745b-46f1-ae85-e1eece094051, Status: SessionStatus.LISTENING
2025-12-31 12:56:42,589 - app.api.ws - INFO - WebSocket connected for session e85beab9-6dd5-48a8-984f-adc936f0f301. Total connections for session: 1
2025-12-31 12:56:42,596 - app.api.ws - INFO - Audio streaming started for session e85beab9-6dd5-48a8-984f-adc936f0f301: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:56:44,696 - app.api.ws - INFO - Audio streaming ended for session e85beab9-6dd5-48a8-984f-adc936f0f301
2025-12-31 12:56:44,696 - app.api.ws - INFO - Total audio received: 32294 bytes
2025-12-31 12:56:44,697 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session e85beab9-6dd5-48a8-984f-adc936f0f301: 32294 bytes
2025-12-31 12:56:44,699 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:56:44,921 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:56:44,923 - app.pipeline.pipeline_runner - INFO - Converted audio: 31680 samples at 16000Hz
2025-12-31 12:56:44,924 - app.pipeline.pipeline_runner - INFO - Processing audio for session e85beab9-6dd5-48a8-984f-adc936f0f301, turn c3608dd8-745b-46f1-ae85-e1eece094051
2025-12-31 12:56:44,925 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:56:44,925 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:56:44,925 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:56:44,925 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:56:44,925 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 31680 samples
2025-12-31 12:56:44,927 - app.pipeline.processors.vad_processor - INFO - VAD complete: 31680 -> 15360 samples (0.96s)
2025-12-31 12:56:44,927 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:56:44,927 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 15360 samples, 0.96s
2025-12-31 12:56:44,928 - faster_whisper - INFO - Processing audio with duration 00:00.960
2025-12-31 12:56:46,222 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Oh yeah.' (1.29s, language=en, probability=1.00)
2025-12-31 12:56:46,222 - app.pipeline.voice_pipeline - INFO - Transcript: 'Oh yeah.'
2025-12-31 12:56:46,222 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:56:46,223 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Oh yeah.'
2025-12-31 12:56:46,223 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:56:46,223 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:56:46,223 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Oh yeah.'
2025-12-31 12:56:54,566 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! What do you want to talk about?' (8.34s)
2025-12-31 12:56:54,566 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! What do you want to talk about?'
2025-12-31 12:56:54,567 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:56:54,567 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! What do you want to talk about?'
2025-12-31 12:56:54,567 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! What do you want to talk about?'
2025-12-31 12:56:54,567 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! What do you want to talk about?'
2025-12-31 12:56:54,567 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:56:54,568 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 9642ms
2025-12-31 12:56:54,568 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:56:54,569 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Oh yeah.', reply='Sure! What do you want to talk about?', route=llm, time=9642ms
2025-12-31 12:56:54,580 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 12:56:56,183 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 12:56:56,184 - app.pipeline.processors.tts_elevenlabs - ERROR - Error in synchronous wrapper: There is no current event loop in thread 'asyncio_0'.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 152, in synthesize
    loop = asyncio.get_event_loop()
  File "C:\Python313\Lib\asyncio\events.py", line 716, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
                       % threading.current_thread().name)
RuntimeError: There is no current event loop in thread 'asyncio_0'.
2025-12-31 12:56:56,188 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 12:56:56,698 - app.pipeline.pipeline_runner - INFO - Session e85beab9-6dd5-48a8-984f-adc936f0f301 turn c3608dd8-745b-46f1-ae85-e1eece094051 completed successfully
2025-12-31 12:57:12,879 - app.api.session_manager - INFO - Session created: cd376233-275e-470f-bc3e-de57a2c0010c
2025-12-31 12:57:12,880 - app.api.routes - INFO - Session started: cd376233-275e-470f-bc3e-de57a2c0010c, Turn: d86b4322-ff81-4555-be66-53a22512991b, Status: SessionStatus.LISTENING
2025-12-31 12:57:12,920 - app.api.ws - INFO - WebSocket connected for session cd376233-275e-470f-bc3e-de57a2c0010c. Total connections for session: 1
2025-12-31 12:57:12,938 - app.api.ws - INFO - Audio streaming started for session cd376233-275e-470f-bc3e-de57a2c0010c: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:57:15,036 - app.api.ws - INFO - Audio streaming ended for session cd376233-275e-470f-bc3e-de57a2c0010c
2025-12-31 12:57:15,036 - app.api.ws - INFO - Total audio received: 32294 bytes
2025-12-31 12:57:15,037 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session cd376233-275e-470f-bc3e-de57a2c0010c: 32294 bytes
2025-12-31 12:57:15,039 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:57:16,762 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:57:16,764 - app.pipeline.pipeline_runner - INFO - Converted audio: 31680 samples at 16000Hz
2025-12-31 12:57:16,766 - app.pipeline.pipeline_runner - INFO - Processing audio for session cd376233-275e-470f-bc3e-de57a2c0010c, turn d86b4322-ff81-4555-be66-53a22512991b
2025-12-31 12:57:16,766 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:16,767 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:57:16,767 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:16,767 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:57:16,767 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 31680 samples
2025-12-31 12:57:16,769 - app.pipeline.processors.vad_processor - INFO - VAD complete: 31680 -> 17760 samples (1.11s)
2025-12-31 12:57:16,769 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:57:16,769 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 17760 samples, 1.11s
2025-12-31 12:57:16,770 - faster_whisper - INFO - Processing audio with duration 00:01.110
2025-12-31 12:57:18,313 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Oh' (1.54s, language=en, probability=1.00)
2025-12-31 12:57:18,313 - app.pipeline.voice_pipeline - INFO - Transcript: 'Oh'
2025-12-31 12:57:18,313 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:57:18,314 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Oh'
2025-12-31 12:57:18,314 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:57:18,314 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:57:18,314 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Oh'
2025-12-31 12:57:19,004 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! How may I assist you today?' (0.69s)
2025-12-31 12:57:19,004 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! How may I assist you today?'
2025-12-31 12:57:19,004 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:57:19,004 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! How may I assist you today?'
2025-12-31 12:57:19,005 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! How may I assist you today?'
2025-12-31 12:57:19,005 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! How may I assist you today?'
2025-12-31 12:57:19,005 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:19,005 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2238ms
2025-12-31 12:57:19,005 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:19,006 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Oh', reply='Sure! How may I assist you today?', route=llm, time=2238ms
2025-12-31 12:57:19,007 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 12:57:19,952 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 12:57:19,953 - app.pipeline.processors.tts_elevenlabs - ERROR - Error in synchronous wrapper: There is no current event loop in thread 'asyncio_0'.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 152, in synthesize
    loop = asyncio.get_event_loop()
  File "C:\Python313\Lib\asyncio\events.py", line 716, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
                       % threading.current_thread().name)
RuntimeError: There is no current event loop in thread 'asyncio_0'.
2025-12-31 12:57:19,955 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 12:57:20,459 - app.pipeline.pipeline_runner - INFO - Session cd376233-275e-470f-bc3e-de57a2c0010c turn d86b4322-ff81-4555-be66-53a22512991b completed successfully
2025-12-31 12:57:29,369 - app.api.session_manager - INFO - Session created: 4372a9e5-b715-4d25-9593-235ccc4b8173
2025-12-31 12:57:29,370 - app.api.routes - INFO - Session started: 4372a9e5-b715-4d25-9593-235ccc4b8173, Turn: 187b9fd8-51a3-4af2-a676-9a9c325259dc, Status: SessionStatus.LISTENING
2025-12-31 12:57:29,407 - app.api.ws - INFO - WebSocket connected for session 4372a9e5-b715-4d25-9593-235ccc4b8173. Total connections for session: 1
2025-12-31 12:57:29,415 - app.api.ws - INFO - Audio streaming started for session 4372a9e5-b715-4d25-9593-235ccc4b8173: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 12:57:32,674 - app.api.ws - INFO - Audio streaming ended for session 4372a9e5-b715-4d25-9593-235ccc4b8173
2025-12-31 12:57:32,674 - app.api.ws - INFO - Total audio received: 51774 bytes
2025-12-31 12:57:32,675 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 4372a9e5-b715-4d25-9593-235ccc4b8173: 51774 bytes
2025-12-31 12:57:32,679 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 12:57:32,914 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 12:57:32,915 - app.pipeline.pipeline_runner - INFO - Converted audio: 50880 samples at 16000Hz
2025-12-31 12:57:32,917 - app.pipeline.pipeline_runner - INFO - Processing audio for session 4372a9e5-b715-4d25-9593-235ccc4b8173, turn 187b9fd8-51a3-4af2-a676-9a9c325259dc
2025-12-31 12:57:32,918 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:32,919 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 12:57:32,919 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:32,919 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 12:57:32,919 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 50880 samples
2025-12-31 12:57:32,921 - app.pipeline.processors.vad_processor - INFO - VAD complete: 50880 -> 26880 samples (1.68s)
2025-12-31 12:57:32,921 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 12:57:32,922 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 26880 samples, 1.68s
2025-12-31 12:57:32,922 - faster_whisper - INFO - Processing audio with duration 00:01.680
2025-12-31 12:57:34,398 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'And you feel me?' (1.48s, language=en, probability=1.00)
2025-12-31 12:57:34,398 - app.pipeline.voice_pipeline - INFO - Transcript: 'And you feel me?'
2025-12-31 12:57:34,398 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 12:57:34,399 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'And you feel me?'
2025-12-31 12:57:34,399 - app.pipeline.processors.skills_router - INFO - Math query detected
2025-12-31 12:57:34,400 - app.pipeline.processors.skills_router - WARNING - Math query detected but could not parse expression
2025-12-31 12:57:34,400 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 12:57:34,401 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 12:57:34,401 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'And you feel me?'
2025-12-31 12:57:35,126 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I sense what it feels like to be you because I am also someone who understands human emotions.' (0.72s)
2025-12-31 12:57:35,126 - app.pipeline.voice_pipeline - INFO - LLM response: 'I sense what it feels like to be you because I am also someone who understands human emotions.'
2025-12-31 12:57:35,126 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 12:57:35,126 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I sense what it feels like to be you because I am also someone who understands human emotions.'
2025-12-31 12:57:35,127 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I sense what it feels like to be you because I am also someone who understands human emotions.'
2025-12-31 12:57:35,127 - app.pipeline.voice_pipeline - INFO - Final reply: 'I sense what it feels like to be you because I am also someone who understands human emotions.'
2025-12-31 12:57:35,127 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:35,127 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2208ms
2025-12-31 12:57:35,127 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 12:57:35,128 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='And you feel me?', reply='I sense what it feels like to be you because I am also someone who understands human emotions.', route=llm, time=2208ms
2025-12-31 12:57:35,130 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 12:57:36,041 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 12:57:36,042 - app.pipeline.processors.tts_elevenlabs - ERROR - Error in synchronous wrapper: There is no current event loop in thread 'asyncio_0'.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 152, in synthesize
    loop = asyncio.get_event_loop()
  File "C:\Python313\Lib\asyncio\events.py", line 716, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
                       % threading.current_thread().name)
RuntimeError: There is no current event loop in thread 'asyncio_0'.
2025-12-31 12:57:36,044 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 12:57:36,547 - app.pipeline.pipeline_runner - INFO - Session 4372a9e5-b715-4d25-9593-235ccc4b8173 turn 187b9fd8-51a3-4af2-a676-9a9c325259dc completed successfully
2025-12-31 13:00:11,323 - app.main - INFO - ============================================================
2025-12-31 13:00:11,324 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:00:11,324 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:00:11,324 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:00:11,324 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:00:11,324 - app.main - INFO - STT Model: base.en
2025-12-31 13:00:11,324 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:00:11,324 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:00:11,324 - app.main - INFO - ============================================================
2025-12-31 13:00:11,324 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:05:45,636 - app.api.session_manager - INFO - Session created: 7734a194-a89a-45b9-b482-f47d22a25303
2025-12-31 13:05:45,636 - app.api.routes - INFO - Session started: 7734a194-a89a-45b9-b482-f47d22a25303, Turn: 0d446454-d95c-41c7-943e-9f1293f14f5e, Status: SessionStatus.LISTENING
2025-12-31 13:05:45,657 - app.api.ws - INFO - WebSocket connected for session 7734a194-a89a-45b9-b482-f47d22a25303. Total connections for session: 1
2025-12-31 13:05:45,662 - app.api.ws - INFO - Audio streaming started for session 7734a194-a89a-45b9-b482-f47d22a25303: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:05:47,528 - app.api.ws - INFO - Audio streaming ended for session 7734a194-a89a-45b9-b482-f47d22a25303
2025-12-31 13:05:47,529 - app.api.ws - INFO - Total audio received: 28398 bytes
2025-12-31 13:05:47,530 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 7734a194-a89a-45b9-b482-f47d22a25303: 28398 bytes
2025-12-31 13:05:47,533 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:05:47,721 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:05:47,724 - app.pipeline.pipeline_runner - INFO - Converted audio: 27840 samples at 16000Hz
2025-12-31 13:05:47,725 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 13:05:47,725 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 13:05:47,725 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 13:05:49,231 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 13:05:50,012 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 13:05:50,012 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 13:05:50,012 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 13:05:50,033 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 13:05:50,033 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 13:05:50,033 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 13:05:50,033 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 13:05:50,033 - app.pipeline.pipeline_runner - INFO - Processing audio for session 7734a194-a89a-45b9-b482-f47d22a25303, turn 0d446454-d95c-41c7-943e-9f1293f14f5e
2025-12-31 13:05:50,034 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:05:50,034 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:05:50,034 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:05:50,034 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:05:50,035 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 27840 samples
2025-12-31 13:05:50,035 - app.pipeline.processors.vad_processor - INFO - VAD complete: 27840 -> 22560 samples (1.41s)
2025-12-31 13:05:50,035 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:05:50,035 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 22560 samples, 1.41s
2025-12-31 13:05:50,036 - faster_whisper - INFO - Processing audio with duration 00:01.410
2025-12-31 13:05:51,209 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello, I'm good.' (1.17s, language=en, probability=1.00)
2025-12-31 13:05:51,209 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello, I'm good.'
2025-12-31 13:05:51,209 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:05:51,209 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello, I'm good.'
2025-12-31 13:05:51,210 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:05:51,210 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:05:51,210 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello, I'm good.'
2025-12-31 13:05:55,955 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm here to chat with you, sweetie!' (4.74s)
2025-12-31 13:05:55,955 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm here to chat with you, sweetie!'
2025-12-31 13:05:55,956 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:05:55,956 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm here to chat with you, sweetie!'
2025-12-31 13:05:55,956 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm here to chat with you, sweetie!'
2025-12-31 13:05:55,956 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm here to chat with you, sweetie!'
2025-12-31 13:05:55,956 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:05:55,956 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 5922ms
2025-12-31 13:05:55,957 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:05:55,957 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello, I'm good.', reply='I'm here to chat with you, sweetie!', route=llm, time=5922ms
2025-12-31 13:05:55,969 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:05:57,187 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:05:57,189 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'I'm here to chat with you, sweetie!'
2025-12-31 13:05:57,190 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:05:57,190 - app.pipeline.processors.tts_elevenlabs - ERROR - Error during TTS synthesis: 'ElevenLabs' object has no attribute 'generate'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 89, in synthesize_async
    audio_iterator = self.client.generate(
                     ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ElevenLabs' object has no attribute 'generate'
2025-12-31 13:05:57,194 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 13:05:57,704 - app.pipeline.pipeline_runner - INFO - Session 7734a194-a89a-45b9-b482-f47d22a25303 turn 0d446454-d95c-41c7-943e-9f1293f14f5e completed successfully
2025-12-31 13:06:42,457 - app.api.ws - ERROR - WebSocket error for session 7734a194-a89a-45b9-b482-f47d22a25303: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:06:42,500 - app.api.ws - INFO - WebSocket disconnected for session 7734a194-a89a-45b9-b482-f47d22a25303
2025-12-31 13:06:44,306 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:06:45,581 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:06:51,885 - app.api.session_manager - INFO - Session created: b8bb9dc8-9c20-431f-92cb-2eea7bb02eff
2025-12-31 13:06:51,885 - app.api.routes - INFO - Session started: b8bb9dc8-9c20-431f-92cb-2eea7bb02eff, Turn: 69bbdf83-8a8f-4652-91a3-28d07596d4d2, Status: SessionStatus.LISTENING
2025-12-31 13:06:51,899 - app.api.ws - INFO - WebSocket connected for session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff. Total connections for session: 1
2025-12-31 13:06:51,921 - app.api.ws - INFO - Audio streaming started for session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:06:53,930 - app.api.ws - INFO - Audio streaming ended for session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff
2025-12-31 13:06:53,931 - app.api.ws - INFO - Total audio received: 30346 bytes
2025-12-31 13:06:53,931 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff: 30346 bytes
2025-12-31 13:06:53,933 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:06:54,177 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:06:54,179 - app.pipeline.pipeline_runner - INFO - Converted audio: 29760 samples at 16000Hz
2025-12-31 13:06:54,181 - app.pipeline.pipeline_runner - INFO - Processing audio for session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff, turn 69bbdf83-8a8f-4652-91a3-28d07596d4d2
2025-12-31 13:06:54,181 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:06:54,182 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:06:54,182 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:06:54,182 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:06:54,182 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 29760 samples
2025-12-31 13:06:54,184 - app.pipeline.processors.vad_processor - INFO - VAD complete: 29760 -> 34560 samples (2.16s)
2025-12-31 13:06:54,184 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:06:54,185 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 34560 samples, 2.16s
2025-12-31 13:06:54,185 - faster_whisper - INFO - Processing audio with duration 00:02.160
2025-12-31 13:06:55,764 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello, and good night.' (1.58s, language=en, probability=1.00)
2025-12-31 13:06:55,764 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello, and good night.'
2025-12-31 13:06:55,764 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:06:55,764 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello, and good night.'
2025-12-31 13:06:55,764 - app.pipeline.processors.skills_router - INFO - Math query detected
2025-12-31 13:06:55,765 - app.pipeline.processors.skills_router - WARNING - Math query detected but could not parse expression
2025-12-31 13:06:55,765 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:06:55,766 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:06:55,766 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello, and good night.'
2025-12-31 13:06:56,534 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! Goodnight! I'm a friendly game character here. What would you like to talk about?' (0.77s)
2025-12-31 13:06:56,535 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! Goodnight! I'm a friendly game character here. What would you like to talk about?'
2025-12-31 13:06:56,535 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:06:56,535 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! Goodnight! I'm a friendly game character here. What would you like to talk about?'
2025-12-31 13:06:56,535 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-31 13:06:56,536 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! Goodnight!'
2025-12-31 13:06:56,536 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! Goodnight!'
2025-12-31 13:06:56,536 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:06:56,536 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2354ms
2025-12-31 13:06:56,536 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:06:56,537 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello, and good night.', reply='Hello! Goodnight!', route=llm, time=2354ms
2025-12-31 13:06:56,538 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:06:57,397 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:06:57,399 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Hello! Goodnight!'
2025-12-31 13:06:57,400 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:06:57,400 - app.pipeline.processors.tts_elevenlabs - ERROR - Error during TTS synthesis: 'ElevenLabs' object has no attribute 'generate'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 89, in synthesize_async
    audio_iterator = self.client.generate(
                     ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ElevenLabs' object has no attribute 'generate'
2025-12-31 13:06:57,402 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 13:06:57,904 - app.pipeline.pipeline_runner - INFO - Session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff turn 69bbdf83-8a8f-4652-91a3-28d07596d4d2 completed successfully
2025-12-31 13:07:13,253 - app.api.ws - ERROR - WebSocket error for session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:07:13,256 - app.api.ws - INFO - WebSocket disconnected for session b8bb9dc8-9c20-431f-92cb-2eea7bb02eff
2025-12-31 13:07:17,192 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:07:18,160 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:07:24,890 - app.api.session_manager - INFO - Session created: b73ac3d8-6818-4670-bebf-a5bb1f411e3e
2025-12-31 13:07:24,890 - app.api.routes - INFO - Session started: b73ac3d8-6818-4670-bebf-a5bb1f411e3e, Turn: 9732267a-3315-47a6-998a-b1b00ee8c9c6, Status: SessionStatus.LISTENING
2025-12-31 13:07:24,899 - app.api.ws - INFO - WebSocket connected for session b73ac3d8-6818-4670-bebf-a5bb1f411e3e. Total connections for session: 1
2025-12-31 13:07:24,929 - app.api.ws - INFO - Audio streaming started for session b73ac3d8-6818-4670-bebf-a5bb1f411e3e: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:07:26,762 - app.api.ws - INFO - Audio streaming ended for session b73ac3d8-6818-4670-bebf-a5bb1f411e3e
2025-12-31 13:07:26,763 - app.api.ws - INFO - Total audio received: 28398 bytes
2025-12-31 13:07:26,763 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session b73ac3d8-6818-4670-bebf-a5bb1f411e3e: 28398 bytes
2025-12-31 13:07:26,765 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:07:26,970 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:07:26,972 - app.pipeline.pipeline_runner - INFO - Converted audio: 27840 samples at 16000Hz
2025-12-31 13:07:26,974 - app.pipeline.pipeline_runner - INFO - Processing audio for session b73ac3d8-6818-4670-bebf-a5bb1f411e3e, turn 9732267a-3315-47a6-998a-b1b00ee8c9c6
2025-12-31 13:07:26,975 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:26,975 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:07:26,975 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:26,975 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:07:26,975 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 27840 samples
2025-12-31 13:07:26,977 - app.pipeline.processors.vad_processor - INFO - VAD complete: 27840 -> 25440 samples (1.59s)
2025-12-31 13:07:26,977 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:07:26,977 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 25440 samples, 1.59s
2025-12-31 13:07:26,978 - faster_whisper - INFO - Processing audio with duration 00:01.590
2025-12-31 13:07:28,201 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello, can you hear me?' (1.22s, language=en, probability=1.00)
2025-12-31 13:07:28,201 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello, can you hear me?'
2025-12-31 13:07:28,201 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:07:28,201 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello, can you hear me?'
2025-12-31 13:07:28,202 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:07:28,202 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:07:28,202 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello, can you hear me?'
2025-12-31 13:07:28,937 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm sorry, but I need to know what you're asking before I can respond. Can you provide more details?' (0.74s)
2025-12-31 13:07:28,938 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm sorry, but I need to know what you're asking before I can respond. Can you provide more details?'
2025-12-31 13:07:28,938 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:07:28,938 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm sorry, but I need to know what you're asking before I can respond. Can you provide more details?'
2025-12-31 13:07:28,938 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm sorry, but I need to know what you're asking before I can respond. Can you provide more details?'
2025-12-31 13:07:28,938 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm sorry, but I need to know what you're asking before I can respond. Can you provide more details?'
2025-12-31 13:07:28,938 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:28,938 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1963ms
2025-12-31 13:07:28,939 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:28,939 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello, can you hear me?', reply='I'm sorry, but I need to know what you're asking before I can respond. Can you provide more details?', route=llm, time=1963ms
2025-12-31 13:07:28,940 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:07:29,737 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:07:29,738 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'I'm sorry, but I need to know what you're asking before I can respond. Can you provide more details?'
2025-12-31 13:07:29,739 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:07:29,739 - app.pipeline.processors.tts_elevenlabs - ERROR - Error during TTS synthesis: 'ElevenLabs' object has no attribute 'generate'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 89, in synthesize_async
    audio_iterator = self.client.generate(
                     ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ElevenLabs' object has no attribute 'generate'
2025-12-31 13:07:29,741 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 13:07:30,257 - app.pipeline.pipeline_runner - INFO - Session b73ac3d8-6818-4670-bebf-a5bb1f411e3e turn 9732267a-3315-47a6-998a-b1b00ee8c9c6 completed successfully
2025-12-31 13:07:37,313 - app.api.session_manager - INFO - Session created: ec3373dd-2ef8-4266-b4b6-aaee4d61f959
2025-12-31 13:07:37,314 - app.api.routes - INFO - Session started: ec3373dd-2ef8-4266-b4b6-aaee4d61f959, Turn: d47c2380-72bd-4e09-b111-798fbd1d1b43, Status: SessionStatus.LISTENING
2025-12-31 13:07:37,345 - app.api.ws - INFO - WebSocket connected for session ec3373dd-2ef8-4266-b4b6-aaee4d61f959. Total connections for session: 1
2025-12-31 13:07:37,352 - app.api.ws - INFO - Audio streaming started for session ec3373dd-2ef8-4266-b4b6-aaee4d61f959: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:07:39,312 - app.api.ws - INFO - Audio streaming ended for session ec3373dd-2ef8-4266-b4b6-aaee4d61f959
2025-12-31 13:07:39,313 - app.api.ws - INFO - Total audio received: 30346 bytes
2025-12-31 13:07:39,313 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session ec3373dd-2ef8-4266-b4b6-aaee4d61f959: 30346 bytes
2025-12-31 13:07:39,315 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:07:39,505 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:07:39,506 - app.pipeline.pipeline_runner - INFO - Converted audio: 29760 samples at 16000Hz
2025-12-31 13:07:39,507 - app.pipeline.pipeline_runner - INFO - Processing audio for session ec3373dd-2ef8-4266-b4b6-aaee4d61f959, turn d47c2380-72bd-4e09-b111-798fbd1d1b43
2025-12-31 13:07:39,508 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:39,508 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:07:39,508 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:39,508 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:07:39,509 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 29760 samples
2025-12-31 13:07:39,510 - app.pipeline.processors.vad_processor - INFO - VAD complete: 29760 -> 24000 samples (1.50s)
2025-12-31 13:07:39,510 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:07:39,510 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 24000 samples, 1.50s
2025-12-31 13:07:39,511 - faster_whisper - INFO - Processing audio with duration 00:01.500
2025-12-31 13:07:40,784 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello?  Who are you?' (1.27s, language=en, probability=1.00)
2025-12-31 13:07:40,784 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello?  Who are you?'
2025-12-31 13:07:40,784 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:07:40,784 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello?  Who are you?'
2025-12-31 13:07:40,785 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:07:40,785 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:07:40,785 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello?  Who are you?'
2025-12-31 13:07:41,481 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm a friendly game character! How can I be helpful today?' (0.70s)
2025-12-31 13:07:41,481 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm a friendly game character! How can I be helpful today?'
2025-12-31 13:07:41,481 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:07:41,481 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm a friendly game character! How can I be helpful today?'
2025-12-31 13:07:41,481 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm a friendly game character! How can I be helpful today?'
2025-12-31 13:07:41,482 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm a friendly game character! How can I be helpful today?'
2025-12-31 13:07:41,482 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:41,482 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1974ms
2025-12-31 13:07:41,482 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:07:41,483 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello?  Who are you?', reply='I'm a friendly game character! How can I be helpful today?', route=llm, time=1974ms
2025-12-31 13:07:41,484 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:07:42,257 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:07:42,258 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'I'm a friendly game character! How can I be helpful today?'
2025-12-31 13:07:42,260 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:07:42,260 - app.pipeline.processors.tts_elevenlabs - ERROR - Error during TTS synthesis: 'ElevenLabs' object has no attribute 'generate'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 89, in synthesize_async
    audio_iterator = self.client.generate(
                     ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ElevenLabs' object has no attribute 'generate'
2025-12-31 13:07:42,262 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 13:07:42,764 - app.pipeline.pipeline_runner - INFO - Session ec3373dd-2ef8-4266-b4b6-aaee4d61f959 turn d47c2380-72bd-4e09-b111-798fbd1d1b43 completed successfully
2025-12-31 13:08:22,631 - app.api.ws - ERROR - WebSocket error for session b73ac3d8-6818-4670-bebf-a5bb1f411e3e: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:08:22,634 - app.api.ws - INFO - WebSocket disconnected for session b73ac3d8-6818-4670-bebf-a5bb1f411e3e
2025-12-31 13:08:22,635 - app.api.ws - ERROR - WebSocket error for session ec3373dd-2ef8-4266-b4b6-aaee4d61f959: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:08:22,638 - app.api.ws - INFO - WebSocket disconnected for session ec3373dd-2ef8-4266-b4b6-aaee4d61f959
2025-12-31 13:09:52,964 - app.main - INFO - ============================================================
2025-12-31 13:09:52,964 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:09:52,964 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:09:52,964 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:09:52,964 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:09:52,964 - app.main - INFO - STT Model: base.en
2025-12-31 13:09:52,964 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:09:52,964 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:09:52,964 - app.main - INFO - ============================================================
2025-12-31 13:09:52,964 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:10:46,890 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:10:47,833 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:10:55,734 - app.api.session_manager - INFO - Session created: cc9e0196-4f50-423a-8309-cf8904f5e611
2025-12-31 13:10:55,734 - app.api.routes - INFO - Session started: cc9e0196-4f50-423a-8309-cf8904f5e611, Turn: 46b77a4b-8ed2-444a-bd3c-006c9fa8dac6, Status: SessionStatus.LISTENING
2025-12-31 13:10:55,756 - app.api.ws - INFO - WebSocket connected for session cc9e0196-4f50-423a-8309-cf8904f5e611. Total connections for session: 1
2025-12-31 13:10:55,774 - app.api.ws - INFO - Audio streaming started for session cc9e0196-4f50-423a-8309-cf8904f5e611: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:10:57,228 - app.api.ws - INFO - Audio streaming ended for session cc9e0196-4f50-423a-8309-cf8904f5e611
2025-12-31 13:10:57,229 - app.api.ws - INFO - Total audio received: 20606 bytes
2025-12-31 13:10:57,229 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session cc9e0196-4f50-423a-8309-cf8904f5e611: 20606 bytes
2025-12-31 13:10:57,235 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:10:57,445 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:10:57,446 - app.pipeline.pipeline_runner - INFO - Converted audio: 20160 samples at 16000Hz
2025-12-31 13:10:57,448 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 13:10:57,448 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 13:10:57,449 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 13:10:58,948 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 13:11:00,049 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 13:11:00,049 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 13:11:00,049 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 13:11:00,066 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 13:11:00,066 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 13:11:00,067 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 13:11:00,067 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 13:11:00,067 - app.pipeline.pipeline_runner - INFO - Processing audio for session cc9e0196-4f50-423a-8309-cf8904f5e611, turn 46b77a4b-8ed2-444a-bd3c-006c9fa8dac6
2025-12-31 13:11:00,068 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:11:00,068 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:11:00,069 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:11:00,069 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:11:00,069 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 20160 samples
2025-12-31 13:11:00,070 - app.pipeline.processors.vad_processor - INFO - VAD complete: 20160 -> 11520 samples (0.72s)
2025-12-31 13:11:00,070 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:11:00,071 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 13:11:00,071 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 13:11:03,538 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 13:11:03,539 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 13:11:03,539 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 13:11:08,655 - app.api.session_manager - INFO - Session created: 923a066d-f2af-407f-92f3-387bfdb9ab6a
2025-12-31 13:11:08,655 - app.api.routes - INFO - Session started: 923a066d-f2af-407f-92f3-387bfdb9ab6a, Turn: 5f399c17-e464-4f14-bf0d-c7c97e2ad48d, Status: SessionStatus.LISTENING
2025-12-31 13:11:08,678 - app.api.ws - INFO - WebSocket connected for session 923a066d-f2af-407f-92f3-387bfdb9ab6a. Total connections for session: 1
2025-12-31 13:11:08,685 - app.api.ws - INFO - Audio streaming started for session 923a066d-f2af-407f-92f3-387bfdb9ab6a: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:11:11,245 - app.api.ws - INFO - Audio streaming ended for session 923a066d-f2af-407f-92f3-387bfdb9ab6a
2025-12-31 13:11:11,245 - app.api.ws - INFO - Total audio received: 40086 bytes
2025-12-31 13:11:11,246 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 923a066d-f2af-407f-92f3-387bfdb9ab6a: 40086 bytes
2025-12-31 13:11:11,248 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:11:11,447 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:11:11,448 - app.pipeline.pipeline_runner - INFO - Converted audio: 39360 samples at 16000Hz
2025-12-31 13:11:11,450 - app.pipeline.pipeline_runner - INFO - Processing audio for session 923a066d-f2af-407f-92f3-387bfdb9ab6a, turn 5f399c17-e464-4f14-bf0d-c7c97e2ad48d
2025-12-31 13:11:11,450 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:11:11,451 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:11:11,451 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:11:11,451 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:11:11,451 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 39360 samples
2025-12-31 13:11:11,452 - app.pipeline.processors.vad_processor - INFO - VAD complete: 39360 -> 31680 samples (1.98s)
2025-12-31 13:11:11,453 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:11:11,453 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 31680 samples, 1.98s
2025-12-31 13:11:11,453 - faster_whisper - INFO - Processing audio with duration 00:01.980
2025-12-31 13:11:12,624 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello.  Hi, Jeremy.' (1.17s, language=en, probability=1.00)
2025-12-31 13:11:12,624 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello.  Hi, Jeremy.'
2025-12-31 13:11:12,624 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:11:12,624 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello.  Hi, Jeremy.'
2025-12-31 13:11:12,625 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:11:12,625 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:11:12,625 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello.  Hi, Jeremy.'
2025-12-31 13:11:13,220 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hey there! How are you today? Let's chat!' (0.59s)
2025-12-31 13:11:13,221 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hey there! How are you today? Let's chat!'
2025-12-31 13:11:13,221 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:11:13,221 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hey there! How are you today? Let's chat!'
2025-12-31 13:11:13,221 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-31 13:11:13,221 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hey there! How are you today?'
2025-12-31 13:11:13,221 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hey there! How are you today?'
2025-12-31 13:11:13,222 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:11:13,222 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1771ms
2025-12-31 13:11:13,222 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:11:13,222 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello.  Hi, Jeremy.', reply='Hey there! How are you today?', route=llm, time=1771ms
2025-12-31 13:11:13,271 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:11:14,559 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:11:14,562 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Hey there! How are you today?'
2025-12-31 13:11:14,563 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:11:14,795 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/Rachel "HTTP/1.1 404 Not Found"
2025-12-31 13:11:14,796 - app.pipeline.processors.tts_elevenlabs - ERROR - Error during TTS synthesis: headers: {'date': 'Wed, 31 Dec 2025 19:11:14 GMT', 'server': 'uvicorn', 'content-length': '99', 'content-type': 'application/json', 'access-control-allow-origin': '*', 'access-control-allow-headers': '*', 'access-control-allow-methods': 'POST, PATCH, OPTIONS, DELETE, GET, PUT', 'access-control-max-age': '600', 'strict-transport-security': 'max-age=31536000; includeSubDomains', 'x-trace-id': 'd0ddaf8a186a61d17a746193d0033f58', 'x-region': 'us-central1', 'via': '1.1 google, 1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'}, status_code: 404, body: {'detail': {'status': 'voice_not_found', 'message': 'A voice with the voice_id Rachel was not found.'}}
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 88, in synthesize_async
    for chunk in audio_generator:
                 ^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\client.py", line 157, in convert
    with self._raw_client.convert(
         ~~~~~~~~~~~~~~~~~~~~~~~~^
        voice_id,
        ^^^^^^^^^
    ...<16 lines>...
        request_options=request_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as r:
    ^
  File "C:\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\raw_client.py", line 204, in convert
    yield _stream()
          ~~~~~~~^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\raw_client.py", line 202, in _stream
    raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response_json)
elevenlabs.core.api_error.ApiError: headers: {'date': 'Wed, 31 Dec 2025 19:11:14 GMT', 'server': 'uvicorn', 'content-length': '99', 'content-type': 'application/json', 'access-control-allow-origin': '*', 'access-control-allow-headers': '*', 'access-control-allow-methods': 'POST, PATCH, OPTIONS, DELETE, GET, PUT', 'access-control-max-age': '600', 'strict-transport-security': 'max-age=31536000; includeSubDomains', 'x-trace-id': 'd0ddaf8a186a61d17a746193d0033f58', 'x-region': 'us-central1', 'via': '1.1 google, 1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'}, status_code: 404, body: {'detail': {'status': 'voice_not_found', 'message': 'A voice with the voice_id Rachel was not found.'}}
2025-12-31 13:11:14,829 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 13:11:15,333 - app.pipeline.pipeline_runner - INFO - Session 923a066d-f2af-407f-92f3-387bfdb9ab6a turn 5f399c17-e464-4f14-bf0d-c7c97e2ad48d completed successfully
2025-12-31 13:22:24,793 - app.main - INFO - ============================================================
2025-12-31 13:22:24,794 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:22:24,794 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:22:24,794 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:22:24,794 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:22:24,795 - app.main - INFO - STT Model: base.en
2025-12-31 13:22:24,795 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:22:24,795 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:22:24,795 - app.main - INFO - ============================================================
2025-12-31 13:22:24,796 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:22:40,056 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:22:41,050 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:22:44,506 - app.api.session_manager - INFO - Session created: 4d75b286-14bd-447c-b6d3-ca8d0f26586b
2025-12-31 13:22:44,506 - app.api.routes - INFO - Session started: 4d75b286-14bd-447c-b6d3-ca8d0f26586b, Turn: c54da6ae-1c8a-491e-a797-50d69f774d66, Status: SessionStatus.LISTENING
2025-12-31 13:22:44,521 - app.api.ws - INFO - WebSocket connected for session 4d75b286-14bd-447c-b6d3-ca8d0f26586b. Total connections for session: 1
2025-12-31 13:22:44,548 - app.api.ws - INFO - Audio streaming started for session 4d75b286-14bd-447c-b6d3-ca8d0f26586b: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:22:46,721 - app.api.ws - INFO - Audio streaming ended for session 4d75b286-14bd-447c-b6d3-ca8d0f26586b
2025-12-31 13:22:46,721 - app.api.ws - INFO - Total audio received: 34242 bytes
2025-12-31 13:22:46,722 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 4d75b286-14bd-447c-b6d3-ca8d0f26586b: 34242 bytes
2025-12-31 13:22:46,726 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:22:46,955 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:22:46,957 - app.pipeline.pipeline_runner - INFO - Converted audio: 33600 samples at 16000Hz
2025-12-31 13:22:46,959 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 13:22:46,960 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 13:22:46,960 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 13:22:48,401 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 13:22:49,279 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 13:22:49,280 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 13:22:49,280 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 13:22:49,314 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 13:22:49,315 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 13:22:49,315 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 13:22:49,316 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 13:22:49,316 - app.pipeline.pipeline_runner - INFO - Processing audio for session 4d75b286-14bd-447c-b6d3-ca8d0f26586b, turn c54da6ae-1c8a-491e-a797-50d69f774d66
2025-12-31 13:22:49,317 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:22:49,318 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:22:49,318 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:22:49,319 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:22:49,319 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 33600 samples
2025-12-31 13:22:49,320 - app.pipeline.processors.vad_processor - INFO - VAD complete: 33600 -> 11520 samples (0.72s)
2025-12-31 13:22:49,320 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:22:49,321 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 13:22:49,321 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 13:22:50,645 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 13:22:50,646 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 13:22:50,646 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 13:22:55,984 - app.api.session_manager - INFO - Session created: ca59df2b-9812-41b1-adc6-85081e9102e9
2025-12-31 13:22:55,985 - app.api.routes - INFO - Session started: ca59df2b-9812-41b1-adc6-85081e9102e9, Turn: 8553d9a6-964a-4749-b5e9-2de975e98834, Status: SessionStatus.LISTENING
2025-12-31 13:22:56,021 - app.api.ws - INFO - WebSocket connected for session ca59df2b-9812-41b1-adc6-85081e9102e9. Total connections for session: 1
2025-12-31 13:22:56,032 - app.api.ws - INFO - Audio streaming started for session ca59df2b-9812-41b1-adc6-85081e9102e9: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:22:59,364 - app.api.ws - INFO - Audio streaming ended for session ca59df2b-9812-41b1-adc6-85081e9102e9
2025-12-31 13:22:59,365 - app.api.ws - INFO - Total audio received: 51774 bytes
2025-12-31 13:22:59,365 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session ca59df2b-9812-41b1-adc6-85081e9102e9: 51774 bytes
2025-12-31 13:22:59,368 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:22:59,570 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:22:59,571 - app.pipeline.pipeline_runner - INFO - Converted audio: 50880 samples at 16000Hz
2025-12-31 13:22:59,573 - app.pipeline.pipeline_runner - INFO - Processing audio for session ca59df2b-9812-41b1-adc6-85081e9102e9, turn 8553d9a6-964a-4749-b5e9-2de975e98834
2025-12-31 13:22:59,573 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:22:59,574 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:22:59,574 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:22:59,576 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:22:59,576 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 50880 samples
2025-12-31 13:22:59,578 - app.pipeline.processors.vad_processor - INFO - VAD complete: 50880 -> 16800 samples (1.05s)
2025-12-31 13:22:59,578 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:22:59,579 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 16800 samples, 1.05s
2025-12-31 13:22:59,579 - faster_whisper - INFO - Processing audio with duration 00:01.050
2025-12-31 13:23:00,905 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'and go.' (1.33s, language=en, probability=1.00)
2025-12-31 13:23:00,906 - app.pipeline.voice_pipeline - INFO - Transcript: 'and go.'
2025-12-31 13:23:00,906 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:23:00,906 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'and go.'
2025-12-31 13:23:00,907 - app.pipeline.processors.skills_router - INFO - Math query detected
2025-12-31 13:23:00,908 - app.pipeline.processors.skills_router - WARNING - Math query detected but could not parse expression
2025-12-31 13:23:00,909 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:23:00,910 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:23:00,911 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'and go.'
2025-12-31 13:23:05,831 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Go! I can't help with that directly. Let's do another thing instead.' (4.92s)
2025-12-31 13:23:05,832 - app.pipeline.voice_pipeline - INFO - LLM response: 'Go! I can't help with that directly. Let's do another thing instead.'
2025-12-31 13:23:05,832 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:23:05,832 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Go! I can't help with that directly. Let's do another thing instead.'
2025-12-31 13:23:05,833 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-31 13:23:05,833 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Go! I can't help with that directly.'
2025-12-31 13:23:05,833 - app.pipeline.voice_pipeline - INFO - Final reply: 'Go! I can't help with that directly.'
2025-12-31 13:23:05,834 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:23:05,834 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 6260ms
2025-12-31 13:23:05,834 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:23:05,835 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='and go.', reply='Go! I can't help with that directly.', route=llm, time=6260ms
2025-12-31 13:23:05,839 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:23:06,181 - app.pipeline.pipeline_runner - ERROR - Error generating TTS audio: ELEVENLABS_API_KEY is required. Set it in your .env file or environment variables. Get your API key from: https://elevenlabs.io
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\pipeline_runner.py", line 222, in _generate_audio_placeholder
    tts = ElevenLabsTTSProcessor(voice=settings.ELEVENLABS_VOICE)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 46, in __init__
    raise ValueError(
    ...<3 lines>...
    )
ValueError: ELEVENLABS_API_KEY is required. Set it in your .env file or environment variables. Get your API key from: https://elevenlabs.io
2025-12-31 13:23:06,687 - app.pipeline.pipeline_runner - INFO - Session ca59df2b-9812-41b1-adc6-85081e9102e9 turn 8553d9a6-964a-4749-b5e9-2de975e98834 completed successfully
2025-12-31 13:24:46,764 - app.main - INFO - ============================================================
2025-12-31 13:24:46,765 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:24:46,765 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:24:46,765 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:24:46,765 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:24:46,765 - app.main - INFO - STT Model: base.en
2025-12-31 13:24:46,765 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:24:46,765 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:24:46,765 - app.main - INFO - ============================================================
2025-12-31 13:24:46,765 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:24:46,768 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:24:46,768 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:26:49,688 - app.api.ws - ERROR - WebSocket error for session ca59df2b-9812-41b1-adc6-85081e9102e9: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:26:49,691 - app.api.ws - INFO - WebSocket disconnected for session ca59df2b-9812-41b1-adc6-85081e9102e9
2025-12-31 13:26:49,692 - app.api.ws - ERROR - WebSocket error for session 4d75b286-14bd-447c-b6d3-ca8d0f26586b: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:26:49,693 - app.api.ws - INFO - WebSocket disconnected for session 4d75b286-14bd-447c-b6d3-ca8d0f26586b
2025-12-31 13:26:49,794 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:26:49,795 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:26:55,910 - app.main - INFO - ============================================================
2025-12-31 13:26:55,911 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:26:55,911 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:26:55,911 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:26:55,911 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:26:55,912 - app.main - INFO - STT Model: base.en
2025-12-31 13:26:55,912 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:26:55,912 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:26:55,912 - app.main - INFO - ============================================================
2025-12-31 13:26:55,913 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:26:57,315 - app.api.ws - INFO - WebSocket connected for session ca59df2b-9812-41b1-adc6-85081e9102e9. Total connections for session: 1
2025-12-31 13:27:05,147 - app.api.session_manager - INFO - Session created: 7fdfc3e0-e8df-4964-b680-64a5ead079b2
2025-12-31 13:27:05,147 - app.api.routes - INFO - Session started: 7fdfc3e0-e8df-4964-b680-64a5ead079b2, Turn: d415c50d-5d7a-4dc5-a774-e5ce4bc493da, Status: SessionStatus.LISTENING
2025-12-31 13:27:05,170 - app.api.ws - INFO - WebSocket connected for session 7fdfc3e0-e8df-4964-b680-64a5ead079b2. Total connections for session: 1
2025-12-31 13:27:05,180 - app.api.ws - INFO - Audio streaming started for session 7fdfc3e0-e8df-4964-b680-64a5ead079b2: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:27:07,402 - app.api.ws - INFO - Audio streaming ended for session 7fdfc3e0-e8df-4964-b680-64a5ead079b2
2025-12-31 13:27:07,403 - app.api.ws - INFO - Total audio received: 34242 bytes
2025-12-31 13:27:07,404 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 7fdfc3e0-e8df-4964-b680-64a5ead079b2: 34242 bytes
2025-12-31 13:27:07,418 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:27:07,660 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:27:07,661 - app.pipeline.pipeline_runner - INFO - Converted audio: 33600 samples at 16000Hz
2025-12-31 13:27:07,663 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 13:27:07,663 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 13:27:07,664 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 13:27:09,445 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 13:27:10,425 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 13:27:10,426 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 13:27:10,426 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 13:27:10,454 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 13:27:10,455 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 13:27:10,455 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 13:27:10,456 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 13:27:10,456 - app.pipeline.pipeline_runner - INFO - Processing audio for session 7fdfc3e0-e8df-4964-b680-64a5ead079b2, turn d415c50d-5d7a-4dc5-a774-e5ce4bc493da
2025-12-31 13:27:10,457 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:27:10,458 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:27:10,458 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:27:10,459 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:27:10,459 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 33600 samples
2025-12-31 13:27:10,460 - app.pipeline.processors.vad_processor - INFO - VAD complete: 33600 -> 11520 samples (0.72s)
2025-12-31 13:27:10,461 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:27:10,461 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 13:27:10,461 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 13:27:11,905 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 13:27:11,906 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 13:27:11,907 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 13:27:17,249 - app.api.session_manager - INFO - Session created: 5708b181-4669-478d-a2d6-2969aaf8e049
2025-12-31 13:27:17,250 - app.api.routes - INFO - Session started: 5708b181-4669-478d-a2d6-2969aaf8e049, Turn: 23052b7e-9b1b-43e0-a61a-e8f8992b9e8d, Status: SessionStatus.LISTENING
2025-12-31 13:27:17,274 - app.api.ws - INFO - WebSocket connected for session 5708b181-4669-478d-a2d6-2969aaf8e049. Total connections for session: 1
2025-12-31 13:27:17,283 - app.api.ws - INFO - Audio streaming started for session 5708b181-4669-478d-a2d6-2969aaf8e049: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:27:20,539 - app.api.ws - INFO - Audio streaming ended for session 5708b181-4669-478d-a2d6-2969aaf8e049
2025-12-31 13:27:20,540 - app.api.ws - INFO - Total audio received: 51774 bytes
2025-12-31 13:27:20,541 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 5708b181-4669-478d-a2d6-2969aaf8e049: 51774 bytes
2025-12-31 13:27:20,546 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:27:20,750 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:27:20,752 - app.pipeline.pipeline_runner - INFO - Converted audio: 50880 samples at 16000Hz
2025-12-31 13:27:20,754 - app.pipeline.pipeline_runner - INFO - Processing audio for session 5708b181-4669-478d-a2d6-2969aaf8e049, turn 23052b7e-9b1b-43e0-a61a-e8f8992b9e8d
2025-12-31 13:27:20,755 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:27:20,755 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:27:20,756 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:27:20,757 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:27:20,757 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 50880 samples
2025-12-31 13:27:20,761 - app.pipeline.processors.vad_processor - INFO - VAD complete: 50880 -> 18240 samples (1.14s)
2025-12-31 13:27:20,762 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:27:20,763 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 18240 samples, 1.14s
2025-12-31 13:27:20,763 - faster_whisper - INFO - Processing audio with duration 00:01.140
2025-12-31 13:27:22,085 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello' (1.32s, language=en, probability=1.00)
2025-12-31 13:27:22,085 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello'
2025-12-31 13:27:22,085 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:27:22,086 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello'
2025-12-31 13:27:22,086 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:27:22,087 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:27:22,087 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello'
2025-12-31 13:27:22,773 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! How may I assist you today?' (0.69s)
2025-12-31 13:27:22,774 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! How may I assist you today?'
2025-12-31 13:27:22,774 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:27:22,774 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! How may I assist you today?'
2025-12-31 13:27:22,775 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! How may I assist you today?'
2025-12-31 13:27:22,776 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! How may I assist you today?'
2025-12-31 13:27:22,776 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:27:22,777 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2021ms
2025-12-31 13:27:22,777 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:27:22,778 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello', reply='Hello! How may I assist you today?', route=llm, time=2021ms
2025-12-31 13:27:22,785 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:27:23,918 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:27:23,920 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Hello! How may I assist you today?'
2025-12-31 13:27:23,921 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:27:24,138 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/Rachel "HTTP/1.1 404 Not Found"
2025-12-31 13:27:24,139 - app.pipeline.processors.tts_elevenlabs - ERROR - Error during TTS synthesis: headers: {'date': 'Wed, 31 Dec 2025 19:27:23 GMT', 'server': 'uvicorn', 'content-length': '99', 'content-type': 'application/json', 'access-control-allow-origin': '*', 'access-control-allow-headers': '*', 'access-control-allow-methods': 'POST, PATCH, OPTIONS, DELETE, GET, PUT', 'access-control-max-age': '600', 'strict-transport-security': 'max-age=31536000; includeSubDomains', 'x-trace-id': 'a2c4719364046ba45327de45a1bbd81a', 'x-region': 'us-central1', 'via': '1.1 google, 1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'}, status_code: 404, body: {'detail': {'status': 'voice_not_found', 'message': 'A voice with the voice_id Rachel was not found.'}}
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 88, in synthesize_async
    for chunk in audio_generator:
                 ^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\client.py", line 157, in convert
    with self._raw_client.convert(
         ~~~~~~~~~~~~~~~~~~~~~~~~^
        voice_id,
        ^^^^^^^^^
    ...<16 lines>...
        request_options=request_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as r:
    ^
  File "C:\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\raw_client.py", line 204, in convert
    yield _stream()
          ~~~~~~~^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\raw_client.py", line 202, in _stream
    raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response_json)
elevenlabs.core.api_error.ApiError: headers: {'date': 'Wed, 31 Dec 2025 19:27:23 GMT', 'server': 'uvicorn', 'content-length': '99', 'content-type': 'application/json', 'access-control-allow-origin': '*', 'access-control-allow-headers': '*', 'access-control-allow-methods': 'POST, PATCH, OPTIONS, DELETE, GET, PUT', 'access-control-max-age': '600', 'strict-transport-security': 'max-age=31536000; includeSubDomains', 'x-trace-id': 'a2c4719364046ba45327de45a1bbd81a', 'x-region': 'us-central1', 'via': '1.1 google, 1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'}, status_code: 404, body: {'detail': {'status': 'voice_not_found', 'message': 'A voice with the voice_id Rachel was not found.'}}
2025-12-31 13:27:24,150 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 13:27:24,651 - app.pipeline.pipeline_runner - INFO - Session 5708b181-4669-478d-a2d6-2969aaf8e049 turn 23052b7e-9b1b-43e0-a61a-e8f8992b9e8d completed successfully
2025-12-31 13:28:40,913 - app.main - INFO - ============================================================
2025-12-31 13:28:40,914 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:28:40,914 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:28:40,914 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:28:40,914 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:28:40,914 - app.main - INFO - STT Model: base.en
2025-12-31 13:28:40,914 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:28:40,914 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:28:40,914 - app.main - INFO - ============================================================
2025-12-31 13:28:40,915 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:28:40,916 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:28:40,916 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:29:07,034 - app.api.ws - ERROR - WebSocket error for session ca59df2b-9812-41b1-adc6-85081e9102e9: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:29:07,037 - app.api.ws - INFO - WebSocket disconnected for session ca59df2b-9812-41b1-adc6-85081e9102e9
2025-12-31 13:29:07,037 - app.api.ws - ERROR - WebSocket error for session 5708b181-4669-478d-a2d6-2969aaf8e049: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:29:07,039 - app.api.ws - INFO - WebSocket disconnected for session 5708b181-4669-478d-a2d6-2969aaf8e049
2025-12-31 13:29:07,039 - app.api.ws - ERROR - WebSocket error for session 7fdfc3e0-e8df-4964-b680-64a5ead079b2: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:29:07,041 - app.api.ws - INFO - WebSocket disconnected for session 7fdfc3e0-e8df-4964-b680-64a5ead079b2
2025-12-31 13:29:07,139 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:29:07,139 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:29:12,678 - app.main - INFO - ============================================================
2025-12-31 13:29:12,678 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:29:12,678 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:29:12,678 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:29:12,679 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:29:12,679 - app.main - INFO - STT Model: base.en
2025-12-31 13:29:12,679 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:29:12,679 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:29:12,679 - app.main - INFO - ============================================================
2025-12-31 13:29:12,679 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:29:14,316 - app.api.ws - INFO - WebSocket connected for session 5708b181-4669-478d-a2d6-2969aaf8e049. Total connections for session: 1
2025-12-31 13:30:11,327 - app.api.session_manager - INFO - Session created: 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a
2025-12-31 13:30:11,328 - app.api.routes - INFO - Session started: 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a, Turn: 91edbd43-e5eb-4371-afb2-501727d0e6df, Status: SessionStatus.LISTENING
2025-12-31 13:30:11,348 - app.api.ws - INFO - WebSocket connected for session 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a. Total connections for session: 1
2025-12-31 13:30:11,354 - app.api.ws - INFO - Audio streaming started for session 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:30:13,810 - app.api.ws - INFO - Audio streaming ended for session 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a
2025-12-31 13:30:13,811 - app.api.ws - INFO - Total audio received: 38138 bytes
2025-12-31 13:30:13,812 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a: 38138 bytes
2025-12-31 13:30:13,816 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:30:14,075 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:30:14,077 - app.pipeline.pipeline_runner - INFO - Converted audio: 37440 samples at 16000Hz
2025-12-31 13:30:14,079 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 13:30:14,080 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 13:30:14,080 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 13:30:16,240 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 13:30:17,331 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 13:30:17,331 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 13:30:17,331 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 13:30:17,341 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 13:30:17,342 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 13:30:17,343 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 13:30:17,343 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 13:30:17,343 - app.pipeline.pipeline_runner - INFO - Processing audio for session 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a, turn 91edbd43-e5eb-4371-afb2-501727d0e6df
2025-12-31 13:30:17,345 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:30:17,346 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:30:17,348 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:30:17,348 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:30:17,348 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 37440 samples
2025-12-31 13:30:17,349 - app.pipeline.processors.vad_processor - INFO - VAD complete: 37440 -> 11520 samples (0.72s)
2025-12-31 13:30:17,349 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:30:17,350 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 13:30:17,350 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 13:30:21,119 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 13:30:21,120 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 13:30:21,121 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 13:30:40,472 - app.api.session_manager - INFO - Session created: 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356
2025-12-31 13:30:40,472 - app.api.routes - INFO - Session started: 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356, Turn: 39e4bb6a-1f31-4701-9d25-78bc2a336985, Status: SessionStatus.LISTENING
2025-12-31 13:30:40,516 - app.api.ws - INFO - WebSocket connected for session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356. Total connections for session: 1
2025-12-31 13:30:40,528 - app.api.ws - INFO - Audio streaming started for session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:30:44,168 - app.api.ws - INFO - Audio streaming ended for session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356
2025-12-31 13:30:44,169 - app.api.ws - INFO - Total audio received: 57618 bytes
2025-12-31 13:30:44,170 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356: 57618 bytes
2025-12-31 13:30:44,172 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:30:44,454 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:30:44,457 - app.pipeline.pipeline_runner - INFO - Converted audio: 56640 samples at 16000Hz
2025-12-31 13:30:44,460 - app.pipeline.pipeline_runner - INFO - Processing audio for session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356, turn 39e4bb6a-1f31-4701-9d25-78bc2a336985
2025-12-31 13:30:44,462 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:30:44,462 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:30:44,463 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:30:44,463 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:30:44,464 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 56640 samples
2025-12-31 13:30:44,466 - app.pipeline.processors.vad_processor - INFO - VAD complete: 56640 -> 16320 samples (1.02s)
2025-12-31 13:30:44,467 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:30:44,467 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 16320 samples, 1.02s
2025-12-31 13:30:44,468 - faster_whisper - INFO - Processing audio with duration 00:01.020
2025-12-31 13:30:45,948 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello' (1.48s, language=en, probability=1.00)
2025-12-31 13:30:45,949 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello'
2025-12-31 13:30:45,949 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:30:45,949 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello'
2025-12-31 13:30:45,950 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:30:45,950 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:30:45,950 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello'
2025-12-31 13:30:46,486 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! How may I assist you today?' (0.54s)
2025-12-31 13:30:46,487 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! How may I assist you today?'
2025-12-31 13:30:46,487 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:30:46,488 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! How may I assist you today?'
2025-12-31 13:30:46,488 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! How may I assist you today?'
2025-12-31 13:30:46,488 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! How may I assist you today?'
2025-12-31 13:30:46,489 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:30:46,489 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2026ms
2025-12-31 13:30:46,489 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:30:46,490 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello', reply='Hello! How may I assist you today?', route=llm, time=2026ms
2025-12-31 13:30:46,495 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: Rachel
2025-12-31 13:30:47,604 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:30:47,606 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Hello! How may I assist you today?'
2025-12-31 13:30:47,607 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:30:47,776 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/Rachel "HTTP/1.1 404 Not Found"
2025-12-31 13:30:47,777 - app.pipeline.processors.tts_elevenlabs - ERROR - Error during TTS synthesis: headers: {'date': 'Wed, 31 Dec 2025 19:30:46 GMT', 'server': 'uvicorn', 'content-length': '99', 'content-type': 'application/json', 'access-control-allow-origin': '*', 'access-control-allow-headers': '*', 'access-control-allow-methods': 'POST, PATCH, OPTIONS, DELETE, GET, PUT', 'access-control-max-age': '600', 'strict-transport-security': 'max-age=31536000; includeSubDomains', 'x-trace-id': 'e5f4f7f1c61c1719e2f34f552f148936', 'x-region': 'us-central1', 'via': '1.1 google, 1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'}, status_code: 404, body: {'detail': {'status': 'voice_not_found', 'message': 'A voice with the voice_id Rachel was not found.'}}
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\tts_elevenlabs.py", line 88, in synthesize_async
    for chunk in audio_generator:
                 ^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\client.py", line 157, in convert
    with self._raw_client.convert(
         ~~~~~~~~~~~~~~~~~~~~~~~~^
        voice_id,
        ^^^^^^^^^
    ...<16 lines>...
        request_options=request_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as r:
    ^
  File "C:\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\raw_client.py", line 204, in convert
    yield _stream()
          ~~~~~~~^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\elevenlabs\text_to_speech\raw_client.py", line 202, in _stream
    raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response_json)
elevenlabs.core.api_error.ApiError: headers: {'date': 'Wed, 31 Dec 2025 19:30:46 GMT', 'server': 'uvicorn', 'content-length': '99', 'content-type': 'application/json', 'access-control-allow-origin': '*', 'access-control-allow-headers': '*', 'access-control-allow-methods': 'POST, PATCH, OPTIONS, DELETE, GET, PUT', 'access-control-max-age': '600', 'strict-transport-security': 'max-age=31536000; includeSubDomains', 'x-trace-id': 'e5f4f7f1c61c1719e2f34f552f148936', 'x-region': 'us-central1', 'via': '1.1 google, 1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'}, status_code: 404, body: {'detail': {'status': 'voice_not_found', 'message': 'A voice with the voice_id Rachel was not found.'}}
2025-12-31 13:30:47,785 - app.pipeline.pipeline_runner - ERROR - TTS synthesis failed
2025-12-31 13:30:48,300 - app.pipeline.pipeline_runner - INFO - Session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356 turn 39e4bb6a-1f31-4701-9d25-78bc2a336985 completed successfully
2025-12-31 13:35:12,735 - app.api.session_manager - INFO - Cleaning up expired session: 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a
2025-12-31 13:35:12,735 - app.api.session_manager - INFO - Session deleted: 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a
2025-12-31 13:36:12,749 - app.api.session_manager - INFO - Cleaning up expired session: 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356
2025-12-31 13:36:12,750 - app.api.session_manager - INFO - Session deleted: 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356
2025-12-31 13:40:25,043 - app.main - INFO - ============================================================
2025-12-31 13:40:25,043 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:40:25,043 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:40:25,043 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:40:25,043 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:40:25,043 - app.main - INFO - STT Model: base.en
2025-12-31 13:40:25,044 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:40:25,044 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:40:25,044 - app.main - INFO - ============================================================
2025-12-31 13:40:25,044 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:40:25,045 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:40:25,045 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:41:40,049 - app.api.ws - ERROR - WebSocket error for session 5708b181-4669-478d-a2d6-2969aaf8e049: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:41:40,055 - app.api.ws - INFO - WebSocket disconnected for session 5708b181-4669-478d-a2d6-2969aaf8e049
2025-12-31 13:41:40,062 - app.api.ws - ERROR - WebSocket error for session 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:41:40,070 - app.api.ws - INFO - WebSocket disconnected for session 1b0199f3-1897-4a90-b4ac-2e870dbf9e2a
2025-12-31 13:41:40,076 - app.api.ws - ERROR - WebSocket error for session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:41:40,083 - app.api.ws - INFO - WebSocket disconnected for session 1bb03c3e-6cd1-4ad0-9e4b-f5bdd3138356
2025-12-31 13:41:42,089 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:41:43,027 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 13:41:47,170 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:41:47,170 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:41:54,285 - app.main - INFO - ============================================================
2025-12-31 13:41:54,285 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:41:54,286 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:41:54,286 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:41:54,286 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:41:54,286 - app.main - INFO - STT Model: base.en
2025-12-31 13:41:54,286 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:41:54,287 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:41:54,287 - app.main - INFO - ============================================================
2025-12-31 13:41:54,288 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:42:06,603 - app.api.session_manager - INFO - Session created: 653cf4b3-a70b-42fc-a828-fb9d11828822
2025-12-31 13:42:06,604 - app.api.routes - INFO - Session started: 653cf4b3-a70b-42fc-a828-fb9d11828822, Turn: 433bb86d-4bf7-4431-bd29-fde8345504de, Status: SessionStatus.LISTENING
2025-12-31 13:42:06,620 - app.api.ws - INFO - WebSocket connected for session 653cf4b3-a70b-42fc-a828-fb9d11828822. Total connections for session: 1
2025-12-31 13:42:06,665 - app.api.ws - INFO - Audio streaming started for session 653cf4b3-a70b-42fc-a828-fb9d11828822: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:42:08,644 - app.api.ws - INFO - Audio streaming ended for session 653cf4b3-a70b-42fc-a828-fb9d11828822
2025-12-31 13:42:08,645 - app.api.ws - INFO - Total audio received: 30346 bytes
2025-12-31 13:42:08,646 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 653cf4b3-a70b-42fc-a828-fb9d11828822: 30346 bytes
2025-12-31 13:42:08,651 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:42:08,948 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:42:08,950 - app.pipeline.pipeline_runner - INFO - Converted audio: 29760 samples at 16000Hz
2025-12-31 13:42:08,953 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 13:42:08,954 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 13:42:08,955 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 13:42:11,176 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 13:42:12,509 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 13:42:12,510 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 13:42:12,511 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 13:42:12,527 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 13:42:12,528 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 13:42:12,529 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 13:42:12,529 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 13:42:12,529 - app.pipeline.pipeline_runner - INFO - Processing audio for session 653cf4b3-a70b-42fc-a828-fb9d11828822, turn 433bb86d-4bf7-4431-bd29-fde8345504de
2025-12-31 13:42:12,531 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:42:12,531 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:42:12,532 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:42:12,532 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:42:12,532 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 29760 samples
2025-12-31 13:42:12,533 - app.pipeline.processors.vad_processor - INFO - VAD complete: 29760 -> 11520 samples (0.72s)
2025-12-31 13:42:12,534 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:42:12,534 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 13:42:12,535 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 13:42:22,054 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 13:42:22,054 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 13:42:22,055 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 13:42:27,249 - app.api.session_manager - INFO - Session created: d8e3a312-406c-47a2-aa7e-458b3bec64d6
2025-12-31 13:42:27,250 - app.api.routes - INFO - Session started: d8e3a312-406c-47a2-aa7e-458b3bec64d6, Turn: 821f3d45-2762-4653-aef1-5ef88a30415a, Status: SessionStatus.LISTENING
2025-12-31 13:42:27,281 - app.api.ws - INFO - WebSocket connected for session d8e3a312-406c-47a2-aa7e-458b3bec64d6. Total connections for session: 1
2025-12-31 13:42:27,289 - app.api.ws - INFO - Audio streaming started for session d8e3a312-406c-47a2-aa7e-458b3bec64d6: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:42:31,143 - app.api.ws - INFO - Audio streaming ended for session d8e3a312-406c-47a2-aa7e-458b3bec64d6
2025-12-31 13:42:31,144 - app.api.ws - INFO - Total audio received: 59566 bytes
2025-12-31 13:42:31,144 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session d8e3a312-406c-47a2-aa7e-458b3bec64d6: 59566 bytes
2025-12-31 13:42:31,147 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:42:31,422 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:42:31,424 - app.pipeline.pipeline_runner - INFO - Converted audio: 58560 samples at 16000Hz
2025-12-31 13:42:31,426 - app.pipeline.pipeline_runner - INFO - Processing audio for session d8e3a312-406c-47a2-aa7e-458b3bec64d6, turn 821f3d45-2762-4653-aef1-5ef88a30415a
2025-12-31 13:42:31,427 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:42:31,429 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:42:31,429 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:42:31,430 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:42:31,430 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 58560 samples
2025-12-31 13:42:31,432 - app.pipeline.processors.vad_processor - INFO - VAD complete: 58560 -> 17760 samples (1.11s)
2025-12-31 13:42:31,432 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:42:31,433 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 17760 samples, 1.11s
2025-12-31 13:42:31,433 - faster_whisper - INFO - Processing audio with duration 00:01.110
2025-12-31 13:42:33,077 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Oh' (1.64s, language=en, probability=1.00)
2025-12-31 13:42:33,078 - app.pipeline.voice_pipeline - INFO - Transcript: 'Oh'
2025-12-31 13:42:33,078 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:42:33,078 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Oh'
2025-12-31 13:42:33,079 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:42:33,079 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:42:33,080 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Oh'
2025-12-31 13:42:42,786 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! What do you want to know?' (9.71s)
2025-12-31 13:42:42,787 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! What do you want to know?'
2025-12-31 13:42:42,787 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:42:42,787 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! What do you want to know?'
2025-12-31 13:42:42,788 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! What do you want to know?'
2025-12-31 13:42:42,788 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! What do you want to know?'
2025-12-31 13:42:42,789 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:42:42,789 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 11361ms
2025-12-31 13:42:42,790 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:42:42,791 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Oh', reply='Sure! What do you want to know?', route=llm, time=11361ms
2025-12-31 13:42:42,882 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2025-12-31 13:42:44,884 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:42:44,887 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Sure! What do you want to know?'
2025-12-31 13:42:44,889 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:42:45,862 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2025-12-31 13:42:45,937 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\d8e3a312-406c-47a2-aa7e-458b3bec64d6\821f3d45-2762-4653-aef1-5ef88a30415a.wav (69102 bytes, ~4.32s)
2025-12-31 13:42:45,943 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\d8e3a312-406c-47a2-aa7e-458b3bec64d6\821f3d45-2762-4653-aef1-5ef88a30415a.wav
2025-12-31 13:42:45,983 - app.utils.wav_utils - ERROR - Error getting WAV duration: Not a valid WAV file
2025-12-31 13:42:46,003 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\d8e3a312-406c-47a2-aa7e-458b3bec64d6\821f3d45-2762-4653-aef1-5ef88a30415a.wav
2025-12-31 13:42:46,490 - app.pipeline.pipeline_runner - INFO - Session d8e3a312-406c-47a2-aa7e-458b3bec64d6 turn 821f3d45-2762-4653-aef1-5ef88a30415a completed successfully
2025-12-31 13:43:54,443 - app.main - INFO - ============================================================
2025-12-31 13:43:54,443 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:43:54,443 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:43:54,443 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:43:54,443 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:43:54,443 - app.main - INFO - STT Model: base.en
2025-12-31 13:43:54,444 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:43:54,444 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:43:54,444 - app.main - INFO - ============================================================
2025-12-31 13:43:54,444 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:43:54,445 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:43:54,445 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:44:24,343 - app.api.ws - ERROR - WebSocket error for session d8e3a312-406c-47a2-aa7e-458b3bec64d6: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:44:24,347 - app.api.ws - INFO - WebSocket disconnected for session d8e3a312-406c-47a2-aa7e-458b3bec64d6
2025-12-31 13:44:24,348 - app.api.ws - ERROR - WebSocket error for session 653cf4b3-a70b-42fc-a828-fb9d11828822: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 13:44:24,350 - app.api.ws - INFO - WebSocket disconnected for session 653cf4b3-a70b-42fc-a828-fb9d11828822
2025-12-31 13:44:24,454 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:44:24,454 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 13:44:37,650 - app.main - INFO - ============================================================
2025-12-31 13:44:37,650 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:44:37,650 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:44:37,651 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:44:37,651 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:44:37,651 - app.main - INFO - STT Model: base.en
2025-12-31 13:44:37,652 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:44:37,652 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:44:37,652 - app.main - INFO - ============================================================
2025-12-31 13:44:37,653 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:44:37,826 - app.api.ws - INFO - WebSocket connected for session d8e3a312-406c-47a2-aa7e-458b3bec64d6. Total connections for session: 1
2025-12-31 13:45:42,371 - app.api.session_manager - INFO - Session created: d62debc7-a0c4-4bc1-a9e1-3e80b1397725
2025-12-31 13:45:42,371 - app.api.routes - INFO - Session started: d62debc7-a0c4-4bc1-a9e1-3e80b1397725, Turn: be013878-b9ac-49e1-a40f-fe3526167f08, Status: SessionStatus.LISTENING
2025-12-31 13:45:42,416 - app.api.ws - INFO - WebSocket connected for session d62debc7-a0c4-4bc1-a9e1-3e80b1397725. Total connections for session: 1
2025-12-31 13:45:42,428 - app.api.ws - INFO - Audio streaming started for session d62debc7-a0c4-4bc1-a9e1-3e80b1397725: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:45:44,497 - app.api.ws - INFO - Audio streaming ended for session d62debc7-a0c4-4bc1-a9e1-3e80b1397725
2025-12-31 13:45:44,497 - app.api.ws - INFO - Total audio received: 32294 bytes
2025-12-31 13:45:44,498 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session d62debc7-a0c4-4bc1-a9e1-3e80b1397725: 32294 bytes
2025-12-31 13:45:44,503 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:45:44,775 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:45:44,777 - app.pipeline.pipeline_runner - INFO - Converted audio: 31680 samples at 16000Hz
2025-12-31 13:45:44,779 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 13:45:44,779 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 13:45:44,780 - app.pipeline.processors.stt_processor - INFO - Initializing STT: model=base.en, device=cpu, compute=int8
2025-12-31 13:45:46,899 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/Systran/faster-whisper-base.en/revision/main "HTTP/1.1 200 OK"
2025-12-31 13:45:48,153 - app.pipeline.processors.stt_processor - INFO - STT model loaded successfully
2025-12-31 13:45:48,154 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 13:45:48,154 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 13:45:48,172 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 13:45:48,172 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 13:45:48,173 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 13:45:48,174 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 13:45:48,174 - app.pipeline.pipeline_runner - INFO - Processing audio for session d62debc7-a0c4-4bc1-a9e1-3e80b1397725, turn be013878-b9ac-49e1-a40f-fe3526167f08
2025-12-31 13:45:48,176 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:45:48,178 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:45:48,179 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:45:48,180 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:45:48,180 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 31680 samples
2025-12-31 13:45:48,182 - app.pipeline.processors.vad_processor - INFO - VAD complete: 31680 -> 11520 samples (0.72s)
2025-12-31 13:45:48,183 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:45:48,184 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 13:45:48,187 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 13:45:50,103 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 13:45:50,104 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 13:45:50,105 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 13:45:56,960 - app.api.session_manager - INFO - Session created: 3db5c2a6-1124-4836-927e-74065cb36333
2025-12-31 13:45:56,961 - app.api.routes - INFO - Session started: 3db5c2a6-1124-4836-927e-74065cb36333, Turn: 87cfbd0d-d9d1-43ee-a434-577a00b45289, Status: SessionStatus.LISTENING
2025-12-31 13:45:57,004 - app.api.ws - INFO - WebSocket connected for session 3db5c2a6-1124-4836-927e-74065cb36333. Total connections for session: 1
2025-12-31 13:45:57,016 - app.api.ws - INFO - Audio streaming started for session 3db5c2a6-1124-4836-927e-74065cb36333: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:46:00,460 - app.api.ws - INFO - Audio streaming ended for session 3db5c2a6-1124-4836-927e-74065cb36333
2025-12-31 13:46:00,460 - app.api.ws - INFO - Total audio received: 53722 bytes
2025-12-31 13:46:00,461 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 3db5c2a6-1124-4836-927e-74065cb36333: 53722 bytes
2025-12-31 13:46:00,464 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:46:00,688 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:46:00,690 - app.pipeline.pipeline_runner - INFO - Converted audio: 52800 samples at 16000Hz
2025-12-31 13:46:00,692 - app.pipeline.pipeline_runner - INFO - Processing audio for session 3db5c2a6-1124-4836-927e-74065cb36333, turn 87cfbd0d-d9d1-43ee-a434-577a00b45289
2025-12-31 13:46:00,693 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:00,693 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:46:00,694 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:00,694 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:46:00,694 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 52800 samples
2025-12-31 13:46:00,697 - app.pipeline.processors.vad_processor - INFO - VAD complete: 52800 -> 47040 samples (2.94s)
2025-12-31 13:46:00,697 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:46:00,697 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 47040 samples, 2.94s
2025-12-31 13:46:00,698 - faster_whisper - INFO - Processing audio with duration 00:02.940
2025-12-31 13:46:02,014 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Hello hello hello hello' (1.32s, language=en, probability=1.00)
2025-12-31 13:46:02,014 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello hello hello hello'
2025-12-31 13:46:02,015 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:46:02,015 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello hello hello hello'
2025-12-31 13:46:02,015 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:46:02,016 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:46:02,016 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello hello hello hello'
2025-12-31 13:46:02,585 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! How can I help today?' (0.57s)
2025-12-31 13:46:02,585 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! How can I help today?'
2025-12-31 13:46:02,585 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:46:02,586 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! How can I help today?'
2025-12-31 13:46:02,586 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! How can I help today?'
2025-12-31 13:46:02,586 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! How can I help today?'
2025-12-31 13:46:02,587 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:02,587 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1893ms
2025-12-31 13:46:02,587 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:02,588 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello hello hello hello', reply='Hello! How can I help today?', route=llm, time=1893ms
2025-12-31 13:46:02,599 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2025-12-31 13:46:03,809 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:46:03,813 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Hello! How can I help today?'
2025-12-31 13:46:03,815 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:46:04,529 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2025-12-31 13:46:04,637 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\3db5c2a6-1124-4836-927e-74065cb36333\87cfbd0d-d9d1-43ee-a434-577a00b45289.wav (80292 bytes, ~5.02s)
2025-12-31 13:46:04,638 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\3db5c2a6-1124-4836-927e-74065cb36333\87cfbd0d-d9d1-43ee-a434-577a00b45289.wav
2025-12-31 13:46:04,663 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\3db5c2a6-1124-4836-927e-74065cb36333\87cfbd0d-d9d1-43ee-a434-577a00b45289.wav
2025-12-31 13:46:05,162 - app.pipeline.pipeline_runner - INFO - Session 3db5c2a6-1124-4836-927e-74065cb36333 turn 87cfbd0d-d9d1-43ee-a434-577a00b45289 completed successfully
2025-12-31 13:46:11,842 - app.api.session_manager - INFO - Session created: 0eab60d0-f1eb-49e2-abfc-abb3f62a5217
2025-12-31 13:46:11,842 - app.api.routes - INFO - Session started: 0eab60d0-f1eb-49e2-abfc-abb3f62a5217, Turn: cfa68c18-57b8-46b3-a411-0784dc68be16, Status: SessionStatus.LISTENING
2025-12-31 13:46:11,886 - app.api.ws - INFO - WebSocket connected for session 0eab60d0-f1eb-49e2-abfc-abb3f62a5217. Total connections for session: 1
2025-12-31 13:46:11,900 - app.api.ws - INFO - Audio streaming started for session 0eab60d0-f1eb-49e2-abfc-abb3f62a5217: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:46:15,299 - app.api.ws - INFO - Audio streaming ended for session 0eab60d0-f1eb-49e2-abfc-abb3f62a5217
2025-12-31 13:46:15,300 - app.api.ws - INFO - Total audio received: 53722 bytes
2025-12-31 13:46:15,301 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 0eab60d0-f1eb-49e2-abfc-abb3f62a5217: 53722 bytes
2025-12-31 13:46:15,303 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:46:15,595 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:46:15,597 - app.pipeline.pipeline_runner - INFO - Converted audio: 52800 samples at 16000Hz
2025-12-31 13:46:15,599 - app.pipeline.pipeline_runner - INFO - Processing audio for session 0eab60d0-f1eb-49e2-abfc-abb3f62a5217, turn cfa68c18-57b8-46b3-a411-0784dc68be16
2025-12-31 13:46:15,600 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:15,601 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:46:15,601 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:15,601 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:46:15,602 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 52800 samples
2025-12-31 13:46:15,603 - app.pipeline.processors.vad_processor - INFO - VAD complete: 52800 -> 11520 samples (0.72s)
2025-12-31 13:46:15,603 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:46:15,604 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 13:46:15,604 - faster_whisper - INFO - Processing audio with duration 00:00.720
2025-12-31 13:46:21,368 - app.pipeline.processors.stt_processor - WARNING - Transcription returned empty text
2025-12-31 13:46:21,369 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 13:46:21,369 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 13:46:23,926 - app.api.session_manager - INFO - Session created: 8cde180c-96e3-4ac3-a46b-873dab629164
2025-12-31 13:46:23,926 - app.api.routes - INFO - Session started: 8cde180c-96e3-4ac3-a46b-873dab629164, Turn: 1a1811c1-4722-4990-8e2d-6018fc6fa7d4, Status: SessionStatus.LISTENING
2025-12-31 13:46:23,935 - app.api.ws - INFO - WebSocket connected for session 8cde180c-96e3-4ac3-a46b-873dab629164. Total connections for session: 1
2025-12-31 13:46:23,944 - app.api.ws - INFO - Audio streaming started for session 8cde180c-96e3-4ac3-a46b-873dab629164: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:46:30,221 - app.api.ws - INFO - Audio streaming ended for session 8cde180c-96e3-4ac3-a46b-873dab629164
2025-12-31 13:46:30,221 - app.api.ws - INFO - Total audio received: 100474 bytes
2025-12-31 13:46:30,222 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 8cde180c-96e3-4ac3-a46b-873dab629164: 100474 bytes
2025-12-31 13:46:30,228 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:46:30,521 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:46:30,523 - app.pipeline.pipeline_runner - INFO - Converted audio: 98880 samples at 16000Hz
2025-12-31 13:46:30,525 - app.pipeline.pipeline_runner - INFO - Processing audio for session 8cde180c-96e3-4ac3-a46b-873dab629164, turn 1a1811c1-4722-4990-8e2d-6018fc6fa7d4
2025-12-31 13:46:30,526 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:30,527 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:46:30,527 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:30,527 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:46:30,528 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 98880 samples
2025-12-31 13:46:30,530 - app.pipeline.processors.vad_processor - INFO - VAD complete: 98880 -> 40800 samples (2.55s)
2025-12-31 13:46:30,531 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:46:30,531 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 40800 samples, 2.55s
2025-12-31 13:46:30,532 - faster_whisper - INFO - Processing audio with duration 00:02.550
2025-12-31 13:46:32,291 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'You please tell me a joke' (1.76s, language=en, probability=1.00)
2025-12-31 13:46:32,292 - app.pipeline.voice_pipeline - INFO - Transcript: 'You please tell me a joke'
2025-12-31 13:46:32,292 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:46:32,293 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'You please tell me a joke'
2025-12-31 13:46:32,293 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:46:32,293 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:46:32,294 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'You please tell me a joke'
2025-12-31 13:46:33,112 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Sure! Why did the tomato turn red? Because it saw the salad dressing!' (0.82s)
2025-12-31 13:46:33,113 - app.pipeline.voice_pipeline - INFO - LLM response: 'Sure! Why did the tomato turn red? Because it saw the salad dressing!'
2025-12-31 13:46:33,113 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:46:33,114 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Sure! Why did the tomato turn red? Because it saw the salad dressing!'
2025-12-31 13:46:33,114 - app.pipeline.processors.response_shaper - INFO - Truncated to 2 sentences
2025-12-31 13:46:33,114 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Sure! Why did the tomato turn red?'
2025-12-31 13:46:33,115 - app.pipeline.voice_pipeline - INFO - Final reply: 'Sure! Why did the tomato turn red?'
2025-12-31 13:46:33,115 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:33,115 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2588ms
2025-12-31 13:46:33,116 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:33,116 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='You please tell me a joke', reply='Sure! Why did the tomato turn red?', route=llm, time=2588ms
2025-12-31 13:46:33,119 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2025-12-31 13:46:34,213 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:46:34,215 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Sure! Why did the tomato turn red?'
2025-12-31 13:46:34,217 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:46:34,929 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2025-12-31 13:46:34,996 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\8cde180c-96e3-4ac3-a46b-873dab629164\1a1811c1-4722-4990-8e2d-6018fc6fa7d4.wav (100354 bytes, ~6.27s)
2025-12-31 13:46:34,999 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\8cde180c-96e3-4ac3-a46b-873dab629164\1a1811c1-4722-4990-8e2d-6018fc6fa7d4.wav
2025-12-31 13:46:35,022 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\8cde180c-96e3-4ac3-a46b-873dab629164\1a1811c1-4722-4990-8e2d-6018fc6fa7d4.wav
2025-12-31 13:46:35,528 - app.pipeline.pipeline_runner - INFO - Session 8cde180c-96e3-4ac3-a46b-873dab629164 turn 1a1811c1-4722-4990-8e2d-6018fc6fa7d4 completed successfully
2025-12-31 13:46:39,505 - app.api.session_manager - INFO - Session created: dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4
2025-12-31 13:46:39,506 - app.api.routes - INFO - Session started: dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4, Turn: 8eda68ca-669d-49c2-824e-acb42b45769a, Status: SessionStatus.LISTENING
2025-12-31 13:46:39,527 - app.api.ws - INFO - WebSocket connected for session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4. Total connections for session: 1
2025-12-31 13:46:39,534 - app.api.ws - INFO - Audio streaming started for session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:46:42,942 - app.api.ws - INFO - Audio streaming ended for session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4
2025-12-31 13:46:42,943 - app.api.ws - INFO - Total audio received: 53722 bytes
2025-12-31 13:46:42,944 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4: 53722 bytes
2025-12-31 13:46:42,946 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:46:43,156 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:46:43,158 - app.pipeline.pipeline_runner - INFO - Converted audio: 52800 samples at 16000Hz
2025-12-31 13:46:43,162 - app.pipeline.pipeline_runner - INFO - Processing audio for session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4, turn 8eda68ca-669d-49c2-824e-acb42b45769a
2025-12-31 13:46:43,163 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:43,163 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:46:43,164 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:43,165 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:46:43,166 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 52800 samples
2025-12-31 13:46:43,170 - app.pipeline.processors.vad_processor - INFO - VAD complete: 52800 -> 16800 samples (1.05s)
2025-12-31 13:46:43,171 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:46:43,174 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 16800 samples, 1.05s
2025-12-31 13:46:43,179 - faster_whisper - INFO - Processing audio with duration 00:01.050
2025-12-31 13:46:45,117 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'Wow' (1.94s, language=en, probability=1.00)
2025-12-31 13:46:45,117 - app.pipeline.voice_pipeline - INFO - Transcript: 'Wow'
2025-12-31 13:46:45,118 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:46:45,119 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Wow'
2025-12-31 13:46:45,119 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:46:45,120 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:46:45,120 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Wow'
2025-12-31 13:46:45,758 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'You're very smart!' (0.64s)
2025-12-31 13:46:45,759 - app.pipeline.voice_pipeline - INFO - LLM response: 'You're very smart!'
2025-12-31 13:46:45,760 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:46:45,760 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'You're very smart!'
2025-12-31 13:46:45,761 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'You're very smart!'
2025-12-31 13:46:45,761 - app.pipeline.voice_pipeline - INFO - Final reply: 'You're very smart!'
2025-12-31 13:46:45,762 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:45,762 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2599ms
2025-12-31 13:46:45,762 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:45,763 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Wow', reply='You're very smart!', route=llm, time=2599ms
2025-12-31 13:46:45,765 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2025-12-31 13:46:46,772 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:46:46,775 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'You're very smart!'
2025-12-31 13:46:46,777 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:46:47,345 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2025-12-31 13:46:47,387 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4\8eda68ca-669d-49c2-824e-acb42b45769a.wav (53544 bytes, ~3.35s)
2025-12-31 13:46:47,388 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4\8eda68ca-669d-49c2-824e-acb42b45769a.wav
2025-12-31 13:46:47,416 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4\8eda68ca-669d-49c2-824e-acb42b45769a.wav
2025-12-31 13:46:47,924 - app.pipeline.pipeline_runner - INFO - Session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4 turn 8eda68ca-669d-49c2-824e-acb42b45769a completed successfully
2025-12-31 13:46:53,445 - app.api.session_manager - INFO - Session created: 68a4261a-c995-447d-9901-c08ee7ea0716
2025-12-31 13:46:53,446 - app.api.routes - INFO - Session started: 68a4261a-c995-447d-9901-c08ee7ea0716, Turn: 60d1e286-c290-4adf-bdbd-b6d62164ab85, Status: SessionStatus.LISTENING
2025-12-31 13:46:53,466 - app.api.ws - INFO - WebSocket connected for session 68a4261a-c995-447d-9901-c08ee7ea0716. Total connections for session: 1
2025-12-31 13:46:53,471 - app.api.ws - INFO - Audio streaming started for session 68a4261a-c995-447d-9901-c08ee7ea0716: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 13:46:56,438 - app.api.ws - INFO - Audio streaming ended for session 68a4261a-c995-447d-9901-c08ee7ea0716
2025-12-31 13:46:56,438 - app.api.ws - INFO - Total audio received: 45930 bytes
2025-12-31 13:46:56,438 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 68a4261a-c995-447d-9901-c08ee7ea0716: 45930 bytes
2025-12-31 13:46:56,441 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 13:46:56,633 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 13:46:56,635 - app.pipeline.pipeline_runner - INFO - Converted audio: 45120 samples at 16000Hz
2025-12-31 13:46:56,636 - app.pipeline.pipeline_runner - INFO - Processing audio for session 68a4261a-c995-447d-9901-c08ee7ea0716, turn 60d1e286-c290-4adf-bdbd-b6d62164ab85
2025-12-31 13:46:56,637 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:56,637 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 13:46:56,637 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:56,637 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 13:46:56,638 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 45120 samples
2025-12-31 13:46:56,639 - app.pipeline.processors.vad_processor - INFO - VAD complete: 45120 -> 38400 samples (2.40s)
2025-12-31 13:46:56,640 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 13:46:56,640 - app.pipeline.processors.stt_processor - INFO - Transcribing audio: 38400 samples, 2.40s
2025-12-31 13:46:56,640 - faster_whisper - INFO - Processing audio with duration 00:02.400
2025-12-31 13:46:58,110 - app.pipeline.processors.stt_processor - INFO - Transcription complete: 'It's in the waterbait this day.' (1.47s, language=en, probability=1.00)
2025-12-31 13:46:58,111 - app.pipeline.voice_pipeline - INFO - Transcript: 'It's in the waterbait this day.'
2025-12-31 13:46:58,111 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 13:46:58,112 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'It's in the waterbait this day.'
2025-12-31 13:46:58,112 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2025-12-31 13:46:58,112 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2025-12-31 13:46:58,113 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'It's in the waterbait this day.'
2025-12-31 13:46:58,912 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm fishing with my bait in the lake today.' (0.80s)
2025-12-31 13:46:58,913 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm fishing with my bait in the lake today.'
2025-12-31 13:46:58,913 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2025-12-31 13:46:58,913 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm fishing with my bait in the lake today.'
2025-12-31 13:46:58,914 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm fishing with my bait in the lake today.'
2025-12-31 13:46:58,914 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm fishing with my bait in the lake today.'
2025-12-31 13:46:58,914 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:58,915 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 2277ms
2025-12-31 13:46:58,915 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 13:46:58,915 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='It's in the waterbait this day.', reply='I'm fishing with my bait in the lake today.', route=llm, time=2277ms
2025-12-31 13:46:58,917 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2025-12-31 13:46:59,853 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2025-12-31 13:46:59,857 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'I'm fishing with my bait in the lake today.'
2025-12-31 13:46:59,860 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2025-12-31 13:47:00,590 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2025-12-31 13:47:00,652 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\68a4261a-c995-447d-9901-c08ee7ea0716\60d1e286-c290-4adf-bdbd-b6d62164ab85.wav (102584 bytes, ~6.41s)
2025-12-31 13:47:00,653 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\68a4261a-c995-447d-9901-c08ee7ea0716\60d1e286-c290-4adf-bdbd-b6d62164ab85.wav
2025-12-31 13:47:00,674 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\68a4261a-c995-447d-9901-c08ee7ea0716\60d1e286-c290-4adf-bdbd-b6d62164ab85.wav
2025-12-31 13:47:01,180 - app.pipeline.pipeline_runner - INFO - Session 68a4261a-c995-447d-9901-c08ee7ea0716 turn 60d1e286-c290-4adf-bdbd-b6d62164ab85 completed successfully
2025-12-31 13:51:37,701 - app.api.session_manager - INFO - Cleaning up expired session: d62debc7-a0c4-4bc1-a9e1-3e80b1397725
2025-12-31 13:51:37,702 - app.api.session_manager - INFO - Session deleted: d62debc7-a0c4-4bc1-a9e1-3e80b1397725
2025-12-31 13:51:37,702 - app.api.session_manager - INFO - Cleaning up expired session: 3db5c2a6-1124-4836-927e-74065cb36333
2025-12-31 13:51:37,702 - app.api.session_manager - INFO - Session deleted: 3db5c2a6-1124-4836-927e-74065cb36333
2025-12-31 13:51:37,702 - app.api.session_manager - INFO - Cleaning up expired session: 0eab60d0-f1eb-49e2-abfc-abb3f62a5217
2025-12-31 13:51:37,703 - app.api.session_manager - INFO - Session deleted: 0eab60d0-f1eb-49e2-abfc-abb3f62a5217
2025-12-31 13:51:37,703 - app.api.session_manager - INFO - Cleaning up expired session: 8cde180c-96e3-4ac3-a46b-873dab629164
2025-12-31 13:51:37,703 - app.api.session_manager - INFO - Session deleted: 8cde180c-96e3-4ac3-a46b-873dab629164
2025-12-31 13:52:37,711 - app.api.session_manager - INFO - Cleaning up expired session: dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4
2025-12-31 13:52:37,711 - app.api.session_manager - INFO - Session deleted: dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4
2025-12-31 13:52:37,712 - app.api.session_manager - INFO - Cleaning up expired session: 68a4261a-c995-447d-9901-c08ee7ea0716
2025-12-31 13:52:37,712 - app.api.session_manager - INFO - Session deleted: 68a4261a-c995-447d-9901-c08ee7ea0716
2025-12-31 13:57:33,510 - app.main - INFO - ============================================================
2025-12-31 13:57:33,510 - app.main - INFO - Voice Agent Service starting...
2025-12-31 13:57:33,510 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 13:57:33,510 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 13:57:33,511 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 13:57:33,511 - app.main - INFO - STT Model: base.en
2025-12-31 13:57:33,511 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 13:57:33,511 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 13:57:33,511 - app.main - INFO - ============================================================
2025-12-31 13:57:33,511 - app.api.session_manager - INFO - Session Manager started
2025-12-31 13:57:33,513 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 13:57:33,513 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 14:01:33,675 - app.api.ws - ERROR - WebSocket error for session 3db5c2a6-1124-4836-927e-74065cb36333: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:01:33,678 - app.api.ws - INFO - WebSocket disconnected for session 3db5c2a6-1124-4836-927e-74065cb36333
2025-12-31 14:01:33,678 - app.api.ws - ERROR - WebSocket error for session d8e3a312-406c-47a2-aa7e-458b3bec64d6: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:01:33,680 - app.api.ws - INFO - WebSocket disconnected for session d8e3a312-406c-47a2-aa7e-458b3bec64d6
2025-12-31 14:01:33,680 - app.api.ws - ERROR - WebSocket error for session 0eab60d0-f1eb-49e2-abfc-abb3f62a5217: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:01:33,682 - app.api.ws - INFO - WebSocket disconnected for session 0eab60d0-f1eb-49e2-abfc-abb3f62a5217
2025-12-31 14:01:33,683 - app.api.ws - ERROR - WebSocket error for session 8cde180c-96e3-4ac3-a46b-873dab629164: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:01:33,685 - app.api.ws - INFO - WebSocket disconnected for session 8cde180c-96e3-4ac3-a46b-873dab629164
2025-12-31 14:01:33,685 - app.api.ws - ERROR - WebSocket error for session 68a4261a-c995-447d-9901-c08ee7ea0716: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:01:33,690 - app.api.ws - INFO - WebSocket disconnected for session 68a4261a-c995-447d-9901-c08ee7ea0716
2025-12-31 14:01:33,690 - app.api.ws - ERROR - WebSocket error for session d62debc7-a0c4-4bc1-a9e1-3e80b1397725: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:01:33,693 - app.api.ws - INFO - WebSocket disconnected for session d62debc7-a0c4-4bc1-a9e1-3e80b1397725
2025-12-31 14:01:33,694 - app.api.ws - ERROR - WebSocket error for session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:01:33,696 - app.api.ws - INFO - WebSocket disconnected for session dbf7280f-8a8b-4a0a-bd64-8f4ca4bbd3a4
2025-12-31 14:01:33,781 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 14:01:33,781 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 14:01:40,223 - app.main - INFO - ============================================================
2025-12-31 14:01:40,224 - app.main - INFO - Voice Agent Service starting...
2025-12-31 14:01:40,224 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 14:01:40,224 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 14:01:40,224 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 14:01:40,225 - app.main - INFO - STT Model: base.en
2025-12-31 14:01:40,225 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 14:01:40,225 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 14:01:40,225 - app.main - INFO - ============================================================
2025-12-31 14:01:40,226 - app.api.session_manager - INFO - Session Manager started
2025-12-31 14:01:50,531 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 14:01:52,448 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 14:01:53,763 - app.api.session_manager - INFO - Session created: 07ff3753-0172-48af-992f-58d66073922b
2025-12-31 14:01:53,764 - app.api.routes - INFO - Session started: 07ff3753-0172-48af-992f-58d66073922b, Turn: 1d6781fe-8e8a-44c7-a774-658d10103199, Status: SessionStatus.LISTENING
2025-12-31 14:01:53,778 - app.api.ws - INFO - WebSocket connected for session 07ff3753-0172-48af-992f-58d66073922b. Total connections for session: 1
2025-12-31 14:01:53,786 - app.api.ws - INFO - Audio streaming started for session 07ff3753-0172-48af-992f-58d66073922b: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 14:01:55,868 - app.api.ws - INFO - Audio streaming ended for session 07ff3753-0172-48af-992f-58d66073922b
2025-12-31 14:01:55,869 - app.api.ws - INFO - Total audio received: 32294 bytes
2025-12-31 14:01:55,869 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 07ff3753-0172-48af-992f-58d66073922b: 32294 bytes
2025-12-31 14:01:55,875 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 14:01:56,084 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 14:01:56,086 - app.pipeline.pipeline_runner - INFO - Converted audio: 31680 samples at 16000Hz
2025-12-31 14:01:56,088 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 14:01:56,089 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 14:01:56,089 - app.pipeline.processors.stt_openai - INFO - Initializing OpenAI Whisper STT processor
2025-12-31 14:01:58,641 - app.pipeline.processors.stt_openai - INFO - OpenAI Whisper processor initialized: model=whisper-1, language=en
2025-12-31 14:01:58,642 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 14:01:58,642 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 14:01:58,653 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 14:01:58,654 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 14:01:58,654 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 14:01:58,655 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 14:01:58,656 - app.pipeline.pipeline_runner - INFO - Processing audio for session 07ff3753-0172-48af-992f-58d66073922b, turn 1d6781fe-8e8a-44c7-a774-658d10103199
2025-12-31 14:01:58,658 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:01:58,658 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 14:01:58,659 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:01:58,659 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 14:01:58,660 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 31680 samples
2025-12-31 14:01:58,661 - app.pipeline.processors.vad_processor - INFO - VAD complete: 31680 -> 11520 samples (0.72s)
2025-12-31 14:01:58,661 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 14:01:58,662 - app.pipeline.processors.stt_openai - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 14:02:00,525 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:02:00,526 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.391384 seconds
2025-12-31 14:02:01,423 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:02:01,424 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.864432 seconds
2025-12-31 14:02:02,885 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:02:02,886 - app.pipeline.processors.stt_openai - ERROR - Error during transcription: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\stt_openai.py", line 80, in transcribe
    transcript = self.client.audio.transcriptions.create(
        model=self.model,
        file=audio_file,
        language=self.language
    )
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\resources\audio\transcriptions.py", line 472, in create
    return self._post(  # type: ignore[return-value]
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        "/audio/transcriptions",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<12 lines>...
        stream_cls=Stream[TranscriptionStreamEvent],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-12-31 14:02:02,892 - app.pipeline.processors.stt_openai - ERROR - OpenAI quota exceeded. You may need to add credits or upgrade your plan.
2025-12-31 14:02:02,893 - app.pipeline.voice_pipeline - INFO - Transcript: '(None, 4.224264860153198)'
2025-12-31 14:02:02,893 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2025-12-31 14:02:02,893 - app.pipeline.processors.skills_router - INFO - Routing transcript: '(None, 4.224264860153198)'
2025-12-31 14:02:02,894 - app.pipeline.voice_pipeline - ERROR - Pipeline error: 'tuple' object has no attribute 'lower'
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\voice_pipeline.py", line 99, in process
    route, math_response = self.skills_router.route(transcript)
                           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\skills_router.py", line 40, in route
    if is_math_query(transcript):
       ~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\utils\text_math.py", line 101, in is_math_query
    text = text.lower()
           ^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'lower'
2025-12-31 14:02:02,899 - app.pipeline.pipeline_runner - ERROR - Pipeline error: 'tuple' object has no attribute 'lower'
2025-12-31 14:06:39,957 - app.main - INFO - ============================================================
2025-12-31 14:06:39,957 - app.main - INFO - Voice Agent Service starting...
2025-12-31 14:06:39,957 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 14:06:39,957 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 14:06:39,958 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 14:06:39,958 - app.main - INFO - STT Model: base.en
2025-12-31 14:06:39,958 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 14:06:39,958 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 14:06:39,958 - app.main - INFO - ============================================================
2025-12-31 14:06:39,958 - app.api.session_manager - INFO - Session Manager started
2025-12-31 14:06:39,959 - app.main - INFO - Voice Agent Service shutting down...
2025-12-31 14:06:39,959 - app.api.session_manager - INFO - Session Manager stopped
2025-12-31 14:07:07,478 - app.main - INFO - ============================================================
2025-12-31 14:07:07,478 - app.main - INFO - Voice Agent Service starting...
2025-12-31 14:07:07,478 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 14:07:07,478 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 14:07:07,478 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 14:07:07,478 - app.main - INFO - STT Model: base.en
2025-12-31 14:07:07,478 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 14:07:07,478 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 14:07:07,478 - app.main - INFO - ============================================================
2025-12-31 14:07:07,478 - app.api.session_manager - INFO - Session Manager started
2025-12-31 14:07:09,325 - app.api.ws - INFO - WebSocket connected for session 07ff3753-0172-48af-992f-58d66073922b. Total connections for session: 1
2025-12-31 14:07:58,873 - app.api.ws - ERROR - WebSocket error for session 07ff3753-0172-48af-992f-58d66073922b: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2025-12-31 14:07:58,878 - app.api.ws - INFO - WebSocket disconnected for session 07ff3753-0172-48af-992f-58d66073922b
2025-12-31 14:08:00,482 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 14:08:02,029 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 14:08:02,926 - app.api.session_manager - INFO - Session created: 427cbedf-6326-45c7-96b4-b59592ac61aa
2025-12-31 14:08:02,926 - app.api.routes - INFO - Session started: 427cbedf-6326-45c7-96b4-b59592ac61aa, Turn: 780a30f2-9214-4172-9e2d-4c575fb1da55, Status: SessionStatus.LISTENING
2025-12-31 14:08:02,933 - app.api.ws - INFO - WebSocket connected for session 427cbedf-6326-45c7-96b4-b59592ac61aa. Total connections for session: 1
2025-12-31 14:08:02,939 - app.api.ws - INFO - Audio streaming started for session 427cbedf-6326-45c7-96b4-b59592ac61aa: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 14:08:27,299 - app.main - INFO - ============================================================
2025-12-31 14:08:27,299 - app.main - INFO - Voice Agent Service starting...
2025-12-31 14:08:27,299 - app.main - INFO - Service URL: http://127.0.0.1:8008
2025-12-31 14:08:27,299 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2025-12-31 14:08:27,299 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2025-12-31 14:08:27,300 - app.main - INFO - STT Model: base.en
2025-12-31 14:08:27,300 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2025-12-31 14:08:27,300 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2025-12-31 14:08:27,300 - app.main - INFO - ============================================================
2025-12-31 14:08:27,300 - app.api.session_manager - INFO - Session Manager started
2025-12-31 14:09:05,589 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 14:09:07,264 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-12-31 14:09:08,668 - app.api.session_manager - INFO - Session created: 7974b50b-5cc5-4cae-89ca-716a24705c0e
2025-12-31 14:09:08,668 - app.api.routes - INFO - Session started: 7974b50b-5cc5-4cae-89ca-716a24705c0e, Turn: b6571e8f-43de-4df3-9e3d-9f55518a61ec, Status: SessionStatus.LISTENING
2025-12-31 14:09:08,686 - app.api.ws - INFO - WebSocket connected for session 7974b50b-5cc5-4cae-89ca-716a24705c0e. Total connections for session: 1
2025-12-31 14:09:08,694 - app.api.ws - INFO - Audio streaming started for session 7974b50b-5cc5-4cae-89ca-716a24705c0e: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 14:09:10,935 - app.api.ws - INFO - Audio streaming ended for session 7974b50b-5cc5-4cae-89ca-716a24705c0e
2025-12-31 14:09:10,935 - app.api.ws - INFO - Total audio received: 34242 bytes
2025-12-31 14:09:10,936 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 7974b50b-5cc5-4cae-89ca-716a24705c0e: 34242 bytes
2025-12-31 14:09:10,941 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 14:09:11,153 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 14:09:11,155 - app.pipeline.pipeline_runner - INFO - Converted audio: 33600 samples at 16000Hz
2025-12-31 14:09:11,158 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2025-12-31 14:09:11,158 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2025-12-31 14:09:11,158 - app.pipeline.processors.stt_openai - INFO - Initializing OpenAI Whisper STT processor
2025-12-31 14:09:13,466 - app.pipeline.processors.stt_openai - INFO - OpenAI Whisper processor initialized: model=whisper-1, language=en
2025-12-31 14:09:13,466 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2025-12-31 14:09:13,466 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2025-12-31 14:09:13,478 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2025-12-31 14:09:13,478 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2025-12-31 14:09:13,478 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2025-12-31 14:09:13,479 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2025-12-31 14:09:13,479 - app.pipeline.pipeline_runner - INFO - Processing audio for session 7974b50b-5cc5-4cae-89ca-716a24705c0e, turn b6571e8f-43de-4df3-9e3d-9f55518a61ec
2025-12-31 14:09:13,480 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:09:13,480 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 14:09:13,480 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:09:13,480 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 14:09:13,480 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 33600 samples
2025-12-31 14:09:13,481 - app.pipeline.processors.vad_processor - INFO - VAD complete: 33600 -> 11520 samples (0.72s)
2025-12-31 14:09:13,481 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 14:09:13,482 - app.pipeline.processors.stt_openai - INFO - Transcribing audio: 11520 samples, 0.72s
2025-12-31 14:09:15,237 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:15,237 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.466579 seconds
2025-12-31 14:09:16,240 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:16,240 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.831817 seconds
2025-12-31 14:09:17,175 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:17,176 - app.pipeline.processors.stt_openai - ERROR - Error during transcription: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\stt_openai.py", line 80, in transcribe
    transcript = self.client.audio.transcriptions.create(
        model=self.model,
        file=audio_file,
        language=self.language
    )
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\resources\audio\transcriptions.py", line 472, in create
    return self._post(  # type: ignore[return-value]
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        "/audio/transcriptions",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<12 lines>...
        stream_cls=Stream[TranscriptionStreamEvent],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-12-31 14:09:17,182 - app.pipeline.processors.stt_openai - ERROR - OpenAI quota exceeded. You may need to add credits or upgrade your plan.
2025-12-31 14:09:17,182 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 14:09:17,183 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 14:09:20,211 - app.api.session_manager - INFO - Session created: 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6
2025-12-31 14:09:20,211 - app.api.routes - INFO - Session started: 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6, Turn: 6a69c3f4-5ffd-4ea5-8a18-18d7337d4142, Status: SessionStatus.LISTENING
2025-12-31 14:09:20,229 - app.api.ws - INFO - WebSocket connected for session 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6. Total connections for session: 1
2025-12-31 14:09:20,234 - app.api.ws - INFO - Audio streaming started for session 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 14:09:23,299 - app.api.ws - INFO - Audio streaming ended for session 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6
2025-12-31 14:09:23,299 - app.api.ws - INFO - Total audio received: 47878 bytes
2025-12-31 14:09:23,300 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6: 47878 bytes
2025-12-31 14:09:23,302 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 14:09:23,482 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 14:09:23,484 - app.pipeline.pipeline_runner - INFO - Converted audio: 47040 samples at 16000Hz
2025-12-31 14:09:23,485 - app.pipeline.pipeline_runner - INFO - Processing audio for session 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6, turn 6a69c3f4-5ffd-4ea5-8a18-18d7337d4142
2025-12-31 14:09:23,486 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:09:23,486 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 14:09:23,486 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:09:23,486 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 14:09:23,487 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 47040 samples
2025-12-31 14:09:23,488 - app.pipeline.processors.vad_processor - INFO - VAD complete: 47040 -> 37440 samples (2.34s)
2025-12-31 14:09:23,489 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 14:09:23,489 - app.pipeline.processors.stt_openai - INFO - Transcribing audio: 37440 samples, 2.34s
2025-12-31 14:09:24,243 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:24,244 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.450509 seconds
2025-12-31 14:09:24,808 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:24,808 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.786997 seconds
2025-12-31 14:09:26,187 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:26,188 - app.pipeline.processors.stt_openai - ERROR - Error during transcription: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\stt_openai.py", line 80, in transcribe
    transcript = self.client.audio.transcriptions.create(
        model=self.model,
        file=audio_file,
        language=self.language
    )
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\resources\audio\transcriptions.py", line 472, in create
    return self._post(  # type: ignore[return-value]
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        "/audio/transcriptions",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<12 lines>...
        stream_cls=Stream[TranscriptionStreamEvent],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-12-31 14:09:26,192 - app.pipeline.processors.stt_openai - ERROR - OpenAI quota exceeded. You may need to add credits or upgrade your plan.
2025-12-31 14:09:26,192 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 14:09:26,193 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 14:09:41,048 - app.api.session_manager - INFO - Session created: cd6017b6-6dd1-40df-a64e-3350d20aaf2a
2025-12-31 14:09:41,049 - app.api.routes - INFO - Session started: cd6017b6-6dd1-40df-a64e-3350d20aaf2a, Turn: b50825b3-98d5-4dcc-bdc5-ab294a58cc89, Status: SessionStatus.LISTENING
2025-12-31 14:09:41,068 - app.api.ws - INFO - WebSocket connected for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a. Total connections for session: 1
2025-12-31 14:09:41,073 - app.api.ws - INFO - Audio streaming started for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2025-12-31 14:09:43,708 - app.api.ws - INFO - Audio streaming ended for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a
2025-12-31 14:09:43,709 - app.api.ws - INFO - Total audio received: 40086 bytes
2025-12-31 14:09:43,709 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a: 40086 bytes
2025-12-31 14:09:43,711 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2025-12-31 14:09:43,877 - app.pipeline.pipeline_runner - INFO - Conversion complete
2025-12-31 14:09:43,878 - app.pipeline.pipeline_runner - INFO - Converted audio: 39360 samples at 16000Hz
2025-12-31 14:09:43,880 - app.pipeline.pipeline_runner - INFO - Processing audio for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a, turn b50825b3-98d5-4dcc-bdc5-ab294a58cc89
2025-12-31 14:09:43,880 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:09:43,880 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2025-12-31 14:09:43,881 - app.pipeline.voice_pipeline - INFO - ============================================================
2025-12-31 14:09:43,881 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2025-12-31 14:09:43,881 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 39360 samples
2025-12-31 14:09:43,882 - app.pipeline.processors.vad_processor - INFO - VAD complete: 39360 -> 17280 samples (1.08s)
2025-12-31 14:09:43,882 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2025-12-31 14:09:43,882 - app.pipeline.processors.stt_openai - INFO - Transcribing audio: 17280 samples, 1.08s
2025-12-31 14:09:44,068 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:44,068 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.488190 seconds
2025-12-31 14:09:44,686 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:44,687 - openai._base_client - INFO - Retrying request to /audio/transcriptions in 0.910694 seconds
2025-12-31 14:09:45,752 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/transcriptions "HTTP/1.1 429 Too Many Requests"
2025-12-31 14:09:45,753 - app.pipeline.processors.stt_openai - ERROR - Error during transcription: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\pipeline\processors\stt_openai.py", line 80, in transcribe
    transcript = self.client.audio.transcriptions.create(
        model=self.model,
        file=audio_file,
        language=self.language
    )
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\resources\audio\transcriptions.py", line 472, in create
    return self._post(  # type: ignore[return-value]
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        "/audio/transcriptions",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<12 lines>...
        stream_cls=Stream[TranscriptionStreamEvent],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-12-31 14:09:45,757 - app.pipeline.processors.stt_openai - ERROR - OpenAI quota exceeded. You may need to add credits or upgrade your plan.
2025-12-31 14:09:45,757 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2025-12-31 14:09:45,757 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2025-12-31 14:14:27,361 - app.api.session_manager - INFO - Cleaning up expired session: 7974b50b-5cc5-4cae-89ca-716a24705c0e
2025-12-31 14:14:27,361 - app.api.session_manager - INFO - Session deleted: 7974b50b-5cc5-4cae-89ca-716a24705c0e
2025-12-31 14:14:27,361 - app.api.session_manager - INFO - Cleaning up expired session: 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6
2025-12-31 14:14:27,361 - app.api.session_manager - INFO - Session deleted: 8cc1b17b-82c3-42d3-bcea-b45eb17fbfc6
2025-12-31 14:15:27,368 - app.api.session_manager - INFO - Cleaning up expired session: cd6017b6-6dd1-40df-a64e-3350d20aaf2a
2025-12-31 14:15:27,369 - app.api.session_manager - INFO - Session deleted: cd6017b6-6dd1-40df-a64e-3350d20aaf2a
2026-01-01 13:22:57,839 - app.main - INFO - ============================================================
2026-01-01 13:22:57,839 - app.main - INFO - Voice Agent Service starting...
2026-01-01 13:22:57,840 - app.main - INFO - Service URL: http://127.0.0.1:8008
2026-01-01 13:22:57,840 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2026-01-01 13:22:57,840 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2026-01-01 13:22:57,840 - app.main - INFO - STT Model: base.en
2026-01-01 13:22:57,840 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2026-01-01 13:22:57,841 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2026-01-01 13:22:57,841 - app.main - INFO - ============================================================
2026-01-01 13:22:57,841 - app.api.session_manager - INFO - Session Manager started
2026-01-01 13:22:59,355 - app.api.ws - INFO - WebSocket connected for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a. Total connections for session: 1
2026-01-01 15:05:17,425 - app.api.ws - ERROR - WebSocket error for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2026-01-01 15:05:17,480 - app.api.ws - INFO - WebSocket disconnected for session cd6017b6-6dd1-40df-a64e-3350d20aaf2a
2026-01-01 15:05:19,395 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2026-01-01 15:05:25,248 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2026-01-01 15:05:26,688 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2026-01-01 15:05:27,696 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2026-01-01 15:08:14,333 - app.api.session_manager - INFO - Session created: 40f9a2a6-ff1c-435f-8896-3db68ad6fe46
2026-01-01 15:08:14,363 - app.api.routes - INFO - Session started: 40f9a2a6-ff1c-435f-8896-3db68ad6fe46, Turn: 9a874e88-2d15-4103-af32-8e20aa1ab4db, Status: SessionStatus.LISTENING
2026-01-01 15:08:14,623 - app.api.ws - INFO - WebSocket connected for session 40f9a2a6-ff1c-435f-8896-3db68ad6fe46. Total connections for session: 1
2026-01-01 15:08:14,685 - app.api.ws - INFO - Audio streaming started for session 40f9a2a6-ff1c-435f-8896-3db68ad6fe46: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2026-01-01 15:08:16,579 - app.api.ws - INFO - Audio streaming ended for session 40f9a2a6-ff1c-435f-8896-3db68ad6fe46
2026-01-01 15:08:16,580 - app.api.ws - INFO - Total audio received: 28398 bytes
2026-01-01 15:08:16,598 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 40f9a2a6-ff1c-435f-8896-3db68ad6fe46: 28398 bytes
2026-01-01 15:08:16,649 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2026-01-01 15:08:20,321 - app.pipeline.pipeline_runner - INFO - Conversion complete
2026-01-01 15:08:20,349 - app.pipeline.pipeline_runner - INFO - Converted audio: 27840 samples at 16000Hz
2026-01-01 15:08:20,352 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2026-01-01 15:08:20,358 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2026-01-01 15:08:20,359 - app.pipeline.processors.stt_elevenlabs - INFO - Initializing ElevenLabs STT processor
2026-01-01 15:08:22,461 - app.pipeline.processors.stt_elevenlabs - INFO - ElevenLabs STT processor initialized: model=scribe_v1, language=en
2026-01-01 15:08:22,462 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2026-01-01 15:08:22,462 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2026-01-01 15:08:22,581 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2026-01-01 15:08:22,582 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2026-01-01 15:08:22,582 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2026-01-01 15:08:22,583 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2026-01-01 15:08:22,583 - app.pipeline.pipeline_runner - INFO - Processing audio for session 40f9a2a6-ff1c-435f-8896-3db68ad6fe46, turn 9a874e88-2d15-4103-af32-8e20aa1ab4db
2026-01-01 15:08:22,584 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:08:22,584 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2026-01-01 15:08:22,585 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:08:22,585 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2026-01-01 15:08:22,586 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 27840 samples
2026-01-01 15:08:22,596 - app.pipeline.processors.vad_processor - INFO - VAD complete: 27840 -> 16320 samples (1.02s)
2026-01-01 15:08:22,596 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2026-01-01 15:08:22,597 - app.pipeline.processors.stt_elevenlabs - INFO - Transcribing audio: 16320 samples, 1.02s
2026-01-01 15:08:24,043 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/speech-to-text "HTTP/1.1 200 OK"
2026-01-01 15:08:24,047 - app.pipeline.processors.stt_elevenlabs - WARNING - Transcription returned empty text
2026-01-01 15:08:24,047 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2026-01-01 15:08:24,048 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2026-01-01 15:08:27,501 - app.api.session_manager - INFO - Session created: 97adad27-3acd-42a8-97d1-800a7d08fd69
2026-01-01 15:08:27,502 - app.api.routes - INFO - Session started: 97adad27-3acd-42a8-97d1-800a7d08fd69, Turn: 1b98dd35-e5ef-4da1-a5c0-3836dd4a7e0c, Status: SessionStatus.LISTENING
2026-01-01 15:08:27,518 - app.api.ws - INFO - WebSocket connected for session 97adad27-3acd-42a8-97d1-800a7d08fd69. Total connections for session: 1
2026-01-01 15:08:27,526 - app.api.ws - INFO - Audio streaming started for session 97adad27-3acd-42a8-97d1-800a7d08fd69: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2026-01-01 15:08:29,714 - app.api.ws - INFO - Audio streaming ended for session 97adad27-3acd-42a8-97d1-800a7d08fd69
2026-01-01 15:08:29,715 - app.api.ws - INFO - Total audio received: 34242 bytes
2026-01-01 15:08:29,716 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 97adad27-3acd-42a8-97d1-800a7d08fd69: 34242 bytes
2026-01-01 15:08:29,718 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2026-01-01 15:08:29,948 - app.pipeline.pipeline_runner - INFO - Conversion complete
2026-01-01 15:08:29,950 - app.pipeline.pipeline_runner - INFO - Converted audio: 33600 samples at 16000Hz
2026-01-01 15:08:29,952 - app.pipeline.pipeline_runner - INFO - Processing audio for session 97adad27-3acd-42a8-97d1-800a7d08fd69, turn 1b98dd35-e5ef-4da1-a5c0-3836dd4a7e0c
2026-01-01 15:08:29,953 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:08:29,953 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2026-01-01 15:08:29,953 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:08:29,953 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2026-01-01 15:08:29,953 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 33600 samples
2026-01-01 15:08:29,955 - app.pipeline.processors.vad_processor - INFO - VAD complete: 33600 -> 27360 samples (1.71s)
2026-01-01 15:08:29,956 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2026-01-01 15:08:29,956 - app.pipeline.processors.stt_elevenlabs - INFO - Transcribing audio: 27360 samples, 1.71s
2026-01-01 15:08:30,541 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/speech-to-text "HTTP/1.1 200 OK"
2026-01-01 15:08:30,544 - app.pipeline.processors.stt_elevenlabs - INFO - Transcription complete: 'Hello? Hello. Hello. Hello.' (0.59s)
2026-01-01 15:08:30,545 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello? Hello. Hello. Hello.'
2026-01-01 15:08:30,545 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2026-01-01 15:08:30,546 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello? Hello. Hello. Hello.'
2026-01-01 15:08:30,546 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2026-01-01 15:08:30,546 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2026-01-01 15:08:30,547 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello? Hello. Hello. Hello.'
2026-01-01 15:09:00,559 - app.pipeline.processors.llm_ollama - ERROR - Ollama request timed out after 30s
2026-01-01 15:09:00,559 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm thinking too slowly. Can you ask again?'
2026-01-01 15:09:00,559 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2026-01-01 15:09:00,560 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm thinking too slowly. Can you ask again?'
2026-01-01 15:09:00,560 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm thinking too slowly. Can you ask again?'
2026-01-01 15:09:00,560 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm thinking too slowly. Can you ask again?'
2026-01-01 15:09:00,560 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:00,560 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 30607ms
2026-01-01 15:09:00,560 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:00,561 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello? Hello. Hello. Hello.', reply='I'm thinking too slowly. Can you ask again?', route=llm, time=30607ms
2026-01-01 15:09:00,570 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2026-01-01 15:09:01,485 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2026-01-01 15:09:01,491 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'I'm thinking too slowly. Can you ask again?'
2026-01-01 15:09:01,492 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2026-01-01 15:09:02,461 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2026-01-01 15:09:02,554 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\97adad27-3acd-42a8-97d1-800a7d08fd69\1b98dd35-e5ef-4da1-a5c0-3836dd4a7e0c.wav (115958 bytes, ~7.25s)
2026-01-01 15:09:02,556 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\97adad27-3acd-42a8-97d1-800a7d08fd69\1b98dd35-e5ef-4da1-a5c0-3836dd4a7e0c.wav
2026-01-01 15:09:02,581 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\97adad27-3acd-42a8-97d1-800a7d08fd69\1b98dd35-e5ef-4da1-a5c0-3836dd4a7e0c.wav
2026-01-01 15:09:03,083 - app.pipeline.pipeline_runner - INFO - Session 97adad27-3acd-42a8-97d1-800a7d08fd69 turn 1b98dd35-e5ef-4da1-a5c0-3836dd4a7e0c completed successfully
2026-01-01 15:09:10,775 - app.api.session_manager - INFO - Session created: 54061770-4a4a-44ff-882d-717343bb64ad
2026-01-01 15:09:10,775 - app.api.routes - INFO - Session started: 54061770-4a4a-44ff-882d-717343bb64ad, Turn: 45ddb522-8a64-41ac-a5c7-4814eae8ca91, Status: SessionStatus.LISTENING
2026-01-01 15:09:10,803 - app.api.ws - INFO - WebSocket connected for session 54061770-4a4a-44ff-882d-717343bb64ad. Total connections for session: 1
2026-01-01 15:09:10,810 - app.api.ws - INFO - Audio streaming started for session 54061770-4a4a-44ff-882d-717343bb64ad: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2026-01-01 15:09:14,252 - app.api.ws - INFO - Audio streaming ended for session 54061770-4a4a-44ff-882d-717343bb64ad
2026-01-01 15:09:14,252 - app.api.ws - INFO - Total audio received: 53722 bytes
2026-01-01 15:09:14,253 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 54061770-4a4a-44ff-882d-717343bb64ad: 53722 bytes
2026-01-01 15:09:14,257 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2026-01-01 15:09:14,546 - app.pipeline.pipeline_runner - INFO - Conversion complete
2026-01-01 15:09:14,548 - app.pipeline.pipeline_runner - INFO - Converted audio: 52800 samples at 16000Hz
2026-01-01 15:09:14,550 - app.pipeline.pipeline_runner - INFO - Processing audio for session 54061770-4a4a-44ff-882d-717343bb64ad, turn 45ddb522-8a64-41ac-a5c7-4814eae8ca91
2026-01-01 15:09:14,550 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:14,550 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2026-01-01 15:09:14,551 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:14,551 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2026-01-01 15:09:14,551 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 52800 samples
2026-01-01 15:09:14,552 - app.pipeline.processors.vad_processor - INFO - VAD complete: 52800 -> 17280 samples (1.08s)
2026-01-01 15:09:14,553 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2026-01-01 15:09:14,553 - app.pipeline.processors.stt_elevenlabs - INFO - Transcribing audio: 17280 samples, 1.08s
2026-01-01 15:09:15,021 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/speech-to-text "HTTP/1.1 200 OK"
2026-01-01 15:09:15,140 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2026-01-01 15:09:15,150 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2026-01-01 15:09:15,151 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2026-01-01 15:09:30,432 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! How may I assist you today?' (15.27s)
2026-01-01 15:09:30,432 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! How may I assist you today?'
2026-01-01 15:09:30,432 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2026-01-01 15:09:30,433 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! How may I assist you today?'
2026-01-01 15:09:30,433 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! How may I assist you today?'
2026-01-01 15:09:30,433 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! How may I assist you today?'
2026-01-01 15:09:30,433 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:30,433 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 15882ms
2026-01-01 15:09:30,433 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:30,613 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2026-01-01 15:09:31,821 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2026-01-01 15:09:31,825 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Hello! How may I assist you today?'
2026-01-01 15:09:31,826 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2026-01-01 15:09:32,546 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2026-01-01 15:09:32,610 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\54061770-4a4a-44ff-882d-717343bb64ad\45ddb522-8a64-41ac-a5c7-4814eae8ca91.wav (98126 bytes, ~6.13s)
2026-01-01 15:09:32,611 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\54061770-4a4a-44ff-882d-717343bb64ad\45ddb522-8a64-41ac-a5c7-4814eae8ca91.wav
2026-01-01 15:09:32,633 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\54061770-4a4a-44ff-882d-717343bb64ad\45ddb522-8a64-41ac-a5c7-4814eae8ca91.wav
2026-01-01 15:09:33,141 - app.pipeline.pipeline_runner - INFO - Session 54061770-4a4a-44ff-882d-717343bb64ad turn 45ddb522-8a64-41ac-a5c7-4814eae8ca91 completed successfully
2026-01-01 15:09:51,988 - app.api.session_manager - INFO - Session created: ec250194-2a10-4b29-8084-1b0318219038
2026-01-01 15:09:51,988 - app.api.routes - INFO - Session started: ec250194-2a10-4b29-8084-1b0318219038, Turn: 3559eb47-7428-46f2-9a1e-98f3b9b6320c, Status: SessionStatus.LISTENING
2026-01-01 15:09:52,019 - app.api.ws - INFO - WebSocket connected for session ec250194-2a10-4b29-8084-1b0318219038. Total connections for session: 1
2026-01-01 15:09:52,033 - app.api.ws - INFO - Audio streaming started for session ec250194-2a10-4b29-8084-1b0318219038: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2026-01-01 15:09:55,615 - app.api.ws - INFO - Audio streaming ended for session ec250194-2a10-4b29-8084-1b0318219038
2026-01-01 15:09:55,615 - app.api.ws - INFO - Total audio received: 55670 bytes
2026-01-01 15:09:55,616 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session ec250194-2a10-4b29-8084-1b0318219038: 55670 bytes
2026-01-01 15:09:55,618 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2026-01-01 15:09:55,910 - app.pipeline.pipeline_runner - INFO - Conversion complete
2026-01-01 15:09:55,912 - app.pipeline.pipeline_runner - INFO - Converted audio: 54720 samples at 16000Hz
2026-01-01 15:09:55,913 - app.pipeline.pipeline_runner - INFO - Processing audio for session ec250194-2a10-4b29-8084-1b0318219038, turn 3559eb47-7428-46f2-9a1e-98f3b9b6320c
2026-01-01 15:09:55,914 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:55,915 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2026-01-01 15:09:55,915 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:55,915 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2026-01-01 15:09:55,915 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 54720 samples
2026-01-01 15:09:55,917 - app.pipeline.processors.vad_processor - INFO - VAD complete: 54720 -> 39360 samples (2.46s)
2026-01-01 15:09:55,918 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2026-01-01 15:09:55,918 - app.pipeline.processors.stt_elevenlabs - INFO - Transcribing audio: 39360 samples, 2.46s
2026-01-01 15:09:56,528 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/speech-to-text "HTTP/1.1 200 OK"
2026-01-01 15:09:56,534 - app.pipeline.processors.stt_elevenlabs - INFO - Transcription complete: 'Can you tell me what day is today?' (0.62s)
2026-01-01 15:09:56,534 - app.pipeline.voice_pipeline - INFO - Transcript: 'Can you tell me what day is today?'
2026-01-01 15:09:56,534 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2026-01-01 15:09:56,534 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Can you tell me what day is today?'
2026-01-01 15:09:56,535 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2026-01-01 15:09:56,535 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2026-01-01 15:09:56,535 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Can you tell me what day is today?'
2026-01-01 15:09:57,135 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Today is Monday.' (0.60s)
2026-01-01 15:09:57,135 - app.pipeline.voice_pipeline - INFO - LLM response: 'Today is Monday.'
2026-01-01 15:09:57,136 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2026-01-01 15:09:57,136 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Today is Monday.'
2026-01-01 15:09:57,136 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Today is Monday.'
2026-01-01 15:09:57,136 - app.pipeline.voice_pipeline - INFO - Final reply: 'Today is Monday.'
2026-01-01 15:09:57,136 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:57,136 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 1222ms
2026-01-01 15:09:57,137 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 15:09:57,137 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Can you tell me what day is today?', reply='Today is Monday.', route=llm, time=1222ms
2026-01-01 15:09:57,140 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2026-01-01 15:09:58,218 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2026-01-01 15:09:58,220 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Today is Monday.'
2026-01-01 15:09:58,221 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2026-01-01 15:09:58,764 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2026-01-01 15:09:58,808 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\ec250194-2a10-4b29-8084-1b0318219038\3559eb47-7428-46f2-9a1e-98f3b9b6320c.wav (58002 bytes, ~3.63s)
2026-01-01 15:09:58,809 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\ec250194-2a10-4b29-8084-1b0318219038\3559eb47-7428-46f2-9a1e-98f3b9b6320c.wav
2026-01-01 15:09:58,833 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\ec250194-2a10-4b29-8084-1b0318219038\3559eb47-7428-46f2-9a1e-98f3b9b6320c.wav
2026-01-01 15:09:59,341 - app.pipeline.pipeline_runner - INFO - Session ec250194-2a10-4b29-8084-1b0318219038 turn 3559eb47-7428-46f2-9a1e-98f3b9b6320c completed successfully
2026-01-01 15:13:58,656 - app.api.session_manager - INFO - Cleaning up expired session: 40f9a2a6-ff1c-435f-8896-3db68ad6fe46
2026-01-01 15:13:58,657 - app.api.session_manager - INFO - Session deleted: 40f9a2a6-ff1c-435f-8896-3db68ad6fe46
2026-01-01 15:14:58,668 - app.api.session_manager - INFO - Cleaning up expired session: 97adad27-3acd-42a8-97d1-800a7d08fd69
2026-01-01 15:14:58,668 - app.api.session_manager - INFO - Session deleted: 97adad27-3acd-42a8-97d1-800a7d08fd69
2026-01-01 15:14:58,668 - app.api.session_manager - INFO - Cleaning up expired session: 54061770-4a4a-44ff-882d-717343bb64ad
2026-01-01 15:14:58,668 - app.api.session_manager - INFO - Session deleted: 54061770-4a4a-44ff-882d-717343bb64ad
2026-01-01 15:15:58,674 - app.api.session_manager - INFO - Cleaning up expired session: ec250194-2a10-4b29-8084-1b0318219038
2026-01-01 15:15:58,674 - app.api.session_manager - INFO - Session deleted: ec250194-2a10-4b29-8084-1b0318219038
2026-01-01 16:45:29,180 - app.api.session_manager - INFO - Session created: 5112520d-6fda-4e7c-9df2-87c9513f40da
2026-01-01 16:45:29,182 - app.api.routes - INFO - Session started: 5112520d-6fda-4e7c-9df2-87c9513f40da, Turn: 5c5a1eb9-c47a-45a6-8302-6a62d15c4a07, Status: SessionStatus.LISTENING
2026-01-01 16:45:29,212 - app.api.ws - INFO - WebSocket connected for session 5112520d-6fda-4e7c-9df2-87c9513f40da. Total connections for session: 1
2026-01-01 16:45:29,219 - app.api.ws - INFO - Audio streaming started for session 5112520d-6fda-4e7c-9df2-87c9513f40da: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2026-01-01 16:45:31,488 - app.api.ws - INFO - Audio streaming ended for session 5112520d-6fda-4e7c-9df2-87c9513f40da
2026-01-01 16:45:31,488 - app.api.ws - INFO - Total audio received: 34242 bytes
2026-01-01 16:45:31,490 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 5112520d-6fda-4e7c-9df2-87c9513f40da: 34242 bytes
2026-01-01 16:45:31,496 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2026-01-01 16:45:32,941 - app.pipeline.pipeline_runner - INFO - Conversion complete
2026-01-01 16:45:32,944 - app.pipeline.pipeline_runner - INFO - Converted audio: 33600 samples at 16000Hz
2026-01-01 16:45:32,946 - app.pipeline.pipeline_runner - INFO - Processing audio for session 5112520d-6fda-4e7c-9df2-87c9513f40da, turn 5c5a1eb9-c47a-45a6-8302-6a62d15c4a07
2026-01-01 16:45:32,946 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:45:32,947 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2026-01-01 16:45:32,947 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:45:32,947 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2026-01-01 16:45:32,947 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 33600 samples
2026-01-01 16:45:32,949 - app.pipeline.processors.vad_processor - INFO - VAD complete: 33600 -> 38400 samples (2.40s)
2026-01-01 16:45:32,949 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2026-01-01 16:45:32,949 - app.pipeline.processors.stt_elevenlabs - INFO - Transcribing audio: 38400 samples, 2.40s
2026-01-01 16:45:33,610 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/speech-to-text "HTTP/1.1 200 OK"
2026-01-01 16:45:33,616 - app.pipeline.processors.stt_elevenlabs - INFO - Transcription complete: 'Hi, can you hear me?' (0.67s)
2026-01-01 16:45:33,616 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hi, can you hear me?'
2026-01-01 16:45:33,616 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2026-01-01 16:45:33,617 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hi, can you hear me?'
2026-01-01 16:45:33,617 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2026-01-01 16:45:33,617 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2026-01-01 16:45:33,617 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hi, can you hear me?'
2026-01-01 16:45:50,744 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'I'm just listening! What do you want to talk about?' (17.13s)
2026-01-01 16:45:50,744 - app.pipeline.voice_pipeline - INFO - LLM response: 'I'm just listening! What do you want to talk about?'
2026-01-01 16:45:50,745 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2026-01-01 16:45:50,745 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'I'm just listening! What do you want to talk about?'
2026-01-01 16:45:50,745 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'I'm just listening! What do you want to talk about?'
2026-01-01 16:45:50,745 - app.pipeline.voice_pipeline - INFO - Final reply: 'I'm just listening! What do you want to talk about?'
2026-01-01 16:45:50,746 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:45:50,746 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 17799ms
2026-01-01 16:45:50,746 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:45:50,747 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hi, can you hear me?', reply='I'm just listening! What do you want to talk about?', route=llm, time=17799ms
2026-01-01 16:45:50,750 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: 21m00Tcm4TlvDq8ikWAM
2026-01-01 16:45:51,886 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2026-01-01 16:45:51,891 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'I'm just listening! What do you want to talk about?'
2026-01-01 16:45:51,893 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2026-01-01 16:45:52,676 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM?output_format=pcm_24000 "HTTP/1.1 200 OK"
2026-01-01 16:45:52,737 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\5112520d-6fda-4e7c-9df2-87c9513f40da\5c5a1eb9-c47a-45a6-8302-6a62d15c4a07.wav (107042 bytes, ~6.69s)
2026-01-01 16:45:52,738 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\5112520d-6fda-4e7c-9df2-87c9513f40da\5c5a1eb9-c47a-45a6-8302-6a62d15c4a07.wav
2026-01-01 16:45:52,762 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\5112520d-6fda-4e7c-9df2-87c9513f40da\5c5a1eb9-c47a-45a6-8302-6a62d15c4a07.wav
2026-01-01 16:45:53,262 - app.pipeline.pipeline_runner - INFO - Session 5112520d-6fda-4e7c-9df2-87c9513f40da turn 5c5a1eb9-c47a-45a6-8302-6a62d15c4a07 completed successfully
2026-01-01 16:51:08,549 - app.main - INFO - ============================================================
2026-01-01 16:51:08,550 - app.main - INFO - Voice Agent Service starting...
2026-01-01 16:51:08,550 - app.main - INFO - Service URL: http://127.0.0.1:8008
2026-01-01 16:51:08,550 - app.main - INFO - WebSocket URL: ws://127.0.0.1:8008/ws
2026-01-01 16:51:08,550 - app.main - INFO - Ollama URL: http://127.0.0.1:11434
2026-01-01 16:51:08,551 - app.main - INFO - STT Model: base.en
2026-01-01 16:51:08,551 - app.main - INFO - LLM Model: qwen2.5:0.5b-instruct
2026-01-01 16:51:08,551 - app.main - INFO - Data Directory: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data
2026-01-01 16:51:08,551 - app.main - INFO - ============================================================
2026-01-01 16:51:08,551 - app.api.session_manager - INFO - Session Manager started
2026-01-01 16:51:32,608 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2026-01-01 16:51:38,324 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2026-01-01 16:51:40,747 - app.api.session_manager - INFO - Session created: 49871982-5d47-4fe1-91f3-d4a3e5a57684
2026-01-01 16:51:40,747 - app.api.routes - INFO - Session started: 49871982-5d47-4fe1-91f3-d4a3e5a57684, Turn: d685a4f0-bdf1-4495-abd7-4eced6b489b0, Status: SessionStatus.LISTENING
2026-01-01 16:51:40,760 - app.api.ws - INFO - WebSocket connected for session 49871982-5d47-4fe1-91f3-d4a3e5a57684. Total connections for session: 1
2026-01-01 16:51:40,771 - app.api.ws - INFO - Audio streaming started for session 49871982-5d47-4fe1-91f3-d4a3e5a57684: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2026-01-01 16:51:43,489 - app.api.ws - INFO - Audio streaming ended for session 49871982-5d47-4fe1-91f3-d4a3e5a57684
2026-01-01 16:51:43,489 - app.api.ws - INFO - Total audio received: 41052 bytes
2026-01-01 16:51:43,490 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 49871982-5d47-4fe1-91f3-d4a3e5a57684: 41052 bytes
2026-01-01 16:51:43,495 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2026-01-01 16:51:44,756 - app.pipeline.pipeline_runner - INFO - Conversion complete
2026-01-01 16:51:44,758 - app.pipeline.pipeline_runner - INFO - Converted audio: 40320 samples at 16000Hz
2026-01-01 16:51:44,760 - app.pipeline.voice_pipeline - INFO - Initializing voice pipeline...
2026-01-01 16:51:44,760 - app.pipeline.processors.vad_processor - INFO - VAD initialized: aggressiveness=2, frame_duration=30ms, padding=300ms, sample_rate=16000Hz
2026-01-01 16:51:44,762 - app.pipeline.processors.stt_elevenlabs - INFO - Initializing ElevenLabs STT processor
2026-01-01 16:51:46,160 - app.pipeline.processors.stt_elevenlabs - INFO - ElevenLabs STT processor initialized: model=scribe_v1, language=en
2026-01-01 16:51:46,161 - app.pipeline.processors.skills_router - INFO - Skills router initialized
2026-01-01 16:51:46,161 - app.pipeline.processors.llm_ollama - INFO - LLM initialized: model=qwen2.5:0.5b-instruct, url=http://127.0.0.1:11434
2026-01-01 16:51:46,213 - app.pipeline.processors.llm_ollama - INFO - Ollama connection verified
2026-01-01 16:51:46,213 - app.pipeline.processors.response_shaper - INFO - Response shaper initialized: max_sentences=2, max_words=35
2026-01-01 16:51:46,214 - app.pipeline.voice_pipeline - INFO - Voice pipeline initialized successfully
2026-01-01 16:51:46,214 - app.pipeline.pipeline_runner - INFO - Pipeline runner initialized
2026-01-01 16:51:46,214 - app.pipeline.pipeline_runner - INFO - Processing audio for session 49871982-5d47-4fe1-91f3-d4a3e5a57684, turn d685a4f0-bdf1-4495-abd7-4eced6b489b0
2026-01-01 16:51:46,215 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:51:46,215 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2026-01-01 16:51:46,215 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:51:46,215 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2026-01-01 16:51:46,216 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 40320 samples
2026-01-01 16:51:46,217 - app.pipeline.processors.vad_processor - INFO - VAD complete: 40320 -> 14880 samples (0.93s)
2026-01-01 16:51:46,217 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2026-01-01 16:51:46,217 - app.pipeline.processors.stt_elevenlabs - INFO - Transcribing audio: 14880 samples, 0.93s
2026-01-01 16:51:47,594 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/speech-to-text "HTTP/1.1 200 OK"
2026-01-01 16:51:47,595 - app.pipeline.processors.stt_elevenlabs - WARNING - Transcription returned empty text
2026-01-01 16:51:47,595 - app.pipeline.voice_pipeline - WARNING - Transcription failed or empty
2026-01-01 16:51:47,596 - app.pipeline.pipeline_runner - ERROR - Pipeline error: Transcription failed or empty
2026-01-01 16:51:50,466 - app.api.session_manager - INFO - Session created: 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d
2026-01-01 16:51:50,467 - app.api.routes - INFO - Session started: 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d, Turn: 0c5986d6-8741-4c7a-9b57-d217e63c0f48, Status: SessionStatus.LISTENING
2026-01-01 16:51:50,493 - app.api.ws - INFO - WebSocket connected for session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d. Total connections for session: 1
2026-01-01 16:51:50,499 - app.api.ws - INFO - Audio streaming started for session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d: {'sample_rate': 16000, 'channels': 1, 'format': 'webm'}
2026-01-01 16:51:54,622 - app.api.ws - INFO - Audio streaming ended for session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d
2026-01-01 16:51:54,622 - app.api.ws - INFO - Total audio received: 65410 bytes
2026-01-01 16:51:54,623 - app.pipeline.pipeline_runner - INFO - Processing audio stream for session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d: 65410 bytes
2026-01-01 16:51:54,626 - app.pipeline.pipeline_runner - INFO - Converting WebM to WAV using ffmpeg...
2026-01-01 16:51:54,859 - app.pipeline.pipeline_runner - INFO - Conversion complete
2026-01-01 16:51:54,861 - app.pipeline.pipeline_runner - INFO - Converted audio: 64320 samples at 16000Hz
2026-01-01 16:51:54,863 - app.pipeline.pipeline_runner - INFO - Processing audio for session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d, turn 0c5986d6-8741-4c7a-9b57-d217e63c0f48
2026-01-01 16:51:54,863 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:51:54,864 - app.pipeline.voice_pipeline - INFO - Starting voice pipeline processing
2026-01-01 16:51:54,864 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:51:54,864 - app.pipeline.voice_pipeline - INFO - Step 1: VAD processing...
2026-01-01 16:51:54,864 - app.pipeline.processors.vad_processor - INFO - Processing audio with VAD: 64320 samples
2026-01-01 16:51:54,866 - app.pipeline.processors.vad_processor - INFO - VAD complete: 64320 -> 18720 samples (1.17s)
2026-01-01 16:51:54,867 - app.pipeline.voice_pipeline - INFO - Step 2: STT processing...
2026-01-01 16:51:54,867 - app.pipeline.processors.stt_elevenlabs - INFO - Transcribing audio: 18720 samples, 1.17s
2026-01-01 16:51:55,345 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/speech-to-text "HTTP/1.1 200 OK"
2026-01-01 16:51:55,347 - app.pipeline.processors.stt_elevenlabs - INFO - Transcription complete: 'Hello?' (0.48s)
2026-01-01 16:51:55,347 - app.pipeline.voice_pipeline - INFO - Transcript: 'Hello?'
2026-01-01 16:51:55,347 - app.pipeline.voice_pipeline - INFO - Step 3: Skills routing...
2026-01-01 16:51:55,347 - app.pipeline.processors.skills_router - INFO - Routing transcript: 'Hello?'
2026-01-01 16:51:55,348 - app.pipeline.processors.skills_router - INFO - Routing to LLM
2026-01-01 16:51:55,348 - app.pipeline.voice_pipeline - INFO - Step 4: LLM processing...
2026-01-01 16:51:55,348 - app.pipeline.processors.llm_ollama - INFO - Generating LLM response for: 'Hello?'
2026-01-01 16:52:00,531 - app.pipeline.processors.llm_ollama - INFO - LLM response generated: 'Hello! How can I assist you today?' (5.18s)
2026-01-01 16:52:00,532 - app.pipeline.voice_pipeline - INFO - LLM response: 'Hello! How can I assist you today?'
2026-01-01 16:52:00,532 - app.pipeline.voice_pipeline - INFO - Step 5: Response shaping...
2026-01-01 16:52:00,532 - app.pipeline.processors.response_shaper - INFO - Shaping response: 'Hello! How can I assist you today?'
2026-01-01 16:52:00,532 - app.pipeline.processors.response_shaper - INFO - Shaped response: 'Hello! How can I assist you today?'
2026-01-01 16:52:00,533 - app.pipeline.voice_pipeline - INFO - Final reply: 'Hello! How can I assist you today?'
2026-01-01 16:52:00,533 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:52:00,533 - app.pipeline.voice_pipeline - INFO - Pipeline complete: 5669ms
2026-01-01 16:52:00,533 - app.pipeline.voice_pipeline - INFO - ============================================================
2026-01-01 16:52:00,534 - app.pipeline.pipeline_runner - INFO - Pipeline complete: transcript='Hello?', reply='Hello! How can I assist you today?', route=llm, time=5669ms
2026-01-01 16:52:00,540 - app.pipeline.processors.tts_elevenlabs - INFO - Initializing ElevenLabs TTS processor with voice: tapn1QwocNXk3viVSowa
2026-01-01 16:52:01,841 - app.pipeline.processors.tts_elevenlabs - INFO - ElevenLabs TTS processor initialized successfully
2026-01-01 16:52:01,844 - app.pipeline.processors.tts_elevenlabs - INFO - Synthesizing text: 'Hello! How can I assist you today?'
2026-01-01 16:52:01,845 - app.pipeline.processors.tts_elevenlabs - INFO - Calling ElevenLabs API...
2026-01-01 16:52:02,505 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/tapn1QwocNXk3viVSowa?output_format=pcm_24000 "HTTP/1.1 200 OK"
2026-01-01 16:52:02,583 - app.pipeline.processors.tts_elevenlabs - INFO - TTS complete: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d\0c5986d6-8741-4c7a-9b57-d217e63c0f48.wav (69146 bytes, ~4.32s)
2026-01-01 16:52:02,584 - app.pipeline.pipeline_runner - INFO - Generated TTS audio: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d\0c5986d6-8741-4c7a-9b57-d217e63c0f48.wav
2026-01-01 16:52:02,607 - app.api.routes - INFO - Serving audio file: C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\data\audio\2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d\0c5986d6-8741-4c7a-9b57-d217e63c0f48.wav
2026-01-01 16:52:03,115 - app.pipeline.pipeline_runner - INFO - Session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d turn 0c5986d6-8741-4c7a-9b57-d217e63c0f48 completed successfully
2026-01-01 16:57:08,598 - app.api.session_manager - INFO - Cleaning up expired session: 49871982-5d47-4fe1-91f3-d4a3e5a57684
2026-01-01 16:57:08,598 - app.api.session_manager - INFO - Session deleted: 49871982-5d47-4fe1-91f3-d4a3e5a57684
2026-01-01 16:57:08,598 - app.api.session_manager - INFO - Cleaning up expired session: 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d
2026-01-01 16:57:08,598 - app.api.session_manager - INFO - Session deleted: 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d
2026-01-01 17:08:14,885 - app.api.ws - ERROR - WebSocket error for session 49871982-5d47-4fe1-91f3-d4a3e5a57684: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2026-01-01 17:08:14,920 - app.api.ws - INFO - WebSocket disconnected for session 49871982-5d47-4fe1-91f3-d4a3e5a57684
2026-01-01 17:08:14,922 - app.api.ws - ERROR - WebSocket error for session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d: Cannot call "receive" once a disconnect message has been received.
Traceback (most recent call last):
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\app\api\ws.py", line 273, in websocket_endpoint
    message = await websocket.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rober\OneDrive\dev\ai\voice-game\voice_service\.venv\Lib\site-packages\starlette\websockets.py", line 57, in receive
    raise RuntimeError('Cannot call "receive" once a disconnect message has been received.')
RuntimeError: Cannot call "receive" once a disconnect message has been received.
2026-01-01 17:08:14,925 - app.api.ws - INFO - WebSocket disconnected for session 2ff3cbbc-f2bb-4445-b0d1-4fde36c94a9d
2026-01-01 17:08:16,726 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2026-01-01 17:08:17,618 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
